nohup: ignoring input
2023-12-03 14:38:30.175665: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:38:30.225429: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:38:30.983254: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 394.54it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.12it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.96it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.83it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.32it/s]  9%|â–‰         | 3/32 [00:00<00:03,  8.77it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.78it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.62it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:03,  8.55it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.43it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.32it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.21it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  7.93it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  7.95it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.90it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  7.92it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.90it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.82it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.83it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.88it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.76it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.69it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.65it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.62it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.62it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:03<00:01,  7.53it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.59it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.60it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  7.87it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.79it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.82it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.82it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.91it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:38:52.952637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 195.91it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:29,  3.24it/s]  5%|â–Œ         | 5/100 [00:01<00:16,  5.63it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.94it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.65it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.37it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.05it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 14.42it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.23it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.16it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.14it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.75it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 17.17it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 17.50it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 17.67it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.90it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.11it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 18.17it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.22it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.25it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.13it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 18.20it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.15it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.22it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.27it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 18.26it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.33it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.39it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 18.35it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.40it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.42it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.46it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.48it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 18.50it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 18.54it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.56it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.54it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.54it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.51it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.52it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.30it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 18.30it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 18.35it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.42it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.50it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.38it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 352.61it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.69it/s]  2%|â–         | 2/100 [00:00<00:15,  6.30it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.91it/s]  4%|â–         | 4/100 [00:00<00:13,  6.92it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.97it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.19it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.31it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.39it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.45it/s] 10%|â–ˆ         | 10/100 [00:01<00:11,  7.56it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.63it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.30it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.45it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.27it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.43it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.53it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.61it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.68it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.72it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.58it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.64it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.69it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:09,  7.72it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:09,  7.70it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.72it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.58it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.35it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.48it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.33it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.32it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.39it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.50it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.67it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.63it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.69it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.42it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.52it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.31it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.45it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.52it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.35it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.50it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.49it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.66it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.73it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.75it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.77it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:05,  7.67it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.73it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.53it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.43it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.45it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.41it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.34it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.40it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.25it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.38it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.49it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.58it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.53it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.61it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.42it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.54it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.63it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.68it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.73it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.39it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.45it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.56it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.56it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.54it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.44it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.55it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.63it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.52it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.33it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.47it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.44it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.46it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.57it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.65it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.69it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.35it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.34it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.48it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.58it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.43it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.50it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.49it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.132246     0.014188
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.90it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.86it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.72it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.71it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.64it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.50it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.41it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.30it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.16it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  9.00it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.94it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.88it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.82it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.81it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.71it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.72it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.67it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.69it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.68it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.58it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.66it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.51it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.49it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.57it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.49it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.40it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.92it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.76it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 343.77it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:05, 16.88it/s]  4%|â–         | 4/100 [00:00<00:05, 17.87it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 18.22it/s]  8%|â–Š         | 8/100 [00:00<00:04, 18.40it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.50it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.58it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.63it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.65it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.66it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.68it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.68it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.69it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:03, 18.67it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.67it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.70it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.70it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.70it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.71it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.72it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.72it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:02, 18.73it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.67it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 18.68it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.69it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.70it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.70it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.71it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.71it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.71it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.51it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.32it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.44it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.53it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:03<00:01, 18.59it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.66it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.68it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.68it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.71it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.72it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.59it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:04<00:00, 18.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.66it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.68it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.68it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.69it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.62it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 330.18it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.97it/s]  2%|â–         | 2/100 [00:00<00:13,  7.01it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.35it/s]  4%|â–         | 4/100 [00:00<00:13,  7.29it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.47it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.38it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.52it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.62it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.39it/s] 10%|â–ˆ         | 10/100 [00:01<00:11,  7.50it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.56it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.63it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.66it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.69it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:11,  7.65it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.60it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.68it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.32it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.43it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.17it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.35it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.13it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.32it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.32it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.45it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.39it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.36it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.48it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.48it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.55it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.41it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.47it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.14it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.25it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:09,  7.00it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.16it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.07it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.13it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  6.99it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.18it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.28it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.43it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.49it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.58it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.21it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.31it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.45it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.39it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.41it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.46it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.55it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.55it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.68it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.43it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.45it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.41it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.48it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.35it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.26it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.52it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.60it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.66it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.70it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.35it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.47it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.57it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.36it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.48it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.57it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.62it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.59it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.56it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.42it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.17it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.34it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.19it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.35it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.13it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.32it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.21it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.36it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.41it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.41it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.51it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.58it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.41it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.24it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.47it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.41it/s]
FOLD 1
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B   2.2171     0.049924
[2.17467285 0.03205619]
2023-12-03 14:39:56.107478: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:39:56.156573: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:39:56.905879: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 375.46it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.18it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.00it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.81it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.47it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.12it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.03it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.91it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.81it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.62it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.50it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.39it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.39it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.32it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.29it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.31it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.13it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.12it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.16it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.09it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.07it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.12it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.17it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.99it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.00it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.99it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.20it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.16it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.17it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.23it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:40:16.421346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 268.09it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.23it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.54it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.78it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.81it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.56it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.99it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 14.05it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 14.95it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.61it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 16.08it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.43it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.67it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.89it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 17.06it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 17.15it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.20it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 17.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 17.25it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.26it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.27it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.28it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 17.06it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.04it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.10it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.17it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.19it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.25it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.24it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 17.31it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.32it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.32it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 17.31it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.28it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 17.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 17.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 17.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 17.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 17.35it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 17.31it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 17.30it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.34it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.30it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.32it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 17.31it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 16.85it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.77it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 352.17it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.57it/s]  2%|â–         | 2/100 [00:00<00:15,  6.38it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.60it/s]  4%|â–         | 4/100 [00:00<00:14,  6.85it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.94it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.86it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.93it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.13it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.27it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.21it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.12it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.25it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.10it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.97it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.02it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.19it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.31it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.40it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.39it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.46it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.52it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.57it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.58it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.58it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.57it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.59it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.60it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.60it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.61it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.39it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.28it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.39it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.22it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.36it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.42it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.48it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.44it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.27it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.37it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.19it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.15it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.29it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.38it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.38it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.44it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.50it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.50it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.38it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.34it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.41it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.11it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.21it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.30it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.38it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.29it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.10it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.10it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.31it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.24it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.20it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.18it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.16it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.30it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.40it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.32it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.98it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.15it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.21it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.03it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.31it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.05it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.18it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.26it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.31it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.41it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.47it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.51it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.11it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.11it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.10it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.26it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.28it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.40it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.46it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.43it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.41it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.27it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.163467     0.048399
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.94it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.91it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.76it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.75it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.66it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.52it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.47it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.34it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.19it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.07it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  9.01it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.91it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.87it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.83it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.80it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.80it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.72it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.71it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.68it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.64it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.66it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.67it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.65it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.54it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.66it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.59it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.73it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.72it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.69it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.82it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 336.22it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.08it/s]  4%|â–         | 4/100 [00:00<00:05, 16.97it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.29it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.43it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.52it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.20it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 17.11it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.27it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.40it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.49it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.54it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.61it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 17.65it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.65it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.67it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.68it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.68it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.68it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.69it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.69it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.66it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.59it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.66it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.68it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.69it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 17.70it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.70it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.71it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.69it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.70it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.68it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.69it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 17.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.60it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.61it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.65it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.66it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.68it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.59it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 269.14it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.64it/s]  2%|â–         | 2/100 [00:00<00:14,  6.77it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.12it/s]  4%|â–         | 4/100 [00:00<00:13,  6.97it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.17it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.32it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.43it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.29it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.40it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.24it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.19it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.25it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.37it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.21it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.17it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.23it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.35it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.16it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.29it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.32it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.40it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.23it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.35it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.15it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.17it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.29it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.39it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.26it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.36it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.96it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.14it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.93it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.05it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.21it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.35it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.36it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.45it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.52it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.31it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.28it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.27it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.36it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.45it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.47it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.53it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.56it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.27it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.31it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.34it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.13it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.02it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  6.98it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.15it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.07it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.24it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.28it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.02it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.18it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.11it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.26it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.38it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.25it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.36it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.14it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.27it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.34it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.44it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.42it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.02it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.98it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.14it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.02it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.29it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.38it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.34it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.31it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.40it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.47it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.35it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.44it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.53it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.56it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.31it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.40it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.11it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.25it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.28it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.249629     0.076531
[2.20654785 0.06246493]
2023-12-03 14:41:18.091181: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:41:18.140477: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:41:18.890703: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 405.72it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.18it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.01it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.76it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.42it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.30it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.16it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.05it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.92it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.80it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.66it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.50it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.44it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.37it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.35it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.38it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.35it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.32it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.91it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.96it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.01it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.09it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.18it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.06it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.12it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.10it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.03it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.22it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.93it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.34it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:41:37.896323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 267.60it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.19it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.42it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.57it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.52it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.18it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.54it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.61it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.42it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.01it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.44it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.76it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.99it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.15it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.27it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.35it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:04, 16.42it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.45it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.48it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.49it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.52it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.55it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.51it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.50it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:02, 16.50it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.52it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.54it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.55it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.56it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.57it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.58it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:01, 16.58it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.57it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.57it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.54it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.54it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:01, 16.57it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.57it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.57it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.56it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.57it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.57it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.57it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.57it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 16.58it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.24it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 350.64it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.50it/s]  2%|â–         | 2/100 [00:00<00:15,  6.25it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.66it/s]  4%|â–         | 4/100 [00:00<00:13,  6.91it/s]  5%|â–Œ         | 5/100 [00:00<00:14,  6.78it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.98it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.12it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.22it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.03it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.14it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.09it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.19it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.27it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.32it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.37it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.39it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.05it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.10it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.00it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.09it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.12it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.15it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.23it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.29it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.18it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.18it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.25it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.22it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.21it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.27it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.10it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.00it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.12it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.17it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  6.94it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.89it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:09,  6.90it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  6.91it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.82it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  6.99it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.12it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.07it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.17it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.84it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:08,  6.79it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.01it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.06it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.24it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.03it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.95it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.08it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  6.93it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.06it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  7.16it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.02it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  6.95it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.08it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.19it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.13it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.16it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.23it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.25it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.31it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.12it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.21it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.24it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:03,  7.30it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.34it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.34it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.12it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.14it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.11it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.21it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.29it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.33it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.39it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.32it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.35it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.14it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.15it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.09it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.18it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.01it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.13it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.96it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.09it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.19it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.25it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.02it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.18it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.12it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.178354     0.059682
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.61it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.56it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.38it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.38it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.28it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.17it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.10it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.98it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.85it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.75it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.67it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.52it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.45it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.45it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.40it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.40it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.38it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.35it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.45it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.41it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.23it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.35it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.29it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.32it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.44it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.43it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.40it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.84it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.51it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 267.63it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.49it/s]  4%|â–         | 4/100 [00:00<00:05, 16.24it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.50it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.62it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.70it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.74it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.75it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.77it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.79it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.80it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.81it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.81it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.82it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.83it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.83it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.84it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.83it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.84it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.76it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.78it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.80it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.81it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.82it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.83it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 16.83it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.84it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.84it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.84it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.84it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.84it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.83it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.83it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.83it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.83it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.84it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.84it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.84it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.84it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.84it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.84it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.83it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.84it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.83it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.83it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.83it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.83it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.60it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.70it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.74it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.78it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 311.52it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.47it/s]  2%|â–         | 2/100 [00:00<00:14,  6.96it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.08it/s]  4%|â–         | 4/100 [00:00<00:13,  6.90it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.00it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.15it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.26it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.34it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.39it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.43it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.46it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.47it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.48it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.44it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.44it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.39it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.41it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.15it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.24it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.30it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.12it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  7.02it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.13it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.19it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.28it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.35it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.39it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.14it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.14it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.16it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.99it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.88it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.99it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  6.93it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.96it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:09,  6.90it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.00it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.08it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.20it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.29it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.07it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  7.08it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.08it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  6.98it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.05it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.18it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.16it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  6.88it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.05it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.17it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.01it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.03it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.10it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.20it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.33it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.03it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.15it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.32it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.07it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  6.93it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.01it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  6.95it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.10it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.30it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.36it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.13it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.20it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.23it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.02it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.96it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.10it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.20it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.35it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.38it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.12it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.22it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.30it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.15it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.09it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.15it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.33it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.22it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.30it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.39it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.13it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.24it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.32it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.10it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.21it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.29it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.18it/s]
FOLD 1
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B  2.34541     0.180857
[2.26188232 0.12026938]
2023-12-03 14:42:40.481938: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:42:40.531011: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:42:41.279370: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 363.62it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.30it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.18it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.73it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.38it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.03it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.90it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.80it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.71it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.60it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.50it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.34it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.21it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.19it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.11it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.08it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.10it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.85it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.88it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.90it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.94it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.89it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.86it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.91it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.96it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.96it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.82it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.87it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.83it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.82it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.98it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.02it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.01it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.08it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:43:00.563795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 274.32it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.18it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.40it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.52it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.40it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 10.84it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.15it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.19it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 13.97it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.57it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.00it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.31it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.53it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.69it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.81it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.88it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.95it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 15.99it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.02it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.04it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.06it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.06it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.06it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.05it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 16.07it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.08it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.09it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.09it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.10it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.11it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.11it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.11it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 16.11it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.10it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.09it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.10it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.11it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.11it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.11it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.10it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 16.10it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.11it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.11it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.10it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.11it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.11it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.11it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.11it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:07<00:00, 16.11it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.89it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 344.44it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.45it/s]  2%|â–         | 2/100 [00:00<00:15,  6.21it/s]  3%|â–Ž         | 3/100 [00:00<00:15,  6.40it/s]  4%|â–         | 4/100 [00:00<00:14,  6.65it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.89it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.78it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.95it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.08it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.16it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  6.95it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.07it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  6.88it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.01it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  7.10it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.02it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.11it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:12,  6.86it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.00it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.11it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.19it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.16it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.22it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.27it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.30it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.17it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.23it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.19it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.09it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.16it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.81it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  6.96it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.07it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.10it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.96it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.07it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.14it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.20it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.93it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.04it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.13it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.04it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.07it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.02it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.11it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.98it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.08it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.10it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.15it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.99it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.03it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.12it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.12it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.18it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.23it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  7.12it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  6.99it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.09it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.17it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.96it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.06it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.14it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.19it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.13it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  6.99it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.09it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.10it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.04it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.14it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.20it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  7.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.31it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.08it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.95it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  6.87it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.01it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.11it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  7.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.18it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.09it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.16it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.14it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.10it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.18it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.01it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.96it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.07it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.16it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.07it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.90it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.06it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.196475     0.078429
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.53it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.60it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.48it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.47it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.41it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.27it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.21it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.03it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.87it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.78it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.62it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.58it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.54it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.53it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.53it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.47it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.46it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.42it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.33it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.45it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.42it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.41it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.31it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.46it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.46it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.40it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.84it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.54it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 280.41it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.91it/s]  4%|â–         | 4/100 [00:00<00:06, 15.55it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 15.86it/s]  8%|â–Š         | 8/100 [00:00<00:05, 15.91it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.06it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.11it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.15it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.19it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.19it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.21it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.23it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.24it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.12it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.14it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.14it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.18it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.10it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.15it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.18it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.22it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.22it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.25it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.26it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.26it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.25it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.20it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.19it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.22it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 16.20it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.22it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.25it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.25it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.17it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.21it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.21it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.23it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.02it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.07it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.18it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.17it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 305.77it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.41it/s]  2%|â–         | 2/100 [00:00<00:14,  6.69it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.62it/s]  4%|â–         | 4/100 [00:00<00:13,  6.89it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.88it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.03it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.13it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.21it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.98it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.06it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.15it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.20it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.23it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.27it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.31it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.34it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.11it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.18it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.06it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.15it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.22it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.30it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.33it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.34it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.32it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.29it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  6.96it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  7.07it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.95it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:10,  6.87it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.01it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.12it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.13it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.19it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.98it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.00it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.95it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.01it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.10it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.18it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.10it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.18it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.24it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.17it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.22it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  6.91it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  7.03it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.86it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.00it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.12it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.16it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.23it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.94it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.97it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:06,  6.77it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.92it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  6.78it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.74it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  6.92it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.05it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.89it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.00it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.11it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.15it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.22it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:03,  7.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:04,  6.95it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.07it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.15it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.03it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.13it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.93it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.04it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.10it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.11it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.17it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.01it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  7.10it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.03it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  6.99it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.10it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  6.94it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.06it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.14it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.26it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.07it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.10it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.16it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.09it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.362559     0.195255
[2.2795166  0.13684184]
2023-12-03 14:44:03.895027: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:44:03.944921: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:44:04.694369: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 374.79it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.15it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.20it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.01it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.72it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.43it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.08it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.01it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.87it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.68it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.60it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.53it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.39it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.28it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.08it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.08it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.10it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.01it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.04it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.97it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.95it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.01it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.01it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.87it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.85it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.81it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.81it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.04it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.01it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.04it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.04it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.72it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.13it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:44:24.308583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 266.83it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:29,  3.24it/s]  5%|â–Œ         | 5/100 [00:01<00:16,  5.64it/s]  7%|â–‹         | 7/100 [00:01<00:11,  8.01it/s]  9%|â–‰         | 9/100 [00:01<00:08, 10.22it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 12.15it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.67it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 14.94it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.96it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:04, 16.62it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 17.21it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 17.60it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 17.93it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 18.13it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:03, 18.30it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 18.41it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 18.36it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.46it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:02<00:03, 18.52it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.60it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:02, 18.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.65it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.66it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.67it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.53it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:03<00:02, 18.56it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.60it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.63it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.65it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:01, 18.67it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.68it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.69it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.69it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.69it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:04<00:01, 18.70it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 18.61it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.67it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.69it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:05<00:00, 18.70it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:05<00:00, 18.66it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.64it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.65it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.76it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 342.06it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.73it/s]  2%|â–         | 2/100 [00:00<00:15,  6.53it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.71it/s]  4%|â–         | 4/100 [00:00<00:13,  7.11it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.27it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.38it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.52it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.07it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.29it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.46it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.11it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.24it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.41it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:12,  7.08it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.30it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.23it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.34it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.48it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.16it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.35it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.22it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.13it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.18it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.36it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.49it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.44it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.24it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.34it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.19it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.38it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.29it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.37it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.52it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.61it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.68it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.73it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.78it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.37it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.43it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.54it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.32it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.46it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.57it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.65it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.72it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.76it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.48it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.42it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.53it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.30it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.32it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.31it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.46it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.56it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.31it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.38it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.51it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.53it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:04,  7.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.54it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.52it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.32it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.47it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.35it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.41it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.32it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.40it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.38it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.47it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.54it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.32it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.25it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.26it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.43it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.56it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.57it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.65it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.56it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.64it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.71it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.46it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.57it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.43it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.65it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.54it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.47it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.57it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.71it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.43it/s]
FOLD 0
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B  2.18165     0.061708
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.91it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.89it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.76it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.73it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.68it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.53it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.46it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.34it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.19it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  9.01it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.95it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.90it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.85it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.82it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.80it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.56it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.60it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.59it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.73it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.71it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.60it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.70it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.74it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.74it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.71it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.83it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 346.84it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:05, 16.93it/s]  4%|â–         | 4/100 [00:00<00:05, 17.94it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 18.30it/s]  8%|â–Š         | 8/100 [00:00<00:04, 18.47it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.57it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.62it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.67it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.62it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.36it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.46it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.53it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.60it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:03, 18.64it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.66it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.71it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.73it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.74it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.74it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.74it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.75it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:02, 18.76it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.76it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.76it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.76it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 18.76it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.76it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.75it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.60it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.65it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.68it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.71it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.73it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.73it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.74it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.75it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:03<00:01, 18.76it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.76it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.61it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.65it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.68it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.71it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.72it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.73it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.74it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:04<00:00, 18.74it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.74it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.73it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.74it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.63it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.66it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 356.14it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.73it/s]  2%|â–         | 2/100 [00:00<00:14,  6.94it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.32it/s]  4%|â–         | 4/100 [00:00<00:12,  7.51it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.30it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.39it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.53it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.55it/s]  9%|â–‰         | 9/100 [00:01<00:11,  7.64it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.23it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.39it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.38it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.52it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.24it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.38it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.51it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.61it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.67it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.72it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.46it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.49it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.59it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.66it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:09,  7.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.72it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.63it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.64it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.25it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.40it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.52it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.50it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.51it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.33it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.46it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.41it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.52it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.32it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.46it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.25it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.34it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.48it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.17it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.34it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.47it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.57it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.46it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.57it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.49it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.64it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.57it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.60it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.53it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.33it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.32it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.46it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.57it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.65it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.64it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.61it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.72it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.75it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:03,  7.77it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.54it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.47it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.57it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.28it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.47it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.42it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.45it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.56it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.45it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.65it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.45it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.50it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.58it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.41it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.34it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.31it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.46it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.56it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.41it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.53it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.67it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.72it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.75it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.33it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.49it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.405937     0.244797
[2.29379395 0.15325221]
2023-12-03 14:45:24.433466: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:45:24.485222: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:45:25.237331: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 374.49it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.15it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.84it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.45it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.33it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.17it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.95it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.85it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.71it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.52it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.39it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.35it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.26it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.20it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.17it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.09it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.06it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.07it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.99it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.96it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.00it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.04it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.03it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.88it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.93it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.88it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.89it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.09it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.04it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.07it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.73it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.21it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:45:44.678728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 263.23it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.21it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.53it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.76it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.76it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.52it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.98it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 14.13it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.02it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.68it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 16.17it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.52it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.77it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.95it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.95it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 17.08it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.18it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 17.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 17.30it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.33it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.35it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.37it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 17.37it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.39it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.35it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.37it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.38it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.40it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.41it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.90it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 17.11it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.04it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.02it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.96it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.93it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 17.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 17.03it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:01, 16.99it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 16.88it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.90it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.02it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.10it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.14it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 17.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 17.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.73it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 348.13it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.53it/s]  2%|â–         | 2/100 [00:00<00:15,  6.33it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.79it/s]  4%|â–         | 4/100 [00:00<00:13,  7.05it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.21it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.13it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.00it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.15it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.19it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.27it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.86it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  6.88it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.08it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.22it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.18it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.08it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.09it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.05it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.11it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.23it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.32it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.36it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.29it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.35it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.39it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.44it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.47it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.50it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.50it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.51it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.52it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.44it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.46it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.47it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.47it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.39it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.34it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.38it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.40it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.28it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.27it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.31it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.19it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.02it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.03it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.18it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.29it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.02it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.11it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.22it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.01it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.02it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.17it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.04it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.00it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  6.82it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.81it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  6.75it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  6.84it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.83it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.13it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.99it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.13it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  6.93it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.11it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:04,  6.94it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.92it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.96it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.92it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.03it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.32it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.11it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.10it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.18it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.28it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.31it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.03it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.11it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.23it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.24it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.26it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.34it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.06it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.20it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.07it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.19it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.17it/s]
FOLD 0
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B  2.36332     0.250388
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.74it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.70it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.58it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.57it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.48it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.33it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.26it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.06it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.97it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.89it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.87it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.83it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.73it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.71it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.52it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.55it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.49it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.60it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.53it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.72it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 769.03it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:05, 17.00it/s]  4%|â–         | 4/100 [00:00<00:05, 17.33it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.44it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.50it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.53it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.55it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 17.52it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.54it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.56it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.57it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.58it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.58it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.58it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 17.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.47it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.50it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.48it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.50it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.52it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.59it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.47it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.50it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.52it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.55it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.57it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.57it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.57it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.58it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 17.60it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.33it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.06it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.31it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.39it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.46it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.48it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.50it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 17.53it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.56it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.56it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.58it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.58it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.58it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.51it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 354.40it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.79it/s]  2%|â–         | 2/100 [00:00<00:13,  7.24it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.36it/s]  4%|â–         | 4/100 [00:00<00:12,  7.45it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.50it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.49it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.53it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.56it/s]  9%|â–‰         | 9/100 [00:01<00:11,  7.59it/s] 10%|â–ˆ         | 10/100 [00:01<00:11,  7.59it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.61it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.57it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.58it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.60it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:11,  7.59it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.60it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.61it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.62it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.62it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.63it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.60it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.57it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.59it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.60it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.60it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.62it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.62it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:03<00:09,  7.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:08,  7.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.61it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.59it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.60it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.61it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.62it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.62it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.56it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.55it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:05<00:07,  7.52it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.51it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.49it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.38it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.43it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.45it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.49it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.50it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.50it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.50it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.53it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.55it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.55it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.55it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:07<00:05,  7.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.55it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.49it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.51it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.52it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.52it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.53it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.51it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.52it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.52it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.54it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.54it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.54it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:09<00:03,  7.54it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.54it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.54it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.54it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.47it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.48it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.49it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.52it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:10<00:02,  7.54it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.48it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.51it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.43it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.43it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.47it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.50it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:11<00:01,  7.52it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.55it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.54it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.55it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.47it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:12<00:00,  7.51it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.49it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.50it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.54it/s]
FOLD 1
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B   2.5296     0.355154
[2.44645996 0.30277128]
2023-12-03 14:46:46.018312: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:46:46.069571: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:46:46.816783: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 369.54it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.24it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.99it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.74it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.36it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.20it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.91it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.72it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.48it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.41it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.35it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.29it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.24it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.21it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.14it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.17it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.07it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.01it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.00it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.98it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.96it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.99it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.03it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.80it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.66it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.73it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.71it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.75it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.99it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.04it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.11it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:47:06.494495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 268.75it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.16it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.38it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.51it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.40it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 11.00it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.19it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.22it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.05it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.70it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.18it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.44it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.67it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.90it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.07it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.18it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 16.26it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.33it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.38it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.41it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.33it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.36it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.41it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.43it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.45it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:02, 16.45it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.47it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.48it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.49it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.18it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.25it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.42it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.45it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.47it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.48it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.47it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.48it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.49it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.50it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.50it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.50it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.51it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.51it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.41it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.44it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.46it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.48it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.10it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 349.85it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.50it/s]  2%|â–         | 2/100 [00:00<00:16,  6.06it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.60it/s]  4%|â–         | 4/100 [00:00<00:13,  6.90it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.06it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.88it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.83it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.92it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.99it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.12it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.06it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.15it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  6.95it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  7.08it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.18it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.25it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.31it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.15it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.15it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.22it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.21it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.20it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.06it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.16it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.24it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.29it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.33it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.19it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.25it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.24it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.29it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.32it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.09it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  6.94it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  7.07it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.17it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.18it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.35it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.16it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.02it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.12it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.21it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.07it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.17it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.19it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.06it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.16it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.09it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.04it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  7.14it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.18it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.30it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.09it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  6.99it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.13it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.32it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.35it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.37it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.96it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.03it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.04it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.14it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  6.91it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.05it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:03,  6.97it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  6.91it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.05it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.16it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.24it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.33it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.16it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.19it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.23it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.28it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.11it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.13it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.15it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.30it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.35it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.16it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.03it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.95it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.13it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.424795     0.308742
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.95it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.93it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.79it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.78it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.72it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.60it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.52it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.40it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.25it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.13it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  9.07it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.99it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.92it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.87it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.85it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.82it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.74it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.65it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.58it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.60it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.69it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.69it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.57it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.68it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.66it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.76it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.77it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.73it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.66it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.19it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.85it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 336.89it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.25it/s]  4%|â–         | 4/100 [00:00<00:05, 16.11it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.40it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.55it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.64it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.69it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.71it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.72it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.74it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.76it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.76it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.78it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.78it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.78it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.79it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.78it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.79it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.73it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.62it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.59it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.60it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.58it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.39it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.13it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.41it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.48it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.54it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.60it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.59it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.51it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.51it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.55it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.59it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.42it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.40it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.44it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.24it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.33it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.39it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.52it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 343.46it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.71it/s]  2%|â–         | 2/100 [00:00<00:13,  7.11it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.24it/s]  4%|â–         | 4/100 [00:00<00:13,  7.28it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.31it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.33it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.30it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.32it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.27it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.18it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.26it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.27it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.26it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.30it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.31it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.97it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:12,  6.91it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.93it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.04it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.14it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.23it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.32it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.36it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.36it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.39it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.40it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.41it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.41it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.39it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.41it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.41it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.28it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.32it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.34it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.37it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.39it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.40it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.41it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.33it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.37it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.39it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.40it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.42it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.43it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.41it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.41it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.41it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.42it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.43it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.43it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.43it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.44it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.43it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.40it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.40it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.34it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.20it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.27it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.38it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.40it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.42it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.43it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.43it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.44it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.32it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.30it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.37it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.40it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.42it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.41it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.43it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.44it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.45it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.44it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.45it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.44it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.44it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.39it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.37it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.34it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.37it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.37it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.39it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.39it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.39it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.41it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.22it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.33it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.38it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.40it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.41it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.34it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.885234     0.706588
[2.65501465 0.50766463]
2023-12-03 14:48:08.529289: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:48:08.579399: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:48:09.330205: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 375.63it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.28it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.16it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.00it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.80it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.36it/s]  9%|â–‰         | 3/32 [00:00<00:03,  8.96it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.84it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.70it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:03,  8.57it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.41it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.32it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.02it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  7.93it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  7.93it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  7.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.76it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  7.88it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.90it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.92it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.91it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.91it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.83it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.78it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.81it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.84it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.83it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.75it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.83it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.81it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.83it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.00it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.99it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.80it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.86it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.59it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.97it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:48:29.005866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 262.29it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.17it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.39it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.50it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.36it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 10.95it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.24it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.19it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 13.88it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.49it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 14.94it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.19it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.45it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.46it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.42it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 15.61it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:04, 15.67it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 15.71it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 15.74it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 15.75it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 15.78it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 15.75it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 15.77it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 15.80it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 15.78it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 15.79it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 15.80it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 15.82it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 15.91it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 15.65it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 15.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 15.83it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 15.90it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 15.97it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.01it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.04it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 15.84it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 15.90it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 15.92it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 15.93it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 15.99it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.01it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.00it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.00it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.01it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 15.87it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:07<00:00, 15.92it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 15.51it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.72it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 381.99it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.43it/s]  2%|â–         | 2/100 [00:00<00:16,  6.01it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.53it/s]  4%|â–         | 4/100 [00:00<00:14,  6.66it/s]  5%|â–Œ         | 5/100 [00:00<00:14,  6.57it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.80it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.81it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.63it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.76it/s] 10%|â–ˆ         | 10/100 [00:01<00:13,  6.90it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.89it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:13,  6.63it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  6.83it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.97it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.08it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.99it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:12,  6.89it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:12,  6.70it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  6.79it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.88it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.01it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.88it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.86it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:11,  6.74it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:11,  6.74it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  6.89it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.98it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  7.06it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  6.77it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.92it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:10,  6.89it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.00it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.98it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:05<00:09,  6.88it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.97it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:09,  6.72it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:09,  6.75it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:09,  6.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  6.83it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:06<00:08,  6.98it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  6.94it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  6.93it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.97it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.07it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.90it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.97it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:07<00:07,  6.86it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  6.81it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  6.89it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.02it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:07,  6.83it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.95it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.01it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:08<00:06,  6.81it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  6.81it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.96it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.06it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.14it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.19it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:09<00:05,  7.25it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:09<00:05,  7.20it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:04,  7.24it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.28it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.27it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.00it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.80it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:10<00:04,  6.96it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:10<00:04,  6.99it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.09it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.16it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.06it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.98it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.01it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:11<00:03,  7.09it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  7.13it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.16it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.18it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.83it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  6.84it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  6.87it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:12<00:02,  6.85it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  6.87it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:02,  6.73it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  6.86it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  6.98it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.00it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:13<00:01,  7.07it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:13<00:01,  7.11it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  6.82it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.94it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  6.77it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.86it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  6.98it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:14<00:00,  7.03it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:14<00:00,  7.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  6.99it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.93it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.526191     0.412396
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.80it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.76it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.54it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.50it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.16it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.06it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.65it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.50it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.57it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.41it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.49it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.46it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.43it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.44it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.42it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.38it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.34it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.17it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.29it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.27it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.32it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.25it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.38it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.36it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.83it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.43it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 256.06it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.79it/s]  4%|â–         | 4/100 [00:00<00:06, 15.59it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 15.86it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.01it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.08it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.14it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.18it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.19it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.16it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.18it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.14it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.15it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.17it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.18it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.19it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.20it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.20it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.22it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.22it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.22it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.21it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.23it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.23it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.23it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.23it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.22it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 15.88it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 15.96it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.04it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.09it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.13it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.17it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.21it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.22it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.23it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.19it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.15it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 265.45it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.41it/s]  2%|â–         | 2/100 [00:00<00:14,  6.79it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.02it/s]  4%|â–         | 4/100 [00:00<00:13,  7.15it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.12it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.02it/s]  7%|â–‹         | 7/100 [00:00<00:13,  7.12it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.05it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.14it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.20it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.24it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.28it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.30it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.32it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.04it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.06it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.14it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.19it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.14it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.19it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.23it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.29it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.27it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.25it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.27it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.29it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.29it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.31it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.24it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.28it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.30it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.24it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.27it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.28it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.01it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.97it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.93it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.04it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  7.11it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.01it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:08,  6.77it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.93it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.05it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.13it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.16it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.19it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.27it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.14it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  6.85it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  6.78it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.88it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.01it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.09it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  6.90it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.96it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.06it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  7.14it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.94it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  6.89it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.95it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.14it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  6.85it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  6.99it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.08it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.02it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.04it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.00it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.09it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.22it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.20it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.09it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.22it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.27it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.29it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.31it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.32it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.33it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.26it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.28it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.31it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.32it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  6.98it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.09it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.17it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.14it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.012109      0.81951
[2.76915039 0.61595298]
2023-12-03 14:49:32.986217: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:49:33.035014: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:49:33.783829: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 374.66it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.45it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.12it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.01it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.97it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.56it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.18it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.09it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.96it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.76it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.67it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.59it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.46it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.37it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.36it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.29it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.26it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.15it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.14it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.17it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.09it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.07it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.09it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.13it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.12it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.96it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.03it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.97it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.99it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.18it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.14it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.17it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.78it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.25it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:49:52.947889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 268.85it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:29,  3.26it/s]  5%|â–Œ         | 5/100 [00:01<00:16,  5.66it/s]  7%|â–‹         | 7/100 [00:01<00:11,  8.03it/s]  9%|â–‰         | 9/100 [00:01<00:08, 10.24it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 12.17it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.70it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 14.96it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.96it/s] 19%|â–ˆâ–‰        | 19/100 [00:01<00:04, 16.71it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 17.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 17.70it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 18.00it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 18.20it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:03, 18.36it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 18.34it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 18.46it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.42it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:02<00:03, 18.47it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.53it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.43it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.47it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:02, 18.51it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.56it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.57it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.14it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:03<00:02, 18.08it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.36it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.47it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:01, 18.50it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.56it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.61it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.64it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.67it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:04<00:01, 18.68it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 18.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.35it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.35it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.40it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.45it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.52it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:05<00:00, 18.54it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 18.37it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.47it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.49it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.50it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.68it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 339.70it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.90it/s]  2%|â–         | 2/100 [00:00<00:14,  6.61it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.73it/s]  4%|â–         | 4/100 [00:00<00:14,  6.77it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.11it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.33it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.48it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.12it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.31it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.10it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.30it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.02it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.25it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.41it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.53it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.33it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.40it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.51it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.60it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.34it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.49it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.59it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.59it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:09,  7.64it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.12it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.32it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.04it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.26it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  6.98it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.21it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.38it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.52it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.18it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.36it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.51it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.30it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.45it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.54it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.62it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.33it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.41it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.44it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.61it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.37it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.31it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.03it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.25it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  6.98it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.15it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.34it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.41it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.10it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  6.96it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.20it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.09it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.98it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.39it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.45it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.55it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.35it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.48it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.59it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.59it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.60it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.50it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.54it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.58it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.20it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.35it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.03it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  6.99it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.20it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.37it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.44it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.32it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.38it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.51it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.60it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.64it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.66it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.61it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.68it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.73it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.43it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.29it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.40it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.35it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.274756     0.154667
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.66it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.65it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.42it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.37it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.29it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.14it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.04it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.74it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.64it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.57it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.52it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.47it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.43it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.42it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.46it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.49it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.40it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.97it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.07it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.10it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.36it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.38it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.43it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.37it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.41it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.52it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.52it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.50it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.81it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.46it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 340.14it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:05, 17.10it/s]  4%|â–         | 4/100 [00:00<00:05, 18.01it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 18.34it/s]  8%|â–Š         | 8/100 [00:00<00:04, 18.50it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.55it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.59it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.65it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.68it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.15it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.20it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.27it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 18.35it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.36it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.36it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.39it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.40it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.19it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.29it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.30it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 18.36it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.39it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.40it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.03it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.98it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.08it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.45it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.51it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.56it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.60it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.47it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 18.52it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.60it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.59it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.60it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.61it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.58it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.14it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 18.15it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.40it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.45it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.51it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.38it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 347.82it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.14it/s]  2%|â–         | 2/100 [00:00<00:13,  7.19it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.15it/s]  4%|â–         | 4/100 [00:00<00:13,  7.38it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.09it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.22it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.40it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.52it/s]  9%|â–‰         | 9/100 [00:01<00:11,  7.62it/s] 10%|â–ˆ         | 10/100 [00:01<00:11,  7.65it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.69it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.72it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.71it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.68it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:11,  7.70it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:10,  7.75it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.78it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.47it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.59it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.58it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.61it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.64it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:09,  7.69it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.70it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.32it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.39it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.48it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.55it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:03<00:09,  7.61it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.66it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:08,  7.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.51it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.41it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.50it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.31it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.26it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.37it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.42it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.33it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.22it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.39it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.50it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.31it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.38it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.51it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.48it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.33it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.46it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.50it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.38it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.36it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.47it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.55it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.42it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.56it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.55it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.60it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.66it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.53it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.34it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.47it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.45it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.32it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.26it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.14it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.26it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.33it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.13it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.33it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.44it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.43it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.18it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.37it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.41it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.52it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.06it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.18it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.37it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.34it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.46it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.57it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.45it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.54it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.44it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.53it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.45it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.744893     0.564334
[2.50982422 0.35950048]
2023-12-03 14:50:54.094785: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:50:54.143892: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:50:54.906925: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 371.01it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.24it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.17it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.00it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.94it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.55it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.17it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.02it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.91it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.70it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.57it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.53it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.41it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.33it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.06it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.86it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  7.93it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.96it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.99it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.00it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.99it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.98it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.98it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.67it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.61it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.76it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.75it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.79it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.01it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.84it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.87it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.93it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.05it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:51:14.050823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 262.13it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.22it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.54it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.77it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.75it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.47it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.72it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.85it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 14.79it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.48it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 16.01it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.40it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.68it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.76it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.94it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 17.06it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.12it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.94it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.93it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.00it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.03it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.11it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.99it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.08it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.06it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.16it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.24it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.29it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.09it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.13it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 17.20it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.19it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.24it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 17.26it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.19it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 17.23it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 17.23it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 17.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.93it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 17.05it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 17.13it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 17.18it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.15it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.15it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.14it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.94it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 17.06it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.68it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 350.28it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.56it/s]  2%|â–         | 2/100 [00:00<00:15,  6.36it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.81it/s]  4%|â–         | 4/100 [00:00<00:13,  6.98it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.94it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.12it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.25it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.30it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.36it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.25it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.34it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  6.97it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.10it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.20it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.28it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.25it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.33it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.22it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.01it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.16it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.14it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  7.04it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.80it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.01it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.15it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.24it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.31it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.34it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.39it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.04it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.93it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.10it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.01it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.14it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.10it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.13it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.08it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.19it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  6.94it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  6.93it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.95it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  6.89it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.06it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.97it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.06it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.23it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  7.00it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.06it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.15it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.24it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.03it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  7.01it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.07it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  6.91it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.06it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.17it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.11it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.20it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:04,  7.27it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.16it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.16it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.23it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.06it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.17it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.18it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.24it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.10it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.21it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.00it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.14it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.05it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.21it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.30it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.33it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.26it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.29it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.35it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.41it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.44it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.16it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.21it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.31it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.39it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.24it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.20it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  6.96it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  6.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.14it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.774736     0.662493
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.69it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.57it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.40it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.44it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.38it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.16it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.08it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.80it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.68it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.51it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.48it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.44it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.42it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.41it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.34it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.33it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.92it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.03it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.20it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.25it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.10it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.25it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.29it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.31it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.27it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.82it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.41it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 351.37it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.82it/s]  4%|â–         | 4/100 [00:00<00:05, 16.79it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.16it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.37it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.49it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.55it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 17.56it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.56it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.42it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.41it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.49it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.55it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.58it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.49it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 17.49it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.53it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.50it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.48it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.08it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.02it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.20it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.36it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.35it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.46it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.59it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.51it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.44it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.47it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.54it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.47it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.55it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 17.59it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.50it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.51it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.30it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.39it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.47it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.52it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 17.53it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.59it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.47it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.46it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.53it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.45it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 345.01it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.70it/s]  2%|â–         | 2/100 [00:00<00:13,  7.03it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.23it/s]  4%|â–         | 4/100 [00:00<00:13,  7.32it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.35it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.21it/s]  7%|â–‹         | 7/100 [00:00<00:13,  6.99it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.14it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.21it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.27it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.94it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.01it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.15it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:12,  6.82it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.02it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.82it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.02it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.97it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.10it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.87it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.06it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.20it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.98it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.10it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  6.92it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.11it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.90it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.09it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.21it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.31it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  6.98it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.88it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.22it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.05it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.16it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.33it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.31it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.92it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.08it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.18it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.24it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.24it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.19it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.28it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.01it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  7.01it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.10it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.23it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.33it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.25it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.24it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.02it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:05,  7.17it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.15it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.13it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.01it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.17it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  6.97it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.13it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.67it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:05,  6.80it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.95it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.13it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.25it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.40it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.22it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.25it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.34it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.41it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.45it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.45it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.46it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.48it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.36it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.39it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.16it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.28it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.37it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.35it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.41it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.18it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.29it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  6.89it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.03it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.10it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.23it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.30it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.00it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  6.81it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.00it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.14it/s]
FOLD 1
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B  3.29248     1.087146
[3.0336084  0.87481919]
2023-12-03 14:52:15.993870: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:52:16.043237: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:52:16.795535: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 336.54it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.38it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.25it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.10it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.71it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.31it/s]  9%|â–‰         | 3/32 [00:00<00:03,  8.90it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.77it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.51it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:03,  8.52it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.47it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.40it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.30it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.17it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.18it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.12it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.98it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.96it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.98it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.96it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.98it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.90it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.69it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.83it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.91it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.93it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.90it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.86it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.90it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.10it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.13it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.03it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:52:36.760690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 270.95it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.19it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.44it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.55it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.47it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 11.10it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.43it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.47it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.26it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.85it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.58it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.79it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.95it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.06it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.14it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:04, 16.20it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 16.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.28it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.29it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.30it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.31it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.30it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.31it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.33it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.34it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.35it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.35it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.35it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.35it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 15.79it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 15.94it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 15.99it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.10it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.19it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.32it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.34it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.36it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.38it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.38it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.38it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.06it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 357.78it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.32it/s]  2%|â–         | 2/100 [00:00<00:15,  6.15it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.57it/s]  4%|â–         | 4/100 [00:00<00:13,  6.86it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.05it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.17it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.24it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.26it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.09it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.09it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.11it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.18it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.24it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.21it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.00it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.85it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.01it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.97it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.09it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.92it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.05it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.16it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.23it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.14it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.22it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.28it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.32it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.35it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.36it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.38it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.15it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.02it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.11it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.20it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.24it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  7.00it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.06it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.16it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.93it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.06it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.16it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.03it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.93it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.06it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.82it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.89it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.03it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.15it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.22it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.24it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.28it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.32it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.10it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.11it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.20it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  7.11it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.19it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.99it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.11it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.19it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.11it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.19it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.25it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.29it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.33it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.00it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.11it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.19it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.25it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.07it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.10it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.97it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.01it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  6.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.87it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:03,  6.97it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.09it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.24it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.29it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.32it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.35it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.37it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.31it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.27it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.01it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.19it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.26it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.29it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.26it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.33it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.35it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.38it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.13it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.958711     0.833778
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.56it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.48it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.27it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.27it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.22it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.88it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.89it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.81it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.70it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.45it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.42it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.39it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.39it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.38it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.32it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.28it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.25it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.27it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.29it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.27it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.24it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.31it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.74it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.40it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 265.29it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.32it/s]  4%|â–         | 4/100 [00:00<00:05, 16.09it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.35it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.48it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.54it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.59it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.54it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.54it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.59it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.61it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.63it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.68it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.68it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.69it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.69it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.69it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.68it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.69it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.69it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.69it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.69it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.70it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:02, 16.69it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.69it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.68it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.69it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.70it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.70it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.69it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.69it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.70it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.70it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.69it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.70it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.70it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.70it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.69it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.70it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.70it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.70it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.68it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.69it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.70it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.70it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.70it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.70it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.70it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.65it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 323.78it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.86it/s]  2%|â–         | 2/100 [00:00<00:14,  6.70it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.92it/s]  4%|â–         | 4/100 [00:00<00:13,  7.12it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.24it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.30it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.36it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.39it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.41it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.42it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.41it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.44it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.44it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.43it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.43it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.35it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.38it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.27it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.26it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.27it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.25it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.31it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.36it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.14it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.04it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.14it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.23it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.30it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.34it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.38it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.41it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.43it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.44it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.39it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.41it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.04it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.16it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.31it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.35it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.29it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.33it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.09it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.19it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.00it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.13it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.22it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.29it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.31it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.04it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  6.95it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.10it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.14it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.02it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.01it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  6.99it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  7.12it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.89it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  6.95it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.85it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.95it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.10it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.12it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.15it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.23it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.30it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.27it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.26it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.12it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.21it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.03it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.11it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.09it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.19it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.28it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.33it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.40it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.30it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.34it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.37it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.40it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.24it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.22it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  4.610801     2.414218
[3.78475586 1.62399815]
2023-12-03 14:53:40.180338: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:53:40.229383: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:53:40.974820: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 253.02it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.14it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.99it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.56it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.20it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.08it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.93it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.71it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.60it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.47it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.34it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.24it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.16it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.13it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.15it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.07it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.05it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.07it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.99it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.97it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.01it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.04it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.79it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.81it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.79it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.81it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.00it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.05it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.04it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.71it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.15it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:54:00.810658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 261.98it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.14it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.35it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.46it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.36it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 10.97it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.29it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.32it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.10it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.68it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.09it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.29it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.54it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.66it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.89it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.97it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 16.03it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.06it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 15.99it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.04it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.07it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.07it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 16.10it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.12it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.13it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.13it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.04it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.07it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.06it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.09it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 16.11it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.12it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.14it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.10it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.10it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.06it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.09it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.10it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 16.12it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.13it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.14it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.13it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.14it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.15it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.13it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.11it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:07<00:00, 16.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.89it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 351.52it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.40it/s]  2%|â–         | 2/100 [00:00<00:15,  6.19it/s]  3%|â–Ž         | 3/100 [00:00<00:15,  6.39it/s]  4%|â–         | 4/100 [00:00<00:14,  6.66it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.82it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.76it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.94it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.00it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.98it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  6.93it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.04it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  6.91it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  6.88it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.81it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  6.96it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.07it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.13it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.93it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  6.82it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.78it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  6.67it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.80it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.88it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:11,  6.61it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:11,  6.75it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  6.78it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.69it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  6.87it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  6.87it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.82it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:10,  6.83it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.85it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.99it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.09it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:05<00:09,  6.96it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.94it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.05it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.13it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.18it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.21it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.95it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  7.05it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.14it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.20it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.22it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  7.24it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.26it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.13it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.11it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.11it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.17it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.22it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  7.23it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:05,  7.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.29it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.30it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.16it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.15it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:09<00:05,  7.06it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.00it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.09it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.92it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.97it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  6.94it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:10<00:04,  6.98it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.06it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.13it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.18it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.15it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.14it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.93it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.12it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.98it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.08it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.08it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.15it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  6.86it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:02,  6.92it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  6.72it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  6.82it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  6.66it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  6.85it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:13<00:01,  6.98it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.09it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.96it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  6.92it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.05it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.14it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.01it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:14<00:00,  7.04it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.06it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.00it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.606836     1.461698
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.90it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.85it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.70it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.68it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.62it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.50it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.42it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.28it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.13it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.02it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.94it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.88it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.82it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.75it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.68it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.67it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.64it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.59it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.60it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.68it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.52it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.54it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.69it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.65it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.57it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.77it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 339.89it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.78it/s]  4%|â–         | 4/100 [00:00<00:06, 15.54it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 15.74it/s]  8%|â–Š         | 8/100 [00:00<00:05, 15.91it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.01it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.07it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.09it/s] 16%|â–ˆâ–Œ        | 16/100 [00:01<00:05, 16.06it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.05it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.07it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.09it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.12it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.11it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.03it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.07it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.10it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.12it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.14it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.12it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.12it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.13it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.04it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.08it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.13it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.14it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.14it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.14it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.14it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.14it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.06it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.10it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 16.12it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.14it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.10it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.12it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.14it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.14it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.13it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.14it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.15it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.14it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.16it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.17it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.18it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.18it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.18it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.09it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 331.64it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.54it/s]  2%|â–         | 2/100 [00:00<00:14,  6.62it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.91it/s]  4%|â–         | 4/100 [00:00<00:13,  7.06it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.90it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.01it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.84it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.85it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.79it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  6.94it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.03it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.11it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  6.92it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.91it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.03it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.08it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.09it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.15it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  6.93it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.98it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.08it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.16it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.14it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  6.93it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.05it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.13it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.08it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.08it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  7.01it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.05it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.13it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.19it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.88it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.01it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.11it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.84it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:09,  6.92it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.80it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  6.72it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.74it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  6.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  6.60it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.68it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:08,  6.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.67it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.86it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  6.95it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  6.80it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.97it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.01it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.04it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.14it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.22it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  7.03it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.85it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.99it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:06,  6.71it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.83it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  6.97it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.97it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:09<00:05,  7.08it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.16it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.21it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.26it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.12it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.98it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  6.91it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:10<00:04,  7.04it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.06it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.10it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.17it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.26it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.19it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:11<00:03,  7.26it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  7.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.15it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.14it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.14it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.26it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  7.28it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.10it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.11it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.18it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.09it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.17it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:13<00:01,  6.83it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  6.82it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.97it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.09it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.93it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.06it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.10it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  6.92it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.01it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  5.203437     2.986191
[4.40513672 2.22394421]
2023-12-03 14:55:04.393082: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:55:04.442281: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:55:05.190301: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 372.46it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.35it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.17it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.84it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.50it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.16it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.06it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.92it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.83it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.71it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.61it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.45it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.33it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.19it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.16it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.18it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.15it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.12it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.09it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.10it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.03it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.99it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.03it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.06it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.06it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.92it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.96it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.91it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.87it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.07it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.04it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.08it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.74it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.19it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:55:25.165264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 261.78it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.20it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.59it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.95it/s]  9%|â–‰         | 9/100 [00:01<00:08, 10.16it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 12.10it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.72it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 15.02it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 16.03it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:04, 16.76it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 17.32it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 17.73it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 18.03it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 18.25it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:03, 18.40it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 18.50it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 18.58it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.64it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:02<00:03, 18.69it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.72it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.48it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.54it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:02, 18.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.68it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.69it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.71it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:03<00:02, 18.73it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.73it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.75it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.77it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:01, 18.79it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.80it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.81it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.80it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.81it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:04<00:01, 18.82it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:04<00:01, 18.82it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.82it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.81it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.80it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.80it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.81it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.81it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.82it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:05<00:00, 18.82it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:05<00:00, 18.79it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.79it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.78it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.80it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 358.30it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.67it/s]  2%|â–         | 2/100 [00:00<00:15,  6.29it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.70it/s]  4%|â–         | 4/100 [00:00<00:13,  6.97it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.25it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.18it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.15it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.30it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.24it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.00it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.08it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.14it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.34it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.33it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.46it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.57it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.64it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.39it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.44it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.55it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.25it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.34it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.47it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.56it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.36it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.48it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.52it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.32it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.32it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.46it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.51it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:08,  7.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.44it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.56it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.31it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.44it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.56it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.64it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.70it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.27it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.16it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.34it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.50it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.68it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.72it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.50it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.51it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.46it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.39it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.51it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.68it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.41it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.52it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.59it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.36it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.43it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.21it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.52it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.53it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.38it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.36it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.42it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.52it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.60it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.67it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.46it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.49it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.59it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.66it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.70it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.73it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.75it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.69it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.73it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.75it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.70it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.66it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.71it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.59it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.66it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.61it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.66it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.70it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.73it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.75it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.77it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.70it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.57it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.48it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.130146     0.015859
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.69it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.65it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.51it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.50it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.44it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.30it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.23it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.09it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.96it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.84it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.78it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.71it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.48it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.25it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.29it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.27it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.32it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.43it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.42it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.42it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.35it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.38it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.49it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.43it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.41it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.35it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.89it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.57it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 350.05it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:05, 17.01it/s]  4%|â–         | 4/100 [00:00<00:05, 17.96it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 18.30it/s]  8%|â–Š         | 8/100 [00:00<00:04, 18.45it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.54it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.54it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.60it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.63it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.60it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.62it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.61it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:03, 18.65it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.67it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.65it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.67it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.71it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.72it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.71it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:02, 18.72it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.71it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.71it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.71it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 18.67it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.68it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.68it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.71it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.71it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.72it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.73it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.75it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.76it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:03<00:01, 18.75it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.75it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.72it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.69it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.72it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.75it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.76it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.77it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.78it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:04<00:00, 18.77it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.77it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.73it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.73it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.73it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.67it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 273.94it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.52it/s]  2%|â–         | 2/100 [00:00<00:14,  6.94it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.31it/s]  4%|â–         | 4/100 [00:00<00:13,  7.21it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.33it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.49it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.34it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.47it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.58it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.31it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.38it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.29it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.36it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.48it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.58it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.63it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.56it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.56it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.62it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.69it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.74it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.35it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.48it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.26it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.07it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.13it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.97it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.19it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.37it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.27it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.33it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.47it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.54it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.61it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.68it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.67it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.71it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.36it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.49it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.27it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.30it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.45it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.47it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.56it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.27it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.42it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.23it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.24it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.40it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.39it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.29it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.42it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.48it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.29it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.44it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.52it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.53it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.54it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.66it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.71it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.24it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.36it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.42it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.62it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.68it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.71it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.74it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.75it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.75it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.77it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.74it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.51it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.44it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.27it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.40it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.21it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.32it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.43it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.03it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.08it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:02,  6.83it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  6.98it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.12it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.27it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.40it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.34it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.23it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.36it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.37it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.47it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.61it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.41it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.215742     0.053577
[2.17294434 0.03471779]
2023-12-03 14:56:25.657585: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:56:25.706941: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:56:26.458102: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 364.06it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.20it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.08it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.92it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.85it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.45it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.08it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.90it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.68it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:03,  8.62it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.37it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.27it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.18it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.08it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.00it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.94it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  7.92it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.88it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.83it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.84it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.75it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.75it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.77it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.85it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.90it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.91it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.78it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.84it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.80it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.48it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  7.61it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.70it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.51it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.95it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:56:45.663950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 266.71it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.19it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.49it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.68it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.72it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.48it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.95it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.83it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 14.61it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.31it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 15.83it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.21it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.40it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.60it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.60it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.68it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 16.86it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 17.00it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 17.10it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.14it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.16it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.16it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 17.08it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.13it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.19it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.25it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.03it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.02it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.13it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.21it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.23it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 17.23it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.08it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 17.00it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.07it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.15it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 17.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 17.02it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.88it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.93it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 17.04it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 17.11it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 17.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.29it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 17.29it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 17.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.64it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 350.11it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.60it/s]  2%|â–         | 2/100 [00:00<00:15,  6.20it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.72it/s]  4%|â–         | 4/100 [00:00<00:14,  6.69it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.99it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.08it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.81it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.96it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.12it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.22it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.15it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.28it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.37it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.98it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  6.84it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.03it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.13it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.26it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.35it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.25it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.21it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.31it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.31it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.24it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.07it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.14it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.23it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.27it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.21it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.25it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.35it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.43it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.40it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.24it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.27it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.36it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.42it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.48it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.30it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.11it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.00it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.11it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.00it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.18it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.18it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.17it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.15it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.11it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.12it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.38it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.30it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.38it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.45it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.49it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.33it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.20it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.32it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.42it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.44it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.27it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.37it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.43it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.16it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.09it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.15it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.29it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.17it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.09it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.34it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.44it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.50it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.22it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.34it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.31it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.46it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.37it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.36it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.44it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.49it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.52it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.54it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.40it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.47it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.50it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.25it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.35it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.35it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.37it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.49it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.25it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.172539     0.057826
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.84it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.79it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.66it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.64it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.56it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.43it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.36it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.22it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.05it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.94it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.88it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.81it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.75it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.70it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.69it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.67it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.60it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.59it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.54it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.61it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.57it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.42it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.53it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.45it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.50it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.59it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.59it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.56it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.48it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.70it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 341.58it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.13it/s]  4%|â–         | 4/100 [00:00<00:05, 17.00it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.30it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.45it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.55it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.59it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 17.62it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.65it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.66it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.67it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.69it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.69it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.69it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.70it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 17.71it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.63it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.65it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.67it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.68it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.69it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.70it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.70it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.71it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.66it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.68it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.69it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.70it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.71it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.71it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.71it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 17.71it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.57it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.61it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.66it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.41it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.48it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.55it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.60it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 17.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.65it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.67it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.69it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.70it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.71it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.71it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.63it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 346.26it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.46it/s]  2%|â–         | 2/100 [00:00<00:13,  7.04it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.27it/s]  4%|â–         | 4/100 [00:00<00:12,  7.40it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.17it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.32it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.42it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.48it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.29it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.39it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.47it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.51it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.55it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.47it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.51it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.24it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.35it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.22it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.34it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.03it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.19it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  7.02it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.19it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.32it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.42it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.27it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.34it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.32it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.41it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.48it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.52it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:08,  7.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.58it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.43it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.39it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.20it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.33it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.42it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.45it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.51it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.48it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.52it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.29it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.18it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.94it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.14it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.17it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.31it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.39it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.45it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.51it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.54it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.58it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.22it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.42it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.44it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.15it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.14it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.14it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.28it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.39it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.45it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.50it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.53it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.57it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.59it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.45it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.38it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.24it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.34it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.29it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.31it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.06it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.22it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.07it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.20it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.31it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.42it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.48it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.41it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.47it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.39it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.48it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.45it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.44it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.50it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.55it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.58it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.31it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.41it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.47it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.34it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.44it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.39it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.46it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.36it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.236172     0.080074
[2.20435547 0.06895   ]
2023-12-03 14:57:47.210894: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:57:47.260349: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:57:48.007038: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 372.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.26it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.17it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.01it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.77it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.41it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.05it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.96it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.84it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.74it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.62it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.52it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.36it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.25it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.21it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.14it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.09it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.11it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.04it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.00it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.01it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.93it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.89it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.93it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.97it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.95it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.81it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.86it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.81it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.81it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.98it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.02it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.00it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.11it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:58:07.024004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 269.47it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.15it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.39it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.55it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.49it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.16it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.52it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.58it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.40it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.00it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.44it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.75it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.98it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.13it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.24it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.34it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:04, 16.39it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.43it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.45it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.47it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.49it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.52it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.51it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.52it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.52it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:02, 16.51it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.52it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.53it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.53it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.52it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.53it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.54it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:01, 16.54it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.53it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.53it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.54it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.54it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.56it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.57it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.56it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.56it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.55it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.55it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.53it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.53it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 16.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.21it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 776.87it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.66it/s]  2%|â–         | 2/100 [00:00<00:15,  6.33it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.80it/s]  4%|â–         | 4/100 [00:00<00:14,  6.84it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.03it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.01it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.06it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.18it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.90it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.05it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.87it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.03it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.07it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:11,  7.18it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.23it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.29it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.34it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.96it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.02it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.94it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.01it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.99it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.98it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.10it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.18it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.26it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.23it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.29it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.30it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.29it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.13it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.94it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.07it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.18it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.18it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.12it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.05it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.16it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.21it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.10it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.18it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.20it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.26it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.97it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.96it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.97it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:06,  7.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.28it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.04it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.17it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:05,  7.23it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.14it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.14it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.21it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.13it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.21it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  6.99it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  7.00it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.12it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.28it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.32it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.35it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.37it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.38it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.24it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.08it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.10it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.00it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.04it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.08it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.04it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.08it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.06it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  6.92it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.06it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:02,  6.88it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  6.91it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.15it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.28it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.33it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.07it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.21it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.24it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.13it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.182871     0.075386
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.62it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.55it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.41it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.38it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.32it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.13it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.08it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.96it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.83it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.72it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.56it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.51it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.42it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.42it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.38it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.29it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.32it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.40it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.37it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.32it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.29it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.41it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.41it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.38it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.79it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.49it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 276.80it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.36it/s]  4%|â–         | 4/100 [00:00<00:05, 16.17it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.37it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.53it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.63it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.67it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.68it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.71it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.73it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.75it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.77it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.77it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.77it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.78it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.78it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.79it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.78it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.78it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.71it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.71it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.71it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.74it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.76it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.78it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 16.78it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.79it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.79it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.79it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.78it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.79it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.78it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.79it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.78it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.79it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.80it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.80it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.78it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.72it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.74it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.76it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.77it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.78it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.79it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.80it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.80it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.80it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.80it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.80it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.80it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.80it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.74it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 313.62it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  7.03it/s]  2%|â–         | 2/100 [00:00<00:13,  7.04it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.24it/s]  4%|â–         | 4/100 [00:00<00:13,  7.32it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.34it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.28it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.35it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.39it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.43it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.44it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.10it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.21it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.29it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.34it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.35it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.40it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.22it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.23it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.30it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.36it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.39it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.34it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.37it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.40it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.43it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.44it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.46it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.47it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.47it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.16it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.34it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.30it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.36it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.40it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.14it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.31it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.36it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.35it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.34it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.13it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.23it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.30it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.36it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.12it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.22it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.30it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.07it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.25it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.38it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.41it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.43it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.46it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.46it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.47it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.48it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.28it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.19it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.28it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.27it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.33it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.38it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.42it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.43it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.46it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.46it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.48it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.17it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.26it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.33it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.39it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.41it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.35it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.40it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.13it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.31it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.37it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.21it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.06it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.04it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.13it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.16it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.25it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.32it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.38it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.41it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.44it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.45it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.47it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.45it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.32it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.306777     0.149577
[2.24482422 0.11248182]
2023-12-03 14:59:10.184133: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 14:59:10.235597: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 14:59:10.983318: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 369.80it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.16it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.81it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.42it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.32it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.15it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.93it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.81it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.73it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.57it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.43it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.42it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.32it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.28it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.30it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.17it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.19it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.09it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.10it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.13it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.11it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.96it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.02it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.96it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.96it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.17it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.12it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.80it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.29it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 14:59:30.492268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 267.32it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.15it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.34it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.45it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.33it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 10.93it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.23it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.24it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.01it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.58it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.02it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.22it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.42it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.29it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.51it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.77it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 15.87it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 15.93it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 15.97it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 15.87it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 15.93it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 15.96it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 15.96it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 16.00it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.03it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.02it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.00it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.02it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 15.96it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 15.99it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.00it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 16.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.04it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.05it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.06it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.07it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.08it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.09it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 16.09it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.11it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.11it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.12it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.12it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.11it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.12it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:07<00:00, 16.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.83it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 349.58it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.45it/s]  2%|â–         | 2/100 [00:00<00:16,  5.99it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.53it/s]  4%|â–         | 4/100 [00:00<00:14,  6.68it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.91it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.05it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.99it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.09it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.83it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  6.99it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.09it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.07it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.15it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:11,  7.20it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.10it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.16it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.17it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.08it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  6.83it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.74it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  6.91it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.82it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:11,  6.83it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  6.98it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  6.99it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.99it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  6.89it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  6.95it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.06it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.14it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.13it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.18it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.15it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:05<00:09,  7.15it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.21it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.29it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.03it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.12it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.14it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  7.10it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.18it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.23it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  6.92it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.05it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.13it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.86it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  7.00it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  6.89it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.94it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.07it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.04it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.13it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  6.99it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  6.94it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.98it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.83it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  6.97it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.08it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.14it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.20it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.16it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  7.14it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.21it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.11it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.05it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.13it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.19it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.12it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.12it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.05it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.07it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.14it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.03it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.87it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.00it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.09it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.84it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  6.98it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  6.88it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.01it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  7.02it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.10it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.11it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.18it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.23it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.18it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.90it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.02it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.94it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  6.98it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  6.84it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  6.98it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  6.90it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.01it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.190566     0.087681
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.91it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.90it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.73it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.73it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.65it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.51it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.44it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.31it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.14it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.98it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.92it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.86it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.82it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.67it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.61it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.58it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.61it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.69it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.67it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.67it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.59it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.59it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.69it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.69it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.65it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.56it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.79it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 341.58it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.75it/s]  4%|â–         | 4/100 [00:00<00:06, 15.48it/s]  6%|â–Œ         | 6/100 [00:00<00:06, 15.63it/s]  8%|â–Š         | 8/100 [00:00<00:05, 15.81it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 15.81it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 15.92it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 15.99it/s] 16%|â–ˆâ–Œ        | 16/100 [00:01<00:05, 16.04it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.07it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.09it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.10it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.11it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.11it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.01it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.05it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:02<00:04, 16.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.09it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.11it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.11it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.12it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.13it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.11it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.02it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.10it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.12it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.13it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.14it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.14it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.14it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.14it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.14it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 16.15it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.15it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.14it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.15it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.15it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.16it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.16it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.11it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.11it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.12it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.13it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.14it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.14it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.14it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.14it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.07it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 272.53it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.44it/s]  2%|â–         | 2/100 [00:00<00:14,  6.66it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  6.93it/s]  4%|â–         | 4/100 [00:00<00:13,  7.08it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.91it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.06it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.07it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.15it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.18it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.23it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.27it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.30it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.17it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.22it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.26it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.29it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.31it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.31it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.18it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.17it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.00it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.11it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.18it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.22it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.25it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.28it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.31it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.32it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.32it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.34it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.34it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.33it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.28it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.29it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.32it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.33it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.99it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.09it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.02it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  6.93it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  7.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.14it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.21it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.26it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.22it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.26it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.03it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.11it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.19it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.98it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.09it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.17it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.14it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  6.96it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.92it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.03it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.12it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.06it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.07it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  7.09it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.16it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.15it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.90it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.02it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.12it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.19it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.09it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.16it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.02it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.06it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.14it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.12it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  6.94it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.99it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.09it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.10it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.16it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  6.96it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.07it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.27it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.29it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.30it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.30it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.25it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.28it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.09it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.09it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.17it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  6.89it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  6.78it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.13it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.341143     0.182165
[2.26585449 0.13492325]
2023-12-03 15:00:33.858767: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:00:33.908160: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:00:34.656619: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 369.09it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.20it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.73it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.36it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.03it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.94it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.82it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.71it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.59it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.49it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.33it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.19it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.17it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.10it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.06it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.07it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.04it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.87it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.87it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.90it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.85it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.82it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.87it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.91it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.91it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.77it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.83it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.78it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.78it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  7.99it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.94it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.98it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.96it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.01it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:00:54.292308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 263.86it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:41,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:29,  3.26it/s]  5%|â–Œ         | 5/100 [00:01<00:16,  5.65it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.97it/s]  9%|â–‰         | 9/100 [00:01<00:09, 10.07it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 12.01it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.62it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 14.92it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.92it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:04, 16.69it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 17.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 17.66it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 17.95it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 18.16it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:03, 18.31it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 18.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 18.49it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:02<00:03, 18.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.64it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:02, 18.58it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.59it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.60it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:03<00:02, 18.65it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.65it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.66it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.66it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:01, 18.67it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.66it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.68it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:04<00:01, 18.68it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 18.69it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.65it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.65it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.64it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.60it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:05<00:00, 18.64it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:05<00:00, 18.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.65it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.66it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.75it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 353.68it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.80it/s]  2%|â–         | 2/100 [00:00<00:14,  6.56it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.07it/s]  4%|â–         | 4/100 [00:00<00:13,  7.35it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.52it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.44it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.54it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.61it/s]  9%|â–‰         | 9/100 [00:01<00:11,  7.60it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.40it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.30it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.28it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.26it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:12,  7.15it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.19it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.36it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.28it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.36it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.19it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.28it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.43it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.45it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.46it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.57it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.65it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.62it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.50it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.30it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.44it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.25it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.15it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.33it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.24it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.32it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.45it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:07,  7.68it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.72it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.75it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.77it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.78it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.32it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.38it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.50it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.20it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.17it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.20it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.37it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.24it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.47it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.56it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.70it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.51it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.46it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.40it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.52it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.46it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.26it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.13it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.47it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.49it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.58it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.54it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.32it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.44it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.41it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.54it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.32it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.45it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.16it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.43it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.16it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.00it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.22it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.17it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.20it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.15it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.07it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.27it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  6.92it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.33it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.36it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.186934     0.074524
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.54it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.51it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.37it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.35it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.28it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.13it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.07it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.95it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.81it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.70it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.52it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.46it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.43it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.38it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.33it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.33it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.31it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.28it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.30it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.37it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.34it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.23it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.26it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.24it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.36it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.32it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.24it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.45it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 341.92it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.03it/s]  4%|â–         | 4/100 [00:00<00:05, 17.39it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.91it/s]  8%|â–Š         | 8/100 [00:00<00:05, 18.20it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.36it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.46it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.53it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.57it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.60it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.62it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.59it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:03, 18.61it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.64it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.65it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.66it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.65it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.60it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 18.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.60it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.64it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 18.65it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.66it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.66it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.65it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.66it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.66it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.67it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.66it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.66it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:03<00:01, 18.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.65it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.66it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.37it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.46it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.53it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:04<00:00, 18.61it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.55it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 272.45it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.20it/s]  2%|â–         | 2/100 [00:00<00:14,  6.86it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.26it/s]  4%|â–         | 4/100 [00:00<00:12,  7.46it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.59it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.67it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.63it/s]  8%|â–Š         | 8/100 [00:01<00:11,  7.68it/s]  9%|â–‰         | 9/100 [00:01<00:11,  7.72it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.35it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.48it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.49it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.58it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.21it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.38it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.34it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.18it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.09it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.28it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.37it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.48it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.21it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.37it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.49it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:09,  7.51it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.60it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.66it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.61it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.66it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.69it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.40it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.44it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.54it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.46it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.32it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.37it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.13it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.90it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.12it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.00it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.22it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.38it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.50it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.59it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.39it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.39it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.51it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.55it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.50it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.57it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.26it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  7.17it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.31it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.44it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.51it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.69it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.73it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.75it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.73it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.75it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.65it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.69it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.72it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.29it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.43it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.54it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.61it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.60it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.24it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.41it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.40it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.51it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.36it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.42it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.50it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.57it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.69it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.69it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.72it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.50it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.52it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.59it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.28it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.43it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.54it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.54it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.61it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.46it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.392529     0.224022
[2.28973145 0.14927301]
2023-12-03 15:01:55.896947: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:01:55.946785: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:01:56.694293: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 368.89it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.29it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.18it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.90it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.50it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.14it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.05it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.92it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.71it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.59it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.51it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.38it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.28it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.27it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.21it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.17it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.19it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.10it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.07it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.09it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.00it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.98it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.02it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.04it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.81it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.88it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.85it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.85it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.07it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.04it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.08it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.06it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.68it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.16it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:02:16.610346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 270.06it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.21it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.53it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.78it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.77it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.55it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.02it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 14.18it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 15.07it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.70it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 16.14it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.52it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.79it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.99it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.99it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 17.12it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.22it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 17.29it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 17.34it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.38it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.40it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.42it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 17.43it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.35it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.38it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.41it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.42it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.43it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.11it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.20it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 17.31it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.36it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.28it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 17.33it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.35it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.37it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 17.40it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 17.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 17.44it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 17.45it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 17.46it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 17.42it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 17.43it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.44it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.45it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.45it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.45it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 17.45it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 17.46it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.86it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 344.81it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.59it/s]  2%|â–         | 2/100 [00:00<00:15,  6.42it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.62it/s]  4%|â–         | 4/100 [00:00<00:14,  6.73it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.02it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.22it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.20it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.24it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.28it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.38it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.46it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.51it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.37it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.22it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.13it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.09it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.24it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.08it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.23it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.33it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.27it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.36it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.44it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.06it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.21it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.18it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.11it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  6.93it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  7.00it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.18it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.24it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.14it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.20it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.32it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.41it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.11it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.08it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.16it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.28it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.31it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.40it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.39it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.31it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.18it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.00it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.10it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.38it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.44it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.48it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.52it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.48it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.51it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.26it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.35it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.35it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.28it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.24it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.23it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.43it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.46it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.49it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.21it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.32it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.34it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.42it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.23it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.08it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.08it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.23it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.02it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.18it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.39it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.45it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.26it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.18it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.05it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  6.92it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.09it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.24it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.14it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.28it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.38it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.45it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.43it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.48it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.44it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.48it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.52it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.56it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.25it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.414941     0.297636
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.93it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.88it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.78it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.75it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.67it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.53it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.47it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.34it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.19it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  9.02it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.95it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.88it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.80it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.76it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.68it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.68it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.66it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.60it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.72it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.69it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.66it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.58it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.61it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.71it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.68it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.58it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.82it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 348.34it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.01it/s]  4%|â–         | 4/100 [00:00<00:05, 16.96it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.30it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.41it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.52it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.58it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 17.62it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.65it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.67it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.68it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.64it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.68it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.68it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 17.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.69it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.70it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.68it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.69it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.70it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.71it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.71it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.72it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.72it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.71it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.71it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.71it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.60it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.64it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.66it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.68it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.69it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.70it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 17.70it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.71it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.71it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.58it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.62it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.65it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.67it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.68it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.70it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 17.70it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.71it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.70it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.67it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.53it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.58it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.64it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 358.27it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.84it/s]  2%|â–         | 2/100 [00:00<00:14,  6.54it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.00it/s]  4%|â–         | 4/100 [00:00<00:13,  6.97it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.09it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.28it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.31it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.41it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.48it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.47it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.51it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.55it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.28it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.36it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.42it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.50it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.21it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.33it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.35it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.43it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.48it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.51it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.19it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.31it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.06it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.21it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.27it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.37it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.11it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.15it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.05it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.98it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.16it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.92it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.12it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.26it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.09it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  6.96it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.89it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.09it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.87it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  6.90it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  7.10it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.24it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.19it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.38it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.45it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.44it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.35it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.22it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.34it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.39it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.46it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.10it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.25it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.10it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.04it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.02it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.19it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.48it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.20it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.12it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.27it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.38it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.10it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.11it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.09it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.26it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.29it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.39it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.47it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.51it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.24it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.34it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.43it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.42it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.33it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.34it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.32it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.41it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.15it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.28it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.14it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.13it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.27it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.23it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.13it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.27it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.38it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.20it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.33it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.45it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.25it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.516748     0.349189
[2.46584473 0.32341236]
2023-12-03 15:03:18.174526: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:03:18.224682: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:03:18.987474: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 367.79it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.16it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.82it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.49it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.14it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.05it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.91it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.82it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.71it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.60it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.45it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.31it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.23it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.18it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.05it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.02it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.98it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.95it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.99it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.03it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.03it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.89it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.94it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.89it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.89it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.09it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.05it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.94it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.91it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.15it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:03:38.476831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 271.78it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.17it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.41it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.56it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.45it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 11.09it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.43it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.49it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.26it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.86it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.62it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.85it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.02it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.14it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.22it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:04, 16.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.31it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.34it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.37it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.38it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 15.90it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.06it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.17it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.28it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.32it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.35it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.40it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.41it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.40it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.42it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.41it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.42it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.43it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.44it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.43it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.43it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.43it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.44it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.43it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.45it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.45it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.47it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.48it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.48it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.49it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.49it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.11it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 343.32it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.76it/s]  2%|â–         | 2/100 [00:00<00:14,  6.62it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  6.95it/s]  4%|â–         | 4/100 [00:00<00:13,  7.12it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.11it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.04it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.15it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.00it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.04it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.15it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.23it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.28it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.32it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:12,  7.12it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.21it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.27it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.30it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.34it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.36it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.35it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.37it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.37it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.39it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.39it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.40it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.40it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.39it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.40it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.40it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.41it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.41it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.40it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.41it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.41it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.32it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.34it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.36it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.38it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.39it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.39it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.39it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.40it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.41it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.41it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.41it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.40it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.42it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.42it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.41it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.41it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.40it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.41it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.41it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.27it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.31it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  7.08it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.10it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.19it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.30it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.36it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.37it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.39it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.41it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.41it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.42it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.42it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.42it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.43it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.42it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.43it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.43it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.42it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.43it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.42it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.42it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.42it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.42it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.42it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.42it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.42it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.43it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.42it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.43it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.42it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.43it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.43it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.42it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.43it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.43it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.43it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.43it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.41it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.42it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.41it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.34it/s]
FOLD 0
Metric    CE Loss  KL wrt Orig
Model                         
llama_7B   2.4896     0.385236
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.91it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.87it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.72it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.69it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.61it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.47it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.41it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.26it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.10it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.99it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.91it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.55it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.58it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.56it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.58it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.55it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.56it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.43it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.49it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.57it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.51it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.70it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 234.61it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.40it/s]  4%|â–         | 4/100 [00:00<00:05, 16.16it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.42it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.56it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.62it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.61it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.63it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:05, 16.67it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.70it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.70it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.73it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.73it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.74it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.75it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.75it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.72it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.68it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.59it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.65it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.69it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.71it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.72it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.74it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:02, 16.75it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.76it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.75it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.71it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.73it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.74it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.74it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.75it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.74it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.75it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.64it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.69it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.70it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.73it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.74it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.75it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.76it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.76it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.77it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.78it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.78it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.78it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.77it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.70it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 278.97it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.52it/s]  2%|â–         | 2/100 [00:00<00:16,  6.07it/s]  3%|â–Ž         | 3/100 [00:00<00:15,  6.40it/s]  4%|â–         | 4/100 [00:00<00:14,  6.52it/s]  5%|â–Œ         | 5/100 [00:00<00:14,  6.75it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.82it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.01it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.15it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.25it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.31it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.35it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.36it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.39it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.25it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.10it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.19it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.27it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  6.98it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.12it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.22it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.29it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.33it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.37it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.34it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.30it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.34it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.36it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.39it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.41it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.18it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.04it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.14it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.74it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.93it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.08it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  7.08it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.18it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.25it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.31it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  6.99it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.08it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.19it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.27it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.32it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.36it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.39it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.40it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.36it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.37it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.40it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.35it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.33it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.30it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.34it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.16it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.23it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.35it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.36it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.38it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  6.99it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.92it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.18it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.96it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.10it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.28it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.33it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.05it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.04it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.13it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.22it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.09it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.04it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.15it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.22it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.12it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.11it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.27it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.33it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.14it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.15it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.25it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.31it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.38it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.41it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.42it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.44it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.44it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.43it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.20it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.839551      0.66753
[2.6645752  0.52638304]
2023-12-03 15:04:40.839279: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:04:40.888681: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:04:41.635452: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 372.83it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.22it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.11it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.96it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.55it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.22it/s]  9%|â–‰         | 3/32 [00:00<00:03,  8.88it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.78it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.66it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:03,  8.56it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.45it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.35it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.18it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.05it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  7.98it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  7.94it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  7.95it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  7.92it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:02,  7.89it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  7.86it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  7.85it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.78it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.74it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.77it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.81it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.80it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.66it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.70it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.65it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  7.85it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.81it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  7.84it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  7.82it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.50it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:04<00:00,  7.95it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:05:01.576467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 271.41it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.16it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.39it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.50it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.39it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 11.00it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.30it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.31it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.08it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.65it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.06it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.37it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.59it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.75it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.85it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.92it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.97it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 16.01it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.05it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.08it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.07it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.09it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.08it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 16.10it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.11it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.12it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.12it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.13it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.12it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.13it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.15it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 16.15it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.15it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.15it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.16it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.15it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.14it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.10it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.11it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 16.13it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.14it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.14it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.15it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.14it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.14it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.14it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.92it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 348.83it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.43it/s]  2%|â–         | 2/100 [00:00<00:15,  6.19it/s]  3%|â–Ž         | 3/100 [00:00<00:15,  6.38it/s]  4%|â–         | 4/100 [00:00<00:14,  6.66it/s]  5%|â–Œ         | 5/100 [00:00<00:14,  6.74it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.72it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.75it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.92it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.98it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.07it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.88it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.00it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.10it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:11,  7.17it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.22it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.26it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.27it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.14it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.05it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.06it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  7.06it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.14it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.06it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  6.98it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  6.89it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.00it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.97it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  6.94it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  7.05it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.06it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.06it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.12it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.92it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  6.86it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:05<00:09,  6.75it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:09,  6.84it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:09,  6.92it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.03it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.12it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.18it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.99it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  7.00it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.03it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.05it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.12it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.85it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.98it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.89it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  6.79it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  6.58it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.77it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  6.93it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.84it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  6.73it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  6.70it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  6.64it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.75it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.84it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  6.97it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.70it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  6.66it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.60it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:09<00:05,  6.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  6.66it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:05,  6.85it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  6.99it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.08it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.87it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  6.86it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:10<00:04,  7.00it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.03it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:04,  6.78it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.80it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.69it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.74it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:11<00:03,  6.89it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:11<00:03,  7.01it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.85it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:03,  6.67it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  6.79it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.94it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:12<00:02,  7.14it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:12<00:02,  6.78it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  6.69it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:02,  6.81it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  6.95it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.06it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.14it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:13<00:01,  7.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:13<00:01,  6.88it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.00it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.08it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.15it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.25it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:14<00:00,  7.07it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:14<00:00,  7.07it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.81it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.92it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.537344     0.442989
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.59it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.54it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.40it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.38it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.28it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.16it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.11it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.98it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.83it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.73it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.66it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.55it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.50it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.42it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.43it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.39it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.36it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.32it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.33it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.24it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.11it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.25it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.38it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.35it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.81it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.47it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 265.55it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.93it/s]  4%|â–         | 4/100 [00:00<00:06, 15.64it/s]  6%|â–Œ         | 6/100 [00:00<00:06, 15.57it/s]  8%|â–Š         | 8/100 [00:00<00:05, 15.81it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 15.95it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.00it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.06it/s] 16%|â–ˆâ–Œ        | 16/100 [00:01<00:05, 16.09it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.11it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.14it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.15it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.16it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.16it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.17it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.17it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.17it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.11it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.12it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.13it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.15it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.16it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.08it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 15.83it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 15.93it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.01it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.06it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.10it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.12it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.13it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.15it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.16it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.17it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 16.16it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.17it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.18it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.18it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.18it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.19it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.19it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.19it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.19it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.18it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.18it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.11it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 322.66it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.84it/s]  2%|â–         | 2/100 [00:00<00:15,  6.42it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.81it/s]  4%|â–         | 4/100 [00:00<00:14,  6.85it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  6.93it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.08it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.17it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.23it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.28it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.31it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.32it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.26it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.29it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.32it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.25it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.28it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.31it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.33it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.02it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.03it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:11,  7.12it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.20it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.25it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.28it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.31it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.32it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.32it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.34it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.34it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.35it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.35it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.03it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.05it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.14it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.21it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.28it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.31it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.32it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.33it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.27it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  7.08it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.08it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.08it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  6.92it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.78it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.94it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  6.92it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.06it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.00it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.85it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  6.99it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.11it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.19it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.24it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.19it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.27it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.00it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  6.93it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:05,  7.01it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  6.81it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.90it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.04it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  6.83it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  6.98it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.10it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.08it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.15it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.19it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.19it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.33it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.35it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.00it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  6.92it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.04it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.14it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:02,  6.92it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.05it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.14it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.21it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.10it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.12it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.19it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.23it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.20it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.19it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.14it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.051289     0.872708
[2.79431641 0.65784869]
2023-12-03 15:06:05.944651: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:06:05.993726: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:06:06.741024: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 371.84it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.24it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.02it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.83it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.49it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.11it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.04it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.91it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.82it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.71it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.63it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.49it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.42it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.41it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.36it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.30it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.30it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.29it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.20it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.23it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.15it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.95it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.04it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.11it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.12it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  8.00it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.01it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.01it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.86it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.29it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(11, 22), (12, 30), (15, 15), (16, 13), (18, 27), (19, 0), (19, 31), (23, 17), (23, 29), (26, 9), (27, 22), (29, 0)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:06:25.868513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 271.02it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:41,  1.03s/it]  3%|â–Ž         | 3/100 [00:01<00:29,  3.27it/s]  5%|â–Œ         | 5/100 [00:01<00:16,  5.69it/s]  7%|â–‹         | 7/100 [00:01<00:11,  8.07it/s]  9%|â–‰         | 9/100 [00:01<00:08, 10.28it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 12.22it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 13.83it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:05, 15.11it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 16.11it/s] 19%|â–ˆâ–‰        | 19/100 [00:01<00:04, 16.86it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 17.41it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 17.80it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 18.09it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 18.23it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:03, 18.39it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:03, 18.51it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 18.60it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:02<00:03, 18.66it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:02<00:03, 18.70it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 18.72it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 18.74it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 18.76it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:02, 18.77it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:02, 18.78it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 18.78it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 18.79it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:03<00:02, 18.80it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:03<00:02, 18.80it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 18.80it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 18.80it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 18.80it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:01, 18.80it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:01, 18.77it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 18.77it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 18.78it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:04<00:01, 18.78it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:04<00:01, 18.78it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:04<00:01, 18.79it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 18.78it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 18.78it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 18.79it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 18.79it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 18.79it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:05<00:00, 18.80it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:05<00:00, 18.80it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:05<00:00, 18.81it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:05<00:00, 18.77it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 18.78it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 18.78it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 18.78it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 15.88it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 352.55it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.70it/s]  2%|â–         | 2/100 [00:00<00:15,  6.33it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.56it/s]  4%|â–         | 4/100 [00:00<00:14,  6.61it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.00it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.12it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.26it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.27it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.44it/s] 10%|â–ˆ         | 10/100 [00:01<00:11,  7.57it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.66it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.57it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.67it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.57it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.66it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:10,  7.65it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:10,  7.71it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.43it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.34it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.48it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.30it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.23it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.42it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.55it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.45it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.56it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.65it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.71it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.75it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:08,  7.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:08,  7.81it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.44it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.26it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.35it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.50it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.46it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.50it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.61it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.74it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.42it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.53it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.48it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:06,  7.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.57it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.64it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.66it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:05,  7.57it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.64it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.49it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.51it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:04,  7.70it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.76it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.78it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.49it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.59it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.67it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.74it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.62it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.51it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.44it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.55it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.49it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.53it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:09<00:03,  7.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.38it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.37it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.50it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.61it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.67it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.57it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.64it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.48it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.58it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.29it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.45it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.43it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:11<00:01,  7.65it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.73it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.78it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.70it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.52it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.25it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.43it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.56it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.51it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.303437      0.19493
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.91it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.86it/s]  9%|â–‰         | 3/32 [00:00<00:02,  9.70it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.67it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.61it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.45it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.40it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.26it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.11it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  9.00it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.92it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.86it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.80it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.75it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.73it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.72it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:01<00:01,  8.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.60it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.57it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.61it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.59it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.46it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.57it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.50it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.55it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.48it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.74it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (19, 17), (20, 9), (23, 3), (23, 23), (26, 16), (28, 21), (29, 28), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 281.91it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.09it/s]  4%|â–         | 4/100 [00:00<00:05, 17.52it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 18.05it/s]  8%|â–Š         | 8/100 [00:00<00:05, 18.32it/s] 10%|â–ˆ         | 10/100 [00:00<00:04, 18.48it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:04, 18.56it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 18.57it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 18.57it/s] 18%|â–ˆâ–Š        | 18/100 [00:00<00:04, 18.62it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 18.65it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 18.67it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 18.68it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:03, 18.71it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:03, 18.72it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 18.72it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 18.73it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 18.75it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:01<00:03, 18.68it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 18.69it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 18.69it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 18.70it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:02, 18.72it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:02, 18.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 18.73it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 18.73it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 18.74it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:02<00:02, 18.74it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 18.70it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 18.71it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 18.72it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 18.73it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:01, 18.74it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 18.74it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 18.73it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 18.74it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:03<00:01, 18.74it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:03<00:01, 18.74it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 18.74it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 18.66it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 18.58it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:00, 18.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 18.56it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 18.61it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 18.64it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:04<00:00, 18.67it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:04<00:00, 18.68it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 18.69it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 18.70it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 18.71it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.70it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 18.64it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 273.30it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  7.00it/s]  2%|â–         | 2/100 [00:00<00:13,  7.15it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.43it/s]  4%|â–         | 4/100 [00:00<00:13,  7.12it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.36it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  7.18it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.31it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.42it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.22it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.32it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.46it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.26it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.34it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.49it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.59it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:10,  7.66it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.33it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:10,  7.46it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.57it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.27it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.35it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:02<00:10,  7.48it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.50it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.35it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.47it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:09,  7.59it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.37it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.49it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.30it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.44it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:08,  7.46it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.56it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.65it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.71it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:04<00:08,  7.44it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.47it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.56it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:07,  7.62it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:07,  7.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.40it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:05<00:07,  7.44it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:06,  7.70it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.35it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.48it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.58it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:06<00:06,  7.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:06<00:06,  7.65it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:05,  7.68it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.37it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.49it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.57it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.34it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:07<00:05,  7.48it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.52it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.60it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:04,  7.66it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:04,  7.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.68it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.44it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:08<00:04,  7.51it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:08<00:04,  7.61it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.67it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.72it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:03,  7.76it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.76it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.79it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.34it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:09<00:03,  7.47it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.33it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.43it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.48it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.58it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.66it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.70it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:10<00:02,  7.73it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:10<00:02,  7.77it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.40it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.52it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.31it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.45it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:11<00:01,  7.31it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:11<00:01,  7.39it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.08it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.15it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.27it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.43it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.47it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.56it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:12<00:00,  7.64it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:12<00:00,  7.24it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.38it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.47it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.648916     0.459251
[2.47617676 0.32709036]
2023-12-03 15:07:25.702651: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:07:25.751885: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:07:26.502626: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 379.16it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.29it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.91it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.47it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.10it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  8.99it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.86it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.75it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.62it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.52it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.37it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.24it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.18it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.14it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.15it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.08it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.04it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.06it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.96it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.92it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.96it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.99it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.98it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.83it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.88it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.82it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.82it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.99it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.03it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.69it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.14it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(8, 19), (10, 2), (10, 5), (11, 22), (12, 30), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 12), (21, 14), (23, 17), (23, 22), (23, 29), (26, 9), (27, 22), (29, 0), (30, 14), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:07:45.883479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 346.72it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:42,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.21it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.53it/s]  7%|â–‹         | 7/100 [00:01<00:11,  7.77it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.81it/s] 11%|â–ˆ         | 11/100 [00:01<00:07, 11.50it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.96it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 14.10it/s] 17%|â–ˆâ–‹        | 17/100 [00:01<00:05, 14.99it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 15.65it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:04, 16.13it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 16.48it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 16.61it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 16.82it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.98it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 17.09it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:02<00:03, 17.16it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 17.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 17.27it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 17.19it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 17.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 17.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 17.30it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 17.32it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:02, 17.33it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:03<00:02, 17.33it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 17.34it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 17.26it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 17.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 17.31it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 17.32it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 17.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 17.34it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:04<00:01, 17.36it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:04<00:01, 17.24it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 17.21it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 17.25it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 17.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 17.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 17.33it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 17.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:05<00:00, 17.35it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:05<00:00, 17.31it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 17.33it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 17.33it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 17.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 17.34it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 17.35it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 17.36it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:06<00:00, 17.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 14.80it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 286.81it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.45it/s]  2%|â–         | 2/100 [00:00<00:15,  6.32it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.83it/s]  4%|â–         | 4/100 [00:00<00:13,  7.06it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.24it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.35it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.32it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.97it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.15it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.26it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.31it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:11,  7.39it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.39it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.44it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.21it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.31it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.39it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.32it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.32it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.39it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.37it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.43it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.25it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.26it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.36it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.20it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.05it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.19it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.16it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.02it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.04it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.08it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.15it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.09it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.03it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.11it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.24it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.34it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.06it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.21it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:08,  6.90it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.09it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.32it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.39it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.29it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.00it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.10it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.23it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.25it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.35it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.42it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.07it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  7.07it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.21it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.32it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.17it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.15it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.32it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.09it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.22it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.26it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.34it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.43it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.42it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.16it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.18it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.94it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.87it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.07it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  6.94it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  6.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  6.99it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:02,  7.15it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  6.94it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.04it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.17it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.15it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.05it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.01it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.10it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.10it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.03it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.11it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.08it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.99it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.13it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.19it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  6.96it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.16it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.884775     0.743849
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.46it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.48it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.35it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.34it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.28it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.15it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.08it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.94it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.80it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.70it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.56it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.51it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.47it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.45it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.43it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.36it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.32it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.29it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.30it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.38it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.34it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.32it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.24it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.37it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.79it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.47it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(13, 8), (13, 16), (14, 14), (16, 30), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 14), (30, 25), (30, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 331.28it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 16.12it/s]  4%|â–         | 4/100 [00:00<00:05, 16.97it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 17.28it/s]  8%|â–Š         | 8/100 [00:00<00:05, 17.42it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 17.51it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 17.56it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:04, 17.59it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 17.61it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 17.62it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 17.63it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 17.64it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 17.65it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 17.65it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 17.64it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:03, 17.64it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:03, 17.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:01<00:03, 17.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 17.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 17.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 17.65it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 17.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 17.66it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 17.66it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:02, 17.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 17.65it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:02<00:02, 17.66it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 17.66it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 17.66it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 17.67it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 17.66it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 17.65it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 17.65it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:01, 17.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:03<00:01, 17.64it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:03<00:01, 17.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 17.64it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 17.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 17.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 17.65it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 17.65it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 17.65it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 17.66it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:04<00:00, 17.65it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:04<00:00, 17.65it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 17.66it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 17.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 17.67it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 17.66it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 17.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.67it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 17.62it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 346.78it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.35it/s]  2%|â–         | 2/100 [00:00<00:13,  7.04it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.19it/s]  4%|â–         | 4/100 [00:00<00:13,  7.35it/s]  5%|â–Œ         | 5/100 [00:00<00:12,  7.44it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.49it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.54it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.48it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.51it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.45it/s] 11%|â–ˆ         | 11/100 [00:01<00:11,  7.49it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.23it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.18it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.29it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.29it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.12it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.26it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.27it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.37it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.03it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.19it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.99it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.98it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.15it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.29it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.35it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.20it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.21it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:03<00:09,  7.32it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.06it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.22it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  6.99it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.17it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.01it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.15it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.28it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.38it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.27it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.36it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.17it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.29it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.05it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.21it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.01it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.03it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.19it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.17it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.20it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.25it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.15it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.07it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.32it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.13it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.26it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.08it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  7.03it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.19it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.32it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.17it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.29it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.39it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.41it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.17it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.14it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.27it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.36it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.16it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.23it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.06it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.11it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.31it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.40it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.47it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.51it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.54it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.55it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.58it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.60it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.61it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.62it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:01,  7.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.22it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.36it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.43it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.11it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.19it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.41it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.48it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.42it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.46it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.21it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.26it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.44it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.28it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  2.951699      0.76541
[2.9182373  0.75462931]
2023-12-03 15:08:48.337087: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:08:48.387045: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:08:49.136515: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 356.99it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.21it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.21it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.75it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.43it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.35it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.12it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.95it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.78it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.67it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.48it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.22it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.17it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.14it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.13it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.17it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.13it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.10it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.11it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.03it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.99it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.03it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.07it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.06it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.92it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.96it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.92it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.76it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.01it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.00it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.06it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.06it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.73it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.20it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 22), (10, 2), (10, 5), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (16, 13), (16, 17), (17, 13), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 26), (21, 14), (23, 17), (23, 22), (23, 29), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:09:09.020799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 268.08it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:44,  1.05s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.14it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.38it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.53it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.46it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 11.12it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:06, 12.47it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.53it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.34it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.94it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.38it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:04, 15.49it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.77it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.97it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 16.10it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 16.21it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 16.29it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:03, 16.34it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:03, 16.38it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 16.40it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 16.42it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 16.44it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 16.44it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 16.45it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:03<00:03, 16.46it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:02, 16.45it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.46it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.47it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 16.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 16.35it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 16.40it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.41it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:04<00:02, 16.44it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.45it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.45it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.46it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.44it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.47it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.47it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:05<00:01, 16.47it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.47it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.48it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.50it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.49it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.38it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.40it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:06<00:00, 16.43it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.46it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 14.13it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 345.98it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.49it/s]  2%|â–         | 2/100 [00:00<00:16,  6.06it/s]  3%|â–Ž         | 3/100 [00:00<00:14,  6.61it/s]  4%|â–         | 4/100 [00:00<00:13,  6.92it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.09it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.97it/s]  7%|â–‹         | 7/100 [00:01<00:13,  7.12it/s]  8%|â–Š         | 8/100 [00:01<00:12,  7.22it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.07it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.17it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  6.91it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.05it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.16it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:11,  7.23it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  7.06it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.96it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:12,  6.85it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.00it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.13it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.88it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  6.97it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.84it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.95it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:11,  6.90it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:11,  6.79it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  6.97it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  7.04it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  7.14it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.24it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.03it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.14it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.22it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.03it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.14it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:09,  7.16it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.17it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  6.92it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.00it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.11it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  6.98it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:08,  7.03it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.14it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.15it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.22it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.05it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.96it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  6.69it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  6.89it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.04it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.12it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  6.93it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.01it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.12it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:06,  7.20it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:06,  6.92it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:06,  6.92it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:06,  6.81it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  6.98it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.11it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.21it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.13it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:04,  7.21it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.28it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.18it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.25it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.33it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.03it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.08it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.77it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  6.94it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.03it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  6.93it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.07it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  7.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:03,  6.98it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.15it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.20it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.17it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  7.17it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.09it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.11it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  6.98it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  6.91it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  6.81it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  6.81it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  6.79it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:01,  6.73it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  6.92it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  6.76it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  6.87it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.04it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.01it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.03it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.090918     0.969533
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.77it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.63it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.55it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.55it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.48it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.37it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.31it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.16it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  9.02it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.91it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.79it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.68it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:01,  8.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.55it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.54it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.52it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.49it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.51it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.51it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.51it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.39it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.50it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:02<00:00,  8.43it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.46it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.50it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.50it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.50it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.97it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.65it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 16), (14, 14), (15, 1), (16, 30), (17, 7), (17, 29), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 23), (24, 20), (24, 21), (26, 9), (26, 13), (26, 16), (28, 1), (28, 10), (28, 21), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 272.52it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 15.38it/s]  4%|â–         | 4/100 [00:00<00:05, 16.23it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 16.51it/s]  8%|â–Š         | 8/100 [00:00<00:05, 16.64it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.71it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.77it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.80it/s] 16%|â–ˆâ–Œ        | 16/100 [00:00<00:04, 16.82it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:04, 16.84it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.86it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.85it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.85it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.85it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.86it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.85it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.79it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:03, 16.80it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.85it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.86it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.86it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.86it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.88it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.87it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:02<00:02, 16.84it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.85it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.86it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.87it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.87it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.88it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.89it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 16.90it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:03<00:02, 16.90it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.91it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.90it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.90it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.90it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.89it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.89it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:04<00:01, 16.89it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:04<00:00, 16.89it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.88it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.90it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.89it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.90it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.90it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.90it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:05<00:00, 16.91it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.92it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:05<00:00, 16.84it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 312.49it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.63it/s]  2%|â–         | 2/100 [00:00<00:14,  6.96it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.10it/s]  4%|â–         | 4/100 [00:00<00:13,  7.06it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.04it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.86it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.93it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.02it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.15it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.26it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.34it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.14it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  7.24it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.31it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.38it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.33it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.38it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.40it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:10,  7.42it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:10,  7.44it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.40it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.42it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.46it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.30it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.21it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.29it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.94it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:10,  7.08it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  7.07it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.13it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.19it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.27it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.39it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.34it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.39it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.42it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.17it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.26it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.33it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.07it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:08,  7.04it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.17it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.27it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.34it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.32it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.36it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.09it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:07,  7.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:07,  7.11it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:07,  6.91it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.00it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.14it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.22it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.35it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:06,  7.14it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.20it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.28it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.26it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.33it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.11it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.17it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.20it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.26it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.33it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.29it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.35it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.39it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.14it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:04,  7.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.22it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  7.04it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.16it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.17it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.19it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.27it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:03,  7.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.14it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  7.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.32it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.41it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  6.93it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  6.97it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:02,  6.91it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.07it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.07it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.18it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.27it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.09it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.12it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.23it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  6.95it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.10it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.21it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.21it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.728672      1.55369
[3.40979492 1.26161149]
2023-12-03 15:10:14.235010: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-03 15:10:14.284756: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-03 15:10:15.032157: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 348.80it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.20it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.21it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.03it/s]
head_wise_activation_length:(11012, 32, 4096)
labels_shape:(11012,)
seperated_head_activation shape:11013
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.88it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.47it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.09it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:03,  9.00it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:03,  8.76it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  8.69it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  8.51it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  8.43it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:01<00:02,  8.31it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.21it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.14it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.10it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.08it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.04it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:02<00:01,  8.01it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.02it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  7.95it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  7.91it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  7.95it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  7.98it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  7.91it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:01,  7.71it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:03<00:00,  7.79it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  7.77it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  7.78it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.00it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  7.96it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.00it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.00it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.61it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.09it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:284: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
[[0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.65625 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 ...
 [0.78125 0.65625 0.65625 ... 0.65625 0.65625 0.65625]
 [0.6875  0.65625 0.65625 ... 0.65625 0.5     0.65625]
 [0.65625 0.65625 0.6875  ... 0.65625 0.75    0.625  ]]
Heads intervened:  [(7, 14), (8, 19), (9, 5), (9, 9), (9, 22), (10, 2), (10, 5), (10, 15), (11, 22), (12, 30), (13, 19), (15, 10), (15, 15), (15, 16), (16, 13), (16, 17), (17, 13), (17, 26), (17, 29), (18, 27), (19, 0), (19, 6), (19, 31), (20, 8), (20, 12), (20, 23), (20, 26), (21, 14), (21, 23), (23, 10), (23, 17), (23, 22), (23, 29), (24, 15), (24, 23), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (27, 22), (29, 0), (30, 14), (30, 26), (31, 26), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
2023-12-03 15:10:34.714237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24961 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:65:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 298.59it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-efad36df3bb08bb6.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-104d73699b17e5d3.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<01:43,  1.04s/it]  3%|â–Ž         | 3/100 [00:01<00:30,  3.16it/s]  5%|â–Œ         | 5/100 [00:01<00:17,  5.36it/s]  7%|â–‹         | 7/100 [00:01<00:12,  7.47it/s]  9%|â–‰         | 9/100 [00:01<00:09,  9.36it/s] 11%|â–ˆ         | 11/100 [00:01<00:08, 10.96it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:07, 12.26it/s] 15%|â–ˆâ–Œ        | 15/100 [00:01<00:06, 13.28it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:05, 14.05it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:05, 14.63it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:05, 15.05it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:02<00:05, 15.24it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:02<00:04, 15.44it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:02<00:04, 15.63it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:02<00:04, 15.76it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:02<00:04, 15.85it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:03<00:04, 15.90it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:03<00:04, 15.59it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:03<00:04, 15.73it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:03<00:03, 15.83it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:03<00:03, 15.80it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:03<00:03, 15.89it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:03<00:03, 15.95it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:03<00:03, 15.96it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:04<00:03, 16.00it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:04<00:03, 16.03it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:04<00:02, 16.06it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:04<00:02, 16.07it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:04<00:02, 15.99it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:04<00:02, 15.96it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:04<00:02, 15.99it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:04<00:02, 16.03it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:05<00:02, 16.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:05<00:02, 16.07it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:05<00:01, 16.07it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:05<00:01, 16.06it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:05<00:01, 16.07it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:05<00:01, 16.07it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:05<00:01, 16.08it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:05<00:01, 16.07it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:06<00:01, 16.07it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:06<00:01, 16.08it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:06<00:00, 16.08it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:06<00:00, 16.08it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:06<00:00, 16.09it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:06<00:00, 16.03it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:06<00:00, 16.04it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:06<00:00, 16.06it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:07<00:00, 16.07it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:07<00:00, 16.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.84it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 357.14it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c757fab51667f156.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7d7efafe4bfebc00.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.41it/s]  2%|â–         | 2/100 [00:00<00:15,  6.19it/s]  3%|â–Ž         | 3/100 [00:00<00:15,  6.39it/s]  4%|â–         | 4/100 [00:00<00:14,  6.66it/s]  5%|â–Œ         | 5/100 [00:00<00:14,  6.67it/s]  6%|â–Œ         | 6/100 [00:00<00:13,  6.87it/s]  7%|â–‹         | 7/100 [00:01<00:13,  6.74it/s]  8%|â–Š         | 8/100 [00:01<00:13,  6.78it/s]  9%|â–‰         | 9/100 [00:01<00:13,  6.70it/s] 10%|â–ˆ         | 10/100 [00:01<00:13,  6.88it/s] 11%|â–ˆ         | 11/100 [00:01<00:13,  6.82it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  6.81it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:12,  6.96it/s] 14%|â–ˆâ–        | 14/100 [00:02<00:12,  6.66it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:12,  6.86it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:12,  6.60it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:12,  6.57it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:12,  6.78it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  6.94it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  6.98it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:03<00:11,  6.79it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:11,  6.94it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:11,  6.74it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:11,  6.90it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  6.96it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  6.82it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:10,  6.96it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:04<00:10,  6.95it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:10,  6.81it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:10,  6.95it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.06it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.00it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  6.95it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:09,  7.02it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:05<00:09,  7.05it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:05<00:08,  7.13it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.19it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.26it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.03it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  6.97it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:06<00:08,  7.07it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:06<00:07,  7.14it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:08,  6.94it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  6.99it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.09it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  6.92it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  6.84it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:07<00:07,  6.95it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:07<00:07,  7.06it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.11it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.18it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.20it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.24it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:08<00:06,  7.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:08<00:05,  7.30it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:08<00:05,  7.31it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.32it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.32it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.11it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  6.98it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:09<00:05,  6.83it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:09<00:05,  6.98it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:09<00:04,  7.08it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  6.84it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  6.98it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.08it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:10<00:04,  7.07it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:10<00:04,  7.15it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:10<00:03,  7.01it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:10<00:03,  6.96it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.07it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  6.96it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  6.83it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:11<00:03,  6.91it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:11<00:03,  6.79it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:11<00:03,  6.95it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:11<00:02,  6.76it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  6.93it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.07it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:12<00:02,  6.85it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:12<00:02,  6.90it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:12<00:01,  7.03it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:12<00:01,  7.12it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  6.92it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  6.98it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  6.94it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:13<00:01,  7.05it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:13<00:01,  7.13it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:13<00:00,  7.13it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:13<00:00,  7.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:13<00:00,  7.13it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.00it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.04it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:14<00:00,  7.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:14<00:00,  7.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  7.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:14<00:00,  6.97it/s]
FOLD 0
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  3.253154     1.148703
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|â–Ž         | 1/32 [00:00<00:03,  9.55it/s]  6%|â–‹         | 2/32 [00:00<00:03,  9.55it/s]  9%|â–‰         | 3/32 [00:00<00:03,  9.41it/s] 12%|â–ˆâ–Ž        | 4/32 [00:00<00:02,  9.39it/s] 16%|â–ˆâ–Œ        | 5/32 [00:00<00:02,  9.33it/s] 19%|â–ˆâ–‰        | 6/32 [00:00<00:02,  9.20it/s] 22%|â–ˆâ–ˆâ–       | 7/32 [00:00<00:02,  9.13it/s] 25%|â–ˆâ–ˆâ–Œ       | 8/32 [00:00<00:02,  9.00it/s] 28%|â–ˆâ–ˆâ–Š       | 9/32 [00:00<00:02,  8.86it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 10/32 [00:01<00:02,  8.75it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 11/32 [00:01<00:02,  8.68it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 12/32 [00:01<00:02,  8.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 13/32 [00:01<00:02,  8.55it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 14/32 [00:01<00:02,  8.34it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 15/32 [00:01<00:02,  8.37it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 16/32 [00:01<00:01,  8.39it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 17/32 [00:01<00:01,  8.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 18/32 [00:02<00:01,  8.35it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 19/32 [00:02<00:01,  8.33it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 20/32 [00:02<00:01,  8.30it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 21/32 [00:02<00:01,  8.33it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 22/32 [00:02<00:01,  8.41it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 23/32 [00:02<00:01,  8.37it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 24/32 [00:02<00:00,  8.24it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 25/32 [00:02<00:00,  8.34it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 26/32 [00:03<00:00,  8.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 27/32 [00:03<00:00,  8.30it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 28/32 [00:03<00:00,  8.42it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 29/32 [00:03<00:00,  8.41it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 30/32 [00:03<00:00,  8.38it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 31/32 [00:03<00:00,  8.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  7.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:03<00:00,  8.45it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 ...
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.78125 0.78125]
 [0.78125 0.78125 0.78125 ... 0.78125 0.8125  0.78125]]
Heads intervened:  [(8, 12), (13, 8), (13, 11), (13, 16), (14, 14), (15, 1), (15, 15), (16, 30), (17, 7), (17, 29), (18, 7), (18, 9), (18, 15), (18, 29), (19, 17), (20, 9), (20, 30), (22, 13), (23, 3), (23, 6), (23, 9), (23, 20), (23, 23), (24, 20), (24, 21), (25, 10), (25, 14), (25, 25), (26, 9), (26, 13), (26, 16), (27, 3), (28, 1), (28, 10), (28, 21), (29, 11), (29, 28), (30, 4), (30, 8), (30, 14), (30, 25), (30, 26), (31, 24), (31, 26), (31, 28), (31, 30)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
llama_7B ['bleurt', 'bleu', 'rouge']
tqa_done
['bleurt', 'bleu', 'rouge']
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 347.56it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-50cdc38a403eac3d.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-ce1a7b275d5cde07.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|â–         | 2/100 [00:00<00:06, 14.68it/s]  4%|â–         | 4/100 [00:00<00:06, 15.58it/s]  6%|â–Œ         | 6/100 [00:00<00:05, 15.73it/s]  8%|â–Š         | 8/100 [00:00<00:05, 15.92it/s] 10%|â–ˆ         | 10/100 [00:00<00:05, 16.05it/s] 12%|â–ˆâ–        | 12/100 [00:00<00:05, 16.13it/s] 14%|â–ˆâ–        | 14/100 [00:00<00:05, 16.16it/s] 16%|â–ˆâ–Œ        | 16/100 [00:01<00:05, 16.19it/s] 18%|â–ˆâ–Š        | 18/100 [00:01<00:05, 16.21it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:01<00:04, 16.22it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:01<00:04, 16.23it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:01<00:04, 16.11it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:01<00:04, 16.14it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:01<00:04, 16.18it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:01<00:04, 16.01it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:01<00:04, 16.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:02<00:04, 16.13it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:02<00:03, 16.16it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:02<00:03, 16.19it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:02<00:03, 16.22it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:02<00:03, 16.11it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:02<00:03, 16.15it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:02<00:03, 16.18it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:02<00:03, 16.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:03<00:03, 16.23it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:03<00:02, 16.24it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:03<00:02, 16.24it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:03<00:02, 16.24it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:03<00:02, 16.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:03<00:02, 16.24it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:03<00:02, 16.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:03<00:02, 15.84it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:04<00:02, 15.96it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:04<00:01, 16.05it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:04<00:01, 16.11it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:04<00:01, 16.15it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:04<00:01, 16.17it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:04<00:01, 16.20it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:04<00:01, 16.14it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:04<00:01, 16.17it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:05<00:01, 16.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:05<00:00, 16.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:05<00:00, 16.22it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:05<00:00, 16.22it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:05<00:00, 16.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:05<00:00, 16.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:05<00:00, 16.23it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:05<00:00, 16.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:06<00:00, 16.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:06<00:00, 16.14it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 346.24it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-e668c0bf390ff3a1.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-7bb85bffd3e61157.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.78it/s]  2%|â–         | 2/100 [00:00<00:14,  6.76it/s]  3%|â–Ž         | 3/100 [00:00<00:13,  7.02it/s]  4%|â–         | 4/100 [00:00<00:13,  7.15it/s]  5%|â–Œ         | 5/100 [00:00<00:13,  7.21it/s]  6%|â–Œ         | 6/100 [00:00<00:12,  7.25it/s]  7%|â–‹         | 7/100 [00:00<00:12,  7.28it/s]  8%|â–Š         | 8/100 [00:01<00:13,  7.06it/s]  9%|â–‰         | 9/100 [00:01<00:12,  7.07it/s] 10%|â–ˆ         | 10/100 [00:01<00:12,  7.16it/s] 11%|â–ˆ         | 11/100 [00:01<00:12,  7.22it/s] 12%|â–ˆâ–        | 12/100 [00:01<00:12,  7.25it/s] 13%|â–ˆâ–Ž        | 13/100 [00:01<00:11,  7.29it/s] 14%|â–ˆâ–        | 14/100 [00:01<00:11,  7.31it/s] 15%|â–ˆâ–Œ        | 15/100 [00:02<00:11,  7.30it/s] 16%|â–ˆâ–Œ        | 16/100 [00:02<00:11,  7.23it/s] 17%|â–ˆâ–‹        | 17/100 [00:02<00:11,  7.27it/s] 18%|â–ˆâ–Š        | 18/100 [00:02<00:11,  7.11it/s] 19%|â–ˆâ–‰        | 19/100 [00:02<00:11,  7.11it/s] 20%|â–ˆâ–ˆ        | 20/100 [00:02<00:11,  7.18it/s] 21%|â–ˆâ–ˆ        | 21/100 [00:02<00:10,  7.23it/s] 22%|â–ˆâ–ˆâ–       | 22/100 [00:03<00:10,  7.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 23/100 [00:03<00:10,  7.30it/s] 24%|â–ˆâ–ˆâ–       | 24/100 [00:03<00:10,  7.31it/s] 25%|â–ˆâ–ˆâ–Œ       | 25/100 [00:03<00:10,  7.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 26/100 [00:03<00:10,  7.35it/s] 27%|â–ˆâ–ˆâ–‹       | 27/100 [00:03<00:09,  7.35it/s] 28%|â–ˆâ–ˆâ–Š       | 28/100 [00:03<00:09,  7.28it/s] 29%|â–ˆâ–ˆâ–‰       | 29/100 [00:04<00:09,  7.31it/s] 30%|â–ˆâ–ˆâ–ˆ       | 30/100 [00:04<00:09,  7.32it/s] 31%|â–ˆâ–ˆâ–ˆ       | 31/100 [00:04<00:09,  7.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [00:04<00:09,  7.31it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [00:04<00:09,  7.34it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [00:04<00:08,  7.35it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [00:04<00:08,  7.36it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [00:04<00:08,  7.36it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [00:05<00:08,  7.36it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [00:05<00:08,  7.37it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [00:05<00:08,  7.37it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [00:05<00:08,  7.37it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [00:05<00:08,  7.37it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [00:05<00:07,  7.37it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [00:05<00:07,  7.33it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [00:06<00:07,  7.35it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [00:06<00:07,  7.35it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [00:06<00:07,  7.36it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [00:06<00:07,  7.36it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [00:06<00:07,  7.37it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [00:06<00:06,  7.37it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [00:06<00:06,  7.37it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [00:07<00:06,  7.37it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [00:07<00:06,  7.37it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [00:07<00:06,  7.37it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [00:07<00:06,  7.37it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [00:07<00:06,  7.37it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [00:07<00:05,  7.36it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [00:07<00:05,  7.37it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [00:07<00:05,  7.33it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [00:08<00:05,  7.34it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [00:08<00:05,  7.35it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [00:08<00:05,  7.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [00:08<00:05,  7.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [00:08<00:05,  7.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [00:08<00:04,  7.38it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [00:08<00:04,  7.38it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [00:09<00:04,  7.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [00:09<00:04,  7.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [00:09<00:04,  7.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [00:09<00:04,  7.38it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [00:09<00:04,  7.38it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [00:09<00:03,  7.38it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [00:09<00:03,  7.39it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [00:09<00:03,  7.31it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [00:10<00:03,  7.33it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [00:10<00:03,  7.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [00:10<00:03,  7.36it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [00:10<00:03,  7.36it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [00:10<00:02,  7.37it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [00:10<00:02,  7.38it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [00:10<00:02,  7.38it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [00:11<00:02,  7.38it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [00:11<00:02,  7.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [00:11<00:02,  7.38it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [00:11<00:02,  7.39it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [00:11<00:02,  7.39it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [00:11<00:01,  7.39it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [00:11<00:01,  7.38it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [00:12<00:01,  7.35it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [00:12<00:01,  7.35it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [00:12<00:01,  7.36it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [00:12<00:01,  7.37it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [00:12<00:01,  7.17it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [00:12<00:00,  7.23it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [00:12<00:00,  7.28it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [00:12<00:00,  7.31it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [00:13<00:00,  7.33it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [00:13<00:00,  7.35it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [00:13<00:00,  7.36it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [00:13<00:00,  7.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.38it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:13<00:00,  7.32it/s]
FOLD 1
Metric     CE Loss  KL wrt Orig
Model                          
llama_7B  4.292754     2.116151
[3.7729541  1.63242657]
