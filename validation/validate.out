nohup: ignoring input
2023-11-01 13:02:39.144343: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 13:02:39.737157: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 13:02:40.956251: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 53.04it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.09it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 393.65it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:16,  1.84it/s]  6%|▋         | 2/32 [00:01<00:14,  2.03it/s]  9%|▉         | 3/32 [00:01<00:14,  2.01it/s] 12%|█▎        | 4/32 [00:02<00:13,  2.01it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.95it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.90it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.85it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.85it/s] 28%|██▊       | 9/32 [00:04<00:12,  1.78it/s] 31%|███▏      | 10/32 [00:05<00:12,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.63it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.60it/s] 41%|████      | 13/32 [00:07<00:11,  1.60it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.59it/s] 47%|████▋     | 15/32 [00:08<00:10,  1.55it/s] 50%|█████     | 16/32 [00:09<00:10,  1.55it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.54it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.51it/s] 59%|█████▉    | 19/32 [00:11<00:08,  1.45it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.45it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.47it/s] 69%|██████▉   | 22/32 [00:13<00:06,  1.44it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.47it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.45it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.47it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.48it/s] 84%|████████▍ | 27/32 [00:16<00:03,  1.48it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.50it/s] 91%|█████████ | 29/32 [00:18<00:01,  1.51it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.53it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.56it/s]100%|██████████| 32/32 [00:20<00:00,  1.42it/s]100%|██████████| 32/32 [00:20<00:00,  1.58it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.55609756 0.56910569 0.55447154 ... 0.55447154 0.55447154 0.55447154]
 [0.55447154 0.55447154 0.55447154 ... 0.57886179 0.55447154 0.55447154]
 [0.55447154 0.57073171 0.68617886 ... 0.57886179 0.55447154 0.62113821]
 ...
 [0.68292683 0.56585366 0.56097561 ... 0.61463415 0.55772358 0.55284553]
 [0.71869919 0.57560976 0.59349593 ... 0.57235772 0.67479675 0.55447154]
 [0.62113821 0.62926829 0.69593496 ... 0.63902439 0.66504065 0.6699187 ]]
Heads intervened:  [(9, 11), (9, 20), (9, 29), (10, 1), (10, 11), (10, 15), (10, 17), (10, 22), (10, 28), (10, 29), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 21), (11, 29), (11, 31), (12, 3), (12, 14), (12, 21), (13, 11), (13, 16), (13, 22), (14, 5), (14, 12), (14, 14), (14, 18), (14, 22), (14, 30), (15, 20), (15, 24), (15, 28), (16, 1), (16, 10), (16, 13), (16, 26), (17, 31), (18, 0), (18, 9), (18, 10), (18, 17), (20, 19), (21, 22), (22, 4), (22, 13), (30, 22), (31, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/409 [00:00<?, ?it/s]  0%|          | 1/409 [00:02<18:02,  2.65s/it]  0%|          | 2/409 [00:03<11:15,  1.66s/it]  1%|          | 3/409 [00:04<08:16,  1.22s/it]  1%|          | 4/409 [00:05<07:12,  1.07s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  1%|          | 5/409 [00:06<07:13,  1.07s/it]  1%|▏         | 6/409 [00:07<07:14,  1.08s/it]  2%|▏         | 7/409 [00:07<06:10,  1.08it/s]  2%|▏         | 8/409 [00:09<07:32,  1.13s/it]  2%|▏         | 9/409 [00:11<08:54,  1.34s/it]  2%|▏         | 10/409 [00:12<07:59,  1.20s/it]  3%|▎         | 11/409 [00:13<07:15,  1.10s/it]  3%|▎         | 12/409 [00:13<06:15,  1.06it/s]  3%|▎         | 13/409 [00:14<05:32,  1.19it/s]  3%|▎         | 14/409 [00:14<05:02,  1.30it/s]  4%|▎         | 15/409 [00:15<05:24,  1.22it/s]  4%|▍         | 16/409 [00:16<05:26,  1.20it/s]  4%|▍         | 17/409 [00:17<06:10,  1.06it/s]  4%|▍         | 18/409 [00:19<06:53,  1.06s/it]  5%|▍         | 19/409 [00:19<06:13,  1.04it/s]  5%|▍         | 20/409 [00:20<06:25,  1.01it/s]  5%|▌         | 21/409 [00:21<05:53,  1.10it/s]  5%|▌         | 22/409 [00:23<06:39,  1.03s/it]  6%|▌         | 23/409 [00:24<06:53,  1.07s/it]  6%|▌         | 24/409 [00:25<06:38,  1.03s/it]  6%|▌         | 25/409 [00:26<07:01,  1.10s/it]  6%|▋         | 26/409 [00:27<07:11,  1.13s/it]  7%|▋         | 27/409 [00:28<06:39,  1.05s/it]  7%|▋         | 28/409 [00:29<07:36,  1.20s/it]  7%|▋         | 29/409 [00:31<07:32,  1.19s/it]  7%|▋         | 30/409 [00:31<06:37,  1.05s/it]  8%|▊         | 31/409 [00:32<06:26,  1.02s/it]  8%|▊         | 32/409 [00:33<06:16,  1.00it/s]  8%|▊         | 33/409 [00:34<06:36,  1.05s/it]  8%|▊         | 34/409 [00:35<05:43,  1.09it/s]  9%|▊         | 35/409 [00:36<05:59,  1.04it/s]  9%|▉         | 36/409 [00:37<05:57,  1.04it/s]  9%|▉         | 37/409 [00:38<05:14,  1.18it/s]  9%|▉         | 38/409 [00:38<05:02,  1.23it/s] 10%|▉         | 39/409 [00:39<05:06,  1.21it/s] 10%|▉         | 40/409 [00:40<04:53,  1.26it/s] 10%|█         | 41/409 [00:41<05:59,  1.02it/s] 10%|█         | 42/409 [00:42<05:43,  1.07it/s] 11%|█         | 43/409 [00:43<05:33,  1.10it/s] 11%|█         | 44/409 [00:44<05:50,  1.04it/s] 11%|█         | 45/409 [00:45<06:03,  1.00it/s] 11%|█         | 46/409 [00:46<06:11,  1.02s/it] 11%|█▏        | 47/409 [00:47<05:26,  1.11it/s] 12%|█▏        | 48/409 [00:48<05:32,  1.09it/s] 12%|█▏        | 49/409 [00:49<06:14,  1.04s/it] 12%|█▏        | 50/409 [00:50<05:51,  1.02it/s] 12%|█▏        | 51/409 [00:51<06:25,  1.08s/it] 13%|█▎        | 52/409 [00:52<06:25,  1.08s/it] 13%|█▎        | 53/409 [00:53<05:18,  1.12it/s] 13%|█▎        | 54/409 [00:54<05:23,  1.10it/s] 13%|█▎        | 55/409 [00:54<04:49,  1.22it/s] 14%|█▎        | 56/409 [00:55<04:39,  1.27it/s] 14%|█▍        | 57/409 [00:56<04:59,  1.17it/s] 14%|█▍        | 58/409 [00:58<05:59,  1.02s/it] 14%|█▍        | 59/409 [00:58<05:16,  1.10it/s] 15%|█▍        | 60/409 [00:59<05:36,  1.04it/s] 15%|█▍        | 61/409 [01:00<04:32,  1.28it/s] 15%|█▌        | 62/409 [01:00<04:11,  1.38it/s] 15%|█▌        | 63/409 [01:02<05:28,  1.05it/s] 16%|█▌        | 64/409 [01:02<04:13,  1.36it/s] 16%|█▌        | 65/409 [01:02<03:46,  1.52it/s] 16%|█▌        | 66/409 [01:04<05:07,  1.12it/s] 16%|█▋        | 67/409 [01:05<06:01,  1.06s/it] 17%|█▋        | 68/409 [01:06<05:00,  1.13it/s] 17%|█▋        | 69/409 [01:07<04:56,  1.15it/s] 17%|█▋        | 70/409 [01:08<05:03,  1.12it/s] 17%|█▋        | 71/409 [01:08<04:43,  1.19it/s] 18%|█▊        | 72/409 [01:10<05:27,  1.03it/s] 18%|█▊        | 73/409 [01:11<05:25,  1.03it/s] 18%|█▊        | 74/409 [01:11<05:00,  1.12it/s] 18%|█▊        | 75/409 [01:13<05:51,  1.05s/it] 19%|█▊        | 76/409 [01:14<05:57,  1.07s/it] 19%|█▉        | 77/409 [01:15<05:44,  1.04s/it] 19%|█▉        | 78/409 [01:16<05:24,  1.02it/s] 19%|█▉        | 79/409 [01:17<05:45,  1.05s/it] 20%|█▉        | 80/409 [01:18<05:11,  1.06it/s] 20%|█▉        | 81/409 [01:18<05:09,  1.06it/s] 20%|██        | 82/409 [01:19<04:59,  1.09it/s] 20%|██        | 83/409 [01:20<04:40,  1.16it/s] 21%|██        | 84/409 [01:21<04:36,  1.17it/s] 21%|██        | 85/409 [01:22<04:58,  1.09it/s] 21%|██        | 86/409 [01:23<04:47,  1.12it/s] 21%|██▏       | 87/409 [01:24<05:05,  1.06it/s] 22%|██▏       | 88/409 [01:25<05:39,  1.06s/it] 22%|██▏       | 89/409 [01:26<04:55,  1.08it/s] 22%|██▏       | 90/409 [01:26<04:33,  1.16it/s] 22%|██▏       | 91/409 [01:28<05:04,  1.04it/s] 22%|██▏       | 92/409 [01:28<04:28,  1.18it/s] 23%|██▎       | 93/409 [01:29<04:15,  1.24it/s] 23%|██▎       | 94/409 [01:29<03:43,  1.41it/s] 23%|██▎       | 95/409 [01:30<04:07,  1.27it/s] 23%|██▎       | 96/409 [01:31<04:24,  1.18it/s] 24%|██▎       | 97/409 [01:32<04:24,  1.18it/s] 24%|██▍       | 98/409 [01:33<04:11,  1.24it/s] 24%|██▍       | 99/409 [01:34<04:01,  1.28it/s] 24%|██▍       | 100/409 [01:34<03:57,  1.30it/s] 25%|██▍       | 101/409 [01:36<04:24,  1.16it/s] 25%|██▍       | 102/409 [01:36<04:23,  1.16it/s] 25%|██▌       | 103/409 [01:37<04:46,  1.07it/s] 25%|██▌       | 104/409 [01:38<04:49,  1.06it/s] 26%|██▌       | 105/409 [01:39<04:41,  1.08it/s] 26%|██▌       | 106/409 [01:40<04:33,  1.11it/s] 26%|██▌       | 107/409 [01:41<03:42,  1.35it/s] 26%|██▋       | 108/409 [01:41<03:28,  1.44it/s] 27%|██▋       | 109/409 [01:42<03:29,  1.43it/s] 27%|██▋       | 110/409 [01:43<03:32,  1.41it/s] 27%|██▋       | 111/409 [01:44<04:04,  1.22it/s] 27%|██▋       | 112/409 [01:45<04:05,  1.21it/s] 28%|██▊       | 113/409 [01:46<04:37,  1.07it/s] 28%|██▊       | 114/409 [01:46<04:18,  1.14it/s] 28%|██▊       | 115/409 [01:47<04:24,  1.11it/s] 28%|██▊       | 116/409 [01:49<05:11,  1.06s/it] 29%|██▊       | 117/409 [01:50<05:22,  1.11s/it] 29%|██▉       | 118/409 [01:51<04:27,  1.09it/s] 29%|██▉       | 119/409 [01:51<04:30,  1.07it/s] 29%|██▉       | 120/409 [01:52<04:31,  1.07it/s] 30%|██▉       | 121/409 [01:53<04:29,  1.07it/s] 30%|██▉       | 122/409 [01:55<05:07,  1.07s/it] 30%|███       | 123/409 [01:55<04:36,  1.03it/s] 30%|███       | 124/409 [01:56<04:24,  1.08it/s] 31%|███       | 125/409 [01:57<04:14,  1.11it/s] 31%|███       | 126/409 [01:58<03:59,  1.18it/s] 31%|███       | 127/409 [01:59<03:59,  1.18it/s] 31%|███▏      | 128/409 [01:59<03:48,  1.23it/s] 32%|███▏      | 129/409 [02:00<04:01,  1.16it/s] 32%|███▏      | 130/409 [02:01<03:48,  1.22it/s] 32%|███▏      | 131/409 [02:02<03:30,  1.32it/s] 32%|███▏      | 132/409 [02:02<03:26,  1.34it/s] 33%|███▎      | 133/409 [02:03<03:15,  1.41it/s] 33%|███▎      | 134/409 [02:04<03:43,  1.23it/s] 33%|███▎      | 135/409 [02:05<03:45,  1.21it/s] 33%|███▎      | 136/409 [02:06<03:28,  1.31it/s] 33%|███▎      | 137/409 [02:06<03:35,  1.26it/s] 34%|███▎      | 138/409 [02:08<04:05,  1.10it/s] 34%|███▍      | 139/409 [02:09<04:38,  1.03s/it] 34%|███▍      | 140/409 [02:09<03:51,  1.16it/s] 34%|███▍      | 141/409 [02:10<03:19,  1.34it/s] 35%|███▍      | 142/409 [02:11<03:06,  1.43it/s] 35%|███▍      | 143/409 [02:12<04:16,  1.04it/s] 35%|███▌      | 144/409 [02:13<04:35,  1.04s/it] 35%|███▌      | 145/409 [02:14<04:26,  1.01s/it] 36%|███▌      | 146/409 [02:15<04:01,  1.09it/s] 36%|███▌      | 147/409 [02:16<04:02,  1.08it/s] 36%|███▌      | 148/409 [02:17<03:45,  1.16it/s] 36%|███▋      | 149/409 [02:17<03:41,  1.17it/s] 37%|███▋      | 150/409 [02:18<03:41,  1.17it/s] 37%|███▋      | 151/409 [02:19<03:30,  1.23it/s] 37%|███▋      | 152/409 [02:20<03:47,  1.13it/s] 37%|███▋      | 153/409 [02:21<03:51,  1.10it/s] 38%|███▊      | 154/409 [02:21<03:09,  1.35it/s] 38%|███▊      | 155/409 [02:22<02:48,  1.51it/s] 38%|███▊      | 156/409 [02:23<03:09,  1.34it/s] 38%|███▊      | 157/409 [02:24<03:09,  1.33it/s] 39%|███▊      | 158/409 [02:24<03:14,  1.29it/s] 39%|███▉      | 159/409 [02:25<03:37,  1.15it/s] 39%|███▉      | 160/409 [02:26<03:43,  1.12it/s] 39%|███▉      | 161/409 [02:28<04:04,  1.01it/s] 40%|███▉      | 162/409 [02:28<03:43,  1.10it/s] 40%|███▉      | 163/409 [02:31<05:22,  1.31s/it] 40%|████      | 164/409 [02:32<05:02,  1.24s/it] 40%|████      | 165/409 [02:33<05:10,  1.27s/it] 41%|████      | 166/409 [02:34<04:56,  1.22s/it] 41%|████      | 167/409 [02:35<04:36,  1.14s/it] 41%|████      | 168/409 [02:37<04:57,  1.24s/it] 41%|████▏     | 169/409 [02:38<05:01,  1.26s/it] 42%|████▏     | 170/409 [02:39<04:38,  1.16s/it] 42%|████▏     | 171/409 [02:40<04:14,  1.07s/it] 42%|████▏     | 172/409 [02:41<04:21,  1.10s/it] 42%|████▏     | 173/409 [02:42<03:52,  1.01it/s] 43%|████▎     | 174/409 [02:42<03:48,  1.03it/s] 43%|████▎     | 175/409 [02:44<04:11,  1.07s/it] 43%|████▎     | 176/409 [02:44<03:37,  1.07it/s] 43%|████▎     | 177/409 [02:46<04:05,  1.06s/it] 44%|████▎     | 178/409 [02:47<03:49,  1.01it/s] 44%|████▍     | 179/409 [02:48<04:02,  1.06s/it] 44%|████▍     | 180/409 [02:49<03:40,  1.04it/s] 44%|████▍     | 181/409 [02:49<03:13,  1.18it/s] 44%|████▍     | 182/409 [02:50<03:04,  1.23it/s] 45%|████▍     | 183/409 [02:51<02:58,  1.26it/s] 45%|████▍     | 184/409 [02:51<03:00,  1.24it/s] 45%|████▌     | 185/409 [02:52<03:18,  1.13it/s] 45%|████▌     | 186/409 [02:54<03:38,  1.02it/s] 46%|████▌     | 187/409 [02:55<03:34,  1.04it/s] 46%|████▌     | 188/409 [02:55<03:17,  1.12it/s] 46%|████▌     | 189/409 [02:56<03:04,  1.19it/s] 46%|████▋     | 190/409 [02:57<03:07,  1.17it/s] 47%|████▋     | 191/409 [02:58<03:03,  1.19it/s] 47%|████▋     | 192/409 [02:59<03:11,  1.13it/s] 47%|████▋     | 193/409 [03:00<03:15,  1.11it/s] 47%|████▋     | 194/409 [03:00<03:05,  1.16it/s] 48%|████▊     | 195/409 [03:01<03:11,  1.12it/s] 48%|████▊     | 196/409 [03:03<03:23,  1.05it/s] 48%|████▊     | 197/409 [03:04<03:46,  1.07s/it] 48%|████▊     | 198/409 [03:05<03:37,  1.03s/it] 49%|████▊     | 199/409 [03:05<03:09,  1.11it/s] 49%|████▉     | 200/409 [03:06<03:19,  1.05it/s] 49%|████▉     | 201/409 [03:07<03:02,  1.14it/s] 49%|████▉     | 202/409 [03:08<03:06,  1.11it/s] 50%|████▉     | 203/409 [03:09<02:39,  1.29it/s] 50%|████▉     | 204/409 [03:09<02:44,  1.25it/s] 50%|█████     | 205/409 [03:11<03:21,  1.01it/s] 50%|█████     | 206/409 [03:12<02:56,  1.15it/s] 51%|█████     | 207/409 [03:12<03:00,  1.12it/s] 51%|█████     | 208/409 [03:13<02:45,  1.21it/s] 51%|█████     | 209/409 [03:14<02:37,  1.27it/s] 51%|█████▏    | 210/409 [03:15<02:47,  1.19it/s] 52%|█████▏    | 211/409 [03:15<02:32,  1.30it/s] 52%|█████▏    | 212/409 [03:16<02:21,  1.39it/s] 52%|█████▏    | 213/409 [03:17<02:41,  1.21it/s] 52%|█████▏    | 214/409 [03:18<02:55,  1.11it/s] 53%|█████▎    | 215/409 [03:19<02:45,  1.17it/s] 53%|█████▎    | 216/409 [03:21<04:11,  1.30s/it] 53%|█████▎    | 217/409 [03:22<03:29,  1.09s/it] 53%|█████▎    | 218/409 [03:22<02:53,  1.10it/s] 54%|█████▎    | 219/409 [03:23<02:43,  1.16it/s] 54%|█████▍    | 220/409 [03:24<02:34,  1.22it/s] 54%|█████▍    | 221/409 [03:25<02:27,  1.27it/s] 54%|█████▍    | 222/409 [03:25<02:30,  1.25it/s] 55%|█████▍    | 223/409 [03:26<02:31,  1.22it/s] 55%|█████▍    | 224/409 [03:27<02:33,  1.21it/s] 55%|█████▌    | 225/409 [03:28<02:21,  1.30it/s] 55%|█████▌    | 226/409 [03:29<02:25,  1.26it/s] 56%|█████▌    | 227/409 [03:29<02:13,  1.36it/s] 56%|█████▌    | 228/409 [03:30<02:37,  1.15it/s] 56%|█████▌    | 229/409 [03:31<02:14,  1.33it/s] 56%|█████▌    | 230/409 [03:32<02:19,  1.29it/s] 56%|█████▋    | 231/409 [03:32<02:21,  1.26it/s] 57%|█████▋    | 232/409 [03:34<02:41,  1.10it/s] 57%|█████▋    | 233/409 [03:34<02:31,  1.16it/s] 57%|█████▋    | 234/409 [03:35<02:24,  1.21it/s] 57%|█████▋    | 235/409 [03:36<02:11,  1.32it/s] 58%|█████▊    | 236/409 [03:37<02:16,  1.27it/s] 58%|█████▊    | 237/409 [03:37<01:59,  1.44it/s] 58%|█████▊    | 238/409 [03:38<02:24,  1.18it/s] 58%|█████▊    | 239/409 [03:40<03:20,  1.18s/it] 59%|█████▊    | 240/409 [03:41<02:55,  1.04s/it] 59%|█████▉    | 241/409 [03:42<02:44,  1.02it/s] 59%|█████▉    | 242/409 [03:43<02:54,  1.04s/it] 59%|█████▉    | 243/409 [03:44<02:38,  1.05it/s] 60%|█████▉    | 244/409 [03:45<02:58,  1.08s/it] 60%|█████▉    | 245/409 [03:46<02:34,  1.06it/s] 60%|██████    | 246/409 [03:46<02:10,  1.24it/s] 60%|██████    | 247/409 [03:47<02:17,  1.18it/s] 61%|██████    | 248/409 [03:48<02:15,  1.18it/s] 61%|██████    | 249/409 [03:49<02:10,  1.23it/s] 61%|██████    | 250/409 [03:50<02:16,  1.16it/s] 61%|██████▏   | 251/409 [03:52<03:04,  1.17s/it] 62%|██████▏   | 252/409 [03:52<02:47,  1.07s/it] 62%|██████▏   | 253/409 [03:54<02:58,  1.14s/it] 62%|██████▏   | 254/409 [03:55<02:43,  1.05s/it] 62%|██████▏   | 255/409 [03:56<02:48,  1.10s/it] 63%|██████▎   | 256/409 [03:57<02:36,  1.03s/it] 63%|██████▎   | 257/409 [03:58<02:33,  1.01s/it] 63%|██████▎   | 258/409 [03:58<02:09,  1.17it/s] 63%|██████▎   | 259/409 [03:59<02:07,  1.17it/s] 64%|██████▎   | 260/409 [04:00<02:27,  1.01it/s] 64%|██████▍   | 261/409 [04:01<02:25,  1.02it/s] 64%|██████▍   | 262/409 [04:02<02:02,  1.20it/s] 64%|██████▍   | 263/409 [04:03<02:07,  1.15it/s] 65%|██████▍   | 264/409 [04:03<01:49,  1.33it/s] 65%|██████▍   | 265/409 [04:04<01:47,  1.35it/s] 65%|██████▌   | 266/409 [04:05<02:05,  1.14it/s] 65%|██████▌   | 267/409 [04:06<02:06,  1.12it/s] 66%|██████▌   | 268/409 [04:07<01:53,  1.25it/s] 66%|██████▌   | 269/409 [04:07<01:53,  1.23it/s] 66%|██████▌   | 270/409 [04:09<02:07,  1.09it/s] 66%|██████▋   | 271/409 [04:09<01:58,  1.16it/s] 67%|██████▋   | 272/409 [04:11<02:25,  1.06s/it] 67%|██████▋   | 273/409 [04:12<02:10,  1.04it/s] 67%|██████▋   | 274/409 [04:13<02:18,  1.03s/it] 67%|██████▋   | 275/409 [04:15<02:56,  1.32s/it] 67%|██████▋   | 276/409 [04:16<02:41,  1.21s/it] 68%|██████▊   | 277/409 [04:16<02:21,  1.07s/it] 68%|██████▊   | 278/409 [04:18<02:21,  1.08s/it] 68%|██████▊   | 279/409 [04:18<02:10,  1.01s/it] 68%|██████▊   | 280/409 [04:19<01:54,  1.13it/s] 69%|██████▊   | 281/409 [04:20<01:51,  1.15it/s] 69%|██████▉   | 282/409 [04:21<01:49,  1.16it/s] 69%|██████▉   | 283/409 [04:22<02:16,  1.09s/it] 69%|██████▉   | 284/409 [04:23<02:19,  1.12s/it] 70%|██████▉   | 285/409 [04:24<01:55,  1.08it/s] 70%|██████▉   | 286/409 [04:24<01:37,  1.26it/s] 70%|███████   | 287/409 [04:25<01:38,  1.24it/s] 70%|███████   | 288/409 [04:26<01:35,  1.27it/s] 71%|███████   | 289/409 [04:27<01:28,  1.36it/s] 71%|███████   | 290/409 [04:27<01:26,  1.37it/s] 71%|███████   | 291/409 [04:28<01:38,  1.20it/s] 71%|███████▏  | 292/409 [04:29<01:33,  1.25it/s] 72%|███████▏  | 293/409 [04:30<01:33,  1.24it/s] 72%|███████▏  | 294/409 [04:31<01:46,  1.08it/s] 72%|███████▏  | 295/409 [04:32<01:42,  1.11it/s] 72%|███████▏  | 296/409 [04:32<01:23,  1.35it/s] 73%|███████▎  | 297/409 [04:33<01:30,  1.24it/s] 73%|███████▎  | 298/409 [04:35<01:44,  1.07it/s] 73%|███████▎  | 299/409 [04:36<01:52,  1.02s/it] 73%|███████▎  | 300/409 [04:37<02:05,  1.15s/it] 74%|███████▎  | 301/409 [04:38<02:02,  1.13s/it] 74%|███████▍  | 302/409 [04:40<02:15,  1.27s/it] 74%|███████▍  | 303/409 [04:41<02:24,  1.37s/it] 74%|███████▍  | 304/409 [04:42<01:55,  1.10s/it] 75%|███████▍  | 305/409 [04:43<01:49,  1.05s/it] 75%|███████▍  | 306/409 [04:44<01:45,  1.03s/it] 75%|███████▌  | 307/409 [04:45<01:54,  1.12s/it] 75%|███████▌  | 308/409 [04:46<01:40,  1.00it/s] 76%|███████▌  | 309/409 [04:47<01:31,  1.09it/s] 76%|███████▌  | 310/409 [04:48<01:34,  1.04it/s] 76%|███████▌  | 311/409 [04:49<01:35,  1.03it/s] 76%|███████▋  | 312/409 [04:50<01:34,  1.03it/s] 77%|███████▋  | 313/409 [04:50<01:26,  1.11it/s] 77%|███████▋  | 314/409 [04:52<01:34,  1.00it/s] 77%|███████▋  | 315/409 [04:53<01:39,  1.06s/it] 77%|███████▋  | 316/409 [04:53<01:18,  1.18it/s] 78%|███████▊  | 317/409 [04:55<01:31,  1.00it/s] 78%|███████▊  | 318/409 [04:56<01:33,  1.02s/it] 78%|███████▊  | 319/409 [04:57<01:30,  1.01s/it] 78%|███████▊  | 320/409 [04:57<01:25,  1.04it/s] 78%|███████▊  | 321/409 [04:58<01:15,  1.17it/s] 79%|███████▊  | 322/409 [04:59<01:14,  1.17it/s] 79%|███████▉  | 323/409 [05:00<01:16,  1.13it/s] 79%|███████▉  | 324/409 [05:00<01:05,  1.31it/s] 79%|███████▉  | 325/409 [05:01<00:58,  1.44it/s] 80%|███████▉  | 326/409 [05:01<00:55,  1.51it/s] 80%|███████▉  | 327/409 [05:02<00:52,  1.56it/s] 80%|████████  | 328/409 [05:03<00:51,  1.58it/s] 80%|████████  | 329/409 [05:04<00:58,  1.38it/s] 81%|████████  | 330/409 [05:05<01:01,  1.29it/s] 81%|████████  | 331/409 [05:05<01:02,  1.25it/s] 81%|████████  | 332/409 [05:07<01:19,  1.03s/it] 81%|████████▏ | 333/409 [05:08<01:17,  1.02s/it] 82%|████████▏ | 334/409 [05:09<01:17,  1.03s/it] 82%|████████▏ | 335/409 [05:11<01:27,  1.18s/it] 82%|████████▏ | 336/409 [05:12<01:27,  1.20s/it] 82%|████████▏ | 337/409 [05:12<01:13,  1.03s/it] 83%|████████▎ | 338/409 [05:13<01:01,  1.16it/s] 83%|████████▎ | 339/409 [05:13<00:54,  1.28it/s] 83%|████████▎ | 340/409 [05:14<00:45,  1.52it/s] 83%|████████▎ | 341/409 [05:14<00:36,  1.88it/s] 84%|████████▎ | 342/409 [05:15<00:39,  1.70it/s] 84%|████████▍ | 343/409 [05:16<00:48,  1.35it/s] 84%|████████▍ | 344/409 [05:16<00:45,  1.44it/s] 84%|████████▍ | 345/409 [05:18<00:56,  1.14it/s] 85%|████████▍ | 346/409 [05:19<00:54,  1.16it/s] 85%|████████▍ | 347/409 [05:20<00:55,  1.12it/s] 85%|████████▌ | 348/409 [05:20<00:54,  1.12it/s] 85%|████████▌ | 349/409 [05:21<00:52,  1.15it/s] 86%|████████▌ | 350/409 [05:23<00:59,  1.00s/it] 86%|████████▌ | 351/409 [05:23<00:52,  1.10it/s] 86%|████████▌ | 352/409 [05:24<00:48,  1.16it/s] 86%|████████▋ | 353/409 [05:25<00:45,  1.23it/s] 87%|████████▋ | 354/409 [05:26<00:47,  1.17it/s] 87%|████████▋ | 355/409 [05:27<00:47,  1.13it/s] 87%|████████▋ | 356/409 [05:27<00:46,  1.14it/s] 87%|████████▋ | 357/409 [05:28<00:44,  1.16it/s] 88%|████████▊ | 358/409 [05:29<00:45,  1.12it/s] 88%|████████▊ | 359/409 [05:30<00:42,  1.19it/s] 88%|████████▊ | 360/409 [05:31<00:44,  1.09it/s] 88%|████████▊ | 361/409 [05:32<00:39,  1.22it/s] 89%|████████▊ | 362/409 [05:32<00:37,  1.27it/s] 89%|████████▉ | 363/409 [05:34<00:41,  1.10it/s] 89%|████████▉ | 364/409 [05:34<00:38,  1.18it/s] 89%|████████▉ | 365/409 [05:36<00:44,  1.00s/it] 89%|████████▉ | 366/409 [05:36<00:37,  1.13it/s] 90%|████████▉ | 367/409 [05:37<00:36,  1.14it/s] 90%|████████▉ | 368/409 [05:38<00:33,  1.21it/s] 90%|█████████ | 369/409 [05:39<00:34,  1.16it/s] 90%|█████████ | 370/409 [05:40<00:35,  1.11it/s] 91%|█████████ | 371/409 [05:41<00:36,  1.04it/s] 91%|█████████ | 372/409 [05:42<00:32,  1.13it/s] 91%|█████████ | 373/409 [05:42<00:31,  1.14it/s] 91%|█████████▏| 374/409 [05:43<00:30,  1.15it/s] 92%|█████████▏| 375/409 [05:44<00:30,  1.11it/s] 92%|█████████▏| 376/409 [05:45<00:32,  1.01it/s] 92%|█████████▏| 377/409 [05:46<00:30,  1.06it/s] 92%|█████████▏| 378/409 [05:47<00:28,  1.08it/s] 93%|█████████▎| 379/409 [05:48<00:29,  1.03it/s] 93%|█████████▎| 380/409 [05:49<00:26,  1.08it/s] 93%|█████████▎| 381/409 [05:50<00:25,  1.11it/s] 93%|█████████▎| 382/409 [05:51<00:27,  1.02s/it] 94%|█████████▎| 383/409 [05:52<00:23,  1.12it/s] 94%|█████████▍| 384/409 [05:53<00:25,  1.01s/it] 94%|█████████▍| 385/409 [05:53<00:19,  1.23it/s] 94%|█████████▍| 386/409 [05:54<00:14,  1.56it/s] 95%|█████████▍| 387/409 [05:54<00:12,  1.80it/s] 95%|█████████▍| 388/409 [05:55<00:12,  1.65it/s] 95%|█████████▌| 389/409 [05:55<00:12,  1.66it/s] 95%|█████████▌| 390/409 [05:56<00:12,  1.48it/s] 96%|█████████▌| 391/409 [05:57<00:11,  1.55it/s] 96%|█████████▌| 392/409 [05:57<00:10,  1.59it/s] 96%|█████████▌| 393/409 [05:59<00:13,  1.23it/s] 96%|█████████▋| 394/409 [06:00<00:12,  1.17it/s] 97%|█████████▋| 395/409 [06:01<00:13,  1.05it/s] 97%|█████████▋| 396/409 [06:02<00:11,  1.12it/s] 97%|█████████▋| 397/409 [06:03<00:11,  1.00it/s] 97%|█████████▋| 398/409 [06:03<00:10,  1.09it/s] 98%|█████████▊| 399/409 [06:04<00:08,  1.12it/s] 98%|█████████▊| 400/409 [06:05<00:07,  1.24it/s] 98%|█████████▊| 401/409 [06:06<00:07,  1.09it/s] 98%|█████████▊| 402/409 [06:07<00:06,  1.12it/s] 99%|█████████▊| 403/409 [06:08<00:05,  1.05it/s] 99%|█████████▉| 404/409 [06:09<00:05,  1.02s/it] 99%|█████████▉| 405/409 [06:10<00:04,  1.03s/it] 99%|█████████▉| 406/409 [06:11<00:03,  1.01s/it]100%|█████████▉| 407/409 [06:12<00:01,  1.09it/s]100%|█████████▉| 408/409 [06:13<00:00,  1.03it/s]100%|██████████| 409/409 [06:13<00:00,  1.22it/s]100%|██████████| 409/409 [06:13<00:00,  1.09it/s]
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:274: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
2023-11-01 13:10:35.231382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24005 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:17:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.43it/s]100%|██████████| 1/1 [00:00<00:00,  5.41it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-c5820cafa99de9bd.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-3a67d2a31e78f2b9.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.23it/s]  3%|▎         | 3/100 [00:00<00:07, 13.24it/s]  5%|▌         | 5/100 [00:00<00:06, 14.93it/s]  7%|▋         | 7/100 [00:00<00:05, 15.73it/s]  9%|▉         | 9/100 [00:00<00:05, 16.17it/s] 11%|█         | 11/100 [00:00<00:05, 16.45it/s] 13%|█▎        | 13/100 [00:00<00:05, 16.63it/s] 15%|█▌        | 15/100 [00:00<00:05, 16.74it/s] 17%|█▋        | 17/100 [00:01<00:04, 16.81it/s] 19%|█▉        | 19/100 [00:01<00:04, 16.87it/s] 21%|██        | 21/100 [00:01<00:04, 16.91it/s] 23%|██▎       | 23/100 [00:01<00:04, 16.93it/s] 25%|██▌       | 25/100 [00:01<00:04, 16.95it/s] 27%|██▋       | 27/100 [00:01<00:04, 16.97it/s] 29%|██▉       | 29/100 [00:01<00:04, 16.98it/s] 31%|███       | 31/100 [00:01<00:04, 16.98it/s] 33%|███▎      | 33/100 [00:02<00:03, 16.99it/s] 35%|███▌      | 35/100 [00:02<00:03, 16.99it/s] 37%|███▋      | 37/100 [00:02<00:03, 16.99it/s] 39%|███▉      | 39/100 [00:02<00:03, 16.99it/s] 41%|████      | 41/100 [00:02<00:03, 17.00it/s] 43%|████▎     | 43/100 [00:02<00:03, 17.00it/s] 45%|████▌     | 45/100 [00:02<00:03, 17.00it/s] 47%|████▋     | 47/100 [00:02<00:03, 16.99it/s] 49%|████▉     | 49/100 [00:02<00:03, 16.99it/s] 51%|█████     | 51/100 [00:03<00:02, 16.99it/s] 53%|█████▎    | 53/100 [00:03<00:02, 16.99it/s] 55%|█████▌    | 55/100 [00:03<00:02, 16.94it/s] 57%|█████▋    | 57/100 [00:03<00:02, 16.95it/s] 59%|█████▉    | 59/100 [00:03<00:02, 16.96it/s] 61%|██████    | 61/100 [00:03<00:02, 16.97it/s] 63%|██████▎   | 63/100 [00:03<00:02, 16.98it/s] 65%|██████▌   | 65/100 [00:03<00:02, 16.98it/s] 67%|██████▋   | 67/100 [00:04<00:01, 16.96it/s] 69%|██████▉   | 69/100 [00:04<00:01, 16.96it/s] 71%|███████   | 71/100 [00:04<00:01, 16.96it/s] 73%|███████▎  | 73/100 [00:04<00:01, 16.97it/s] 75%|███████▌  | 75/100 [00:04<00:01, 16.98it/s] 77%|███████▋  | 77/100 [00:04<00:01, 16.98it/s] 79%|███████▉  | 79/100 [00:04<00:01, 16.99it/s] 81%|████████  | 81/100 [00:04<00:01, 17.00it/s] 83%|████████▎ | 83/100 [00:04<00:00, 17.00it/s] 85%|████████▌ | 85/100 [00:05<00:00, 17.01it/s] 87%|████████▋ | 87/100 [00:05<00:00, 17.01it/s] 89%|████████▉ | 89/100 [00:05<00:00, 17.00it/s] 91%|█████████ | 91/100 [00:05<00:00, 17.01it/s] 93%|█████████▎| 93/100 [00:05<00:00, 16.94it/s] 95%|█████████▌| 95/100 [00:05<00:00, 16.96it/s] 97%|█████████▋| 97/100 [00:05<00:00, 16.97it/s] 99%|█████████▉| 99/100 [00:05<00:00, 16.98it/s]100%|██████████| 100/100 [00:05<00:00, 16.80it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 362.64it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-51bae7fcc8029634.arrow
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:   4%|▍         | 4/100 [00:00<00:02, 34.90 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2156 > 2048). Running this sequence through the model will result in indexing errors
Map:  12%|█▏        | 12/100 [00:00<00:01, 54.27 examples/s]Map:  25%|██▌       | 25/100 [00:00<00:00, 81.94 examples/s]Map:  39%|███▉      | 39/100 [00:00<00:00, 97.05 examples/s]Map:  55%|█████▌    | 55/100 [00:00<00:00, 117.33 examples/s]Map:  71%|███████   | 71/100 [00:00<00:00, 109.22 examples/s]Map:  83%|████████▎ | 83/100 [00:00<00:00, 111.61 examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 125.16 examples/s]                                                                0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.39it/s]  2%|▏         | 2/100 [00:00<00:12,  7.58it/s]  3%|▎         | 3/100 [00:00<00:12,  7.93it/s]  4%|▍         | 4/100 [00:00<00:12,  7.95it/s]  5%|▌         | 5/100 [00:00<00:11,  7.95it/s]  6%|▌         | 6/100 [00:00<00:11,  7.84it/s]  7%|▋         | 7/100 [00:00<00:11,  7.89it/s]  8%|▊         | 8/100 [00:01<00:11,  7.80it/s]  9%|▉         | 9/100 [00:01<00:11,  7.84it/s] 10%|█         | 10/100 [00:01<00:11,  7.90it/s] 11%|█         | 11/100 [00:01<00:11,  7.92it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.95it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.87it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.73it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.81it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.81it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.90it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.84it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.87it/s] 20%|██        | 20/100 [00:02<00:10,  7.88it/s] 21%|██        | 21/100 [00:02<00:09,  7.92it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.83it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.91it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.81it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.76it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.86it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.87it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.86it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.87it/s] 30%|███       | 30/100 [00:03<00:08,  7.81it/s] 31%|███       | 31/100 [00:03<00:08,  7.89it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.93it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.95it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.97it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.98it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.99it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.95it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.82it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.80it/s] 40%|████      | 40/100 [00:05<00:07,  7.86it/s] 41%|████      | 41/100 [00:05<00:07,  7.92it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.85it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.92it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.92it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.91it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.96it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.79it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.75it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.71it/s] 50%|█████     | 50/100 [00:06<00:06,  7.67it/s] 51%|█████     | 51/100 [00:06<00:06,  7.73it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.76it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.77it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.82it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.72it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.66it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.79it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.86it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.91it/s] 60%|██████    | 60/100 [00:07<00:05,  7.90it/s] 61%|██████    | 61/100 [00:07<00:05,  7.75it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.75it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.85it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.85it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.92it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.95it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.90it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.96it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.88it/s] 70%|███████   | 70/100 [00:08<00:03,  7.93it/s] 71%|███████   | 71/100 [00:09<00:03,  7.95it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.97it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.94it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.89it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.88it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.88it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.78it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.82it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.87it/s] 80%|████████  | 80/100 [00:10<00:02,  7.84it/s] 81%|████████  | 81/100 [00:10<00:02,  7.82it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.94it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.96it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.95it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.82it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.87it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.80it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.71it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.86it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.91it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.94it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.97it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.73it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.72it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.83it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.77it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.76it/s]100%|██████████| 100/100 [00:12<00:00,  7.86it/s]100%|██████████| 100/100 [00:12<00:00,  7.85it/s]
FOLD 0
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.259169  0.538429  5.654219     3.661127
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.13it/s]  6%|▋         | 2/32 [00:00<00:13,  2.15it/s]  9%|▉         | 3/32 [00:01<00:14,  2.05it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.03it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.96it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.90it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.85it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.82it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.71it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.64it/s] 34%|███▍      | 11/32 [00:06<00:13,  1.61it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.58it/s] 41%|████      | 13/32 [00:07<00:12,  1.57it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.55it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.52it/s] 50%|█████     | 16/32 [00:09<00:10,  1.52it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.52it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.50it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.43it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.42it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.42it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.41it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.42it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.44it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.45it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.49it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.48it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.51it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.52it/s]100%|██████████| 32/32 [00:20<00:00,  1.41it/s]100%|██████████| 32/32 [00:20<00:00,  1.55it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.55687606 0.58743633 0.55687606 ... 0.55687606 0.55687606 0.55687606]
 [0.55687606 0.55687606 0.55687606 ... 0.60271647 0.55687606 0.55687606]
 [0.55687606 0.58573854 0.67911715 ... 0.58404075 0.55687606 0.60950764]
 ...
 [0.65025467 0.55348048 0.56027165 ... 0.63667233 0.55687606 0.56196944]
 [0.70288625 0.56196944 0.5721562  ... 0.55857385 0.64006791 0.55687606]
 [0.57555178 0.61120543 0.65704584 ... 0.62308998 0.62988115 0.65195246]]
Heads intervened:  [(6, 28), (7, 23), (8, 5), (8, 12), (8, 15), (8, 20), (8, 29), (9, 11), (9, 29), (10, 7), (10, 15), (10, 17), (10, 22), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 21), (11, 31), (12, 14), (13, 16), (13, 22), (13, 30), (14, 0), (14, 14), (14, 18), (14, 20), (14, 22), (15, 20), (15, 28), (16, 1), (16, 2), (16, 7), (16, 10), (16, 25), (16, 26), (17, 0), (17, 1), (17, 4), (17, 21), (18, 0), (18, 9), (18, 10), (18, 17), (20, 9), (20, 30), (22, 11)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/408 [00:00<?, ?it/s]  0%|          | 1/408 [00:01<11:20,  1.67s/it]  0%|          | 2/408 [00:02<09:26,  1.40s/it]  1%|          | 3/408 [00:03<08:22,  1.24s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  1%|          | 4/408 [00:05<09:49,  1.46s/it]  1%|          | 5/408 [00:06<07:43,  1.15s/it]  1%|▏         | 6/408 [00:07<06:59,  1.04s/it]  2%|▏         | 7/408 [00:07<05:13,  1.28it/s]  2%|▏         | 8/408 [00:08<05:32,  1.20it/s]  2%|▏         | 9/408 [00:08<04:48,  1.39it/s]  2%|▏         | 10/408 [00:09<04:31,  1.47it/s]  3%|▎         | 11/408 [00:10<05:49,  1.14it/s]  3%|▎         | 12/408 [00:11<05:46,  1.14it/s]  3%|▎         | 13/408 [00:12<05:30,  1.20it/s]  3%|▎         | 14/408 [00:13<05:49,  1.13it/s]  4%|▎         | 15/408 [00:14<05:29,  1.19it/s]  4%|▍         | 16/408 [00:14<05:12,  1.26it/s]  4%|▍         | 17/408 [00:15<04:47,  1.36it/s]  4%|▍         | 18/408 [00:16<05:17,  1.23it/s]  5%|▍         | 19/408 [00:16<04:35,  1.41it/s]  5%|▍         | 20/408 [00:17<04:06,  1.58it/s]  5%|▌         | 21/408 [00:18<05:31,  1.17it/s]  5%|▌         | 22/408 [00:19<05:32,  1.16it/s]  6%|▌         | 23/408 [00:21<07:31,  1.17s/it]  6%|▌         | 24/408 [00:22<07:04,  1.11s/it]  6%|▌         | 25/408 [00:23<07:17,  1.14s/it]  6%|▋         | 26/408 [00:24<07:07,  1.12s/it]  7%|▋         | 27/408 [00:25<06:37,  1.04s/it]  7%|▋         | 28/408 [00:26<05:46,  1.10it/s]  7%|▋         | 29/408 [00:27<06:58,  1.11s/it]  7%|▋         | 30/408 [00:28<06:10,  1.02it/s]  8%|▊         | 31/408 [00:29<07:10,  1.14s/it]  8%|▊         | 32/408 [00:30<06:48,  1.09s/it]  8%|▊         | 33/408 [00:31<06:21,  1.02s/it]  8%|▊         | 34/408 [00:32<06:45,  1.08s/it]  9%|▊         | 35/408 [00:33<06:14,  1.00s/it]  9%|▉         | 36/408 [00:34<04:49,  1.28it/s]  9%|▉         | 37/408 [00:34<04:44,  1.30it/s]  9%|▉         | 38/408 [00:35<04:25,  1.39it/s] 10%|▉         | 39/408 [00:35<04:11,  1.47it/s] 10%|▉         | 40/408 [00:37<05:05,  1.20it/s] 10%|█         | 41/408 [00:37<05:05,  1.20it/s] 10%|█         | 42/408 [00:38<05:05,  1.20it/s] 11%|█         | 43/408 [00:39<05:34,  1.09it/s] 11%|█         | 44/408 [00:40<05:47,  1.05it/s] 11%|█         | 45/408 [00:42<05:58,  1.01it/s] 11%|█▏        | 46/408 [00:43<06:51,  1.14s/it] 12%|█▏        | 47/408 [00:44<06:32,  1.09s/it] 12%|█▏        | 48/408 [00:45<06:32,  1.09s/it] 12%|█▏        | 49/408 [00:46<06:34,  1.10s/it] 12%|█▏        | 50/408 [00:47<06:28,  1.09s/it] 12%|█▎        | 51/408 [00:48<06:29,  1.09s/it] 13%|█▎        | 52/408 [00:49<06:02,  1.02s/it] 13%|█▎        | 53/408 [00:50<05:29,  1.08it/s] 13%|█▎        | 54/408 [00:51<05:55,  1.00s/it] 13%|█▎        | 55/408 [00:52<05:11,  1.13it/s] 14%|█▎        | 56/408 [00:53<05:06,  1.15it/s] 14%|█▍        | 57/408 [00:53<04:12,  1.39it/s] 14%|█▍        | 58/408 [00:55<06:15,  1.07s/it] 14%|█▍        | 59/408 [00:56<06:45,  1.16s/it] 15%|█▍        | 60/408 [00:58<07:03,  1.22s/it] 15%|█▍        | 61/408 [00:58<05:59,  1.04s/it] 15%|█▌        | 62/408 [00:59<05:38,  1.02it/s] 15%|█▌        | 63/408 [01:00<05:10,  1.11it/s] 16%|█▌        | 64/408 [01:00<04:53,  1.17it/s] 16%|█▌        | 65/408 [01:02<05:30,  1.04it/s] 16%|█▌        | 66/408 [01:02<04:40,  1.22it/s] 16%|█▋        | 67/408 [01:03<04:15,  1.33it/s] 17%|█▋        | 68/408 [01:03<04:10,  1.36it/s] 17%|█▋        | 69/408 [01:04<03:43,  1.52it/s] 17%|█▋        | 70/408 [01:05<04:10,  1.35it/s] 17%|█▋        | 71/408 [01:05<03:31,  1.59it/s] 18%|█▊        | 72/408 [01:07<05:25,  1.03it/s] 18%|█▊        | 73/408 [01:09<06:29,  1.16s/it] 18%|█▊        | 74/408 [01:09<05:20,  1.04it/s] 18%|█▊        | 75/408 [01:10<05:42,  1.03s/it] 19%|█▊        | 76/408 [01:11<05:12,  1.06it/s] 19%|█▉        | 77/408 [01:12<05:03,  1.09it/s] 19%|█▉        | 78/408 [01:13<05:06,  1.08it/s] 19%|█▉        | 79/408 [01:14<05:07,  1.07it/s] 20%|█▉        | 80/408 [01:15<05:28,  1.00s/it] 20%|█▉        | 81/408 [01:16<05:09,  1.06it/s] 20%|██        | 82/408 [01:16<04:44,  1.14it/s] 20%|██        | 83/408 [01:17<04:16,  1.27it/s] 21%|██        | 84/408 [01:18<04:55,  1.10it/s] 21%|██        | 85/408 [01:19<04:57,  1.09it/s] 21%|██        | 86/408 [01:21<05:44,  1.07s/it] 21%|██▏       | 87/408 [01:21<05:21,  1.00s/it] 22%|██▏       | 88/408 [01:23<05:39,  1.06s/it] 22%|██▏       | 89/408 [01:24<05:27,  1.03s/it] 22%|██▏       | 90/408 [01:24<04:34,  1.16it/s] 22%|██▏       | 91/408 [01:25<05:06,  1.03it/s] 23%|██▎       | 92/408 [01:26<04:52,  1.08it/s] 23%|██▎       | 93/408 [01:28<05:47,  1.10s/it] 23%|██▎       | 94/408 [01:29<05:44,  1.10s/it] 23%|██▎       | 95/408 [01:29<04:57,  1.05it/s] 24%|██▎       | 96/408 [01:30<04:35,  1.13it/s] 24%|██▍       | 97/408 [01:31<04:30,  1.15it/s] 24%|██▍       | 98/408 [01:32<04:48,  1.07it/s] 24%|██▍       | 99/408 [01:33<05:35,  1.09s/it] 25%|██▍       | 100/408 [01:34<05:12,  1.01s/it] 25%|██▍       | 101/408 [01:35<04:00,  1.27it/s] 25%|██▌       | 102/408 [01:35<03:53,  1.31it/s] 25%|██▌       | 103/408 [01:36<03:59,  1.27it/s] 25%|██▌       | 104/408 [01:37<04:03,  1.25it/s] 26%|██▌       | 105/408 [01:38<04:17,  1.18it/s] 26%|██▌       | 106/408 [01:39<05:04,  1.01s/it] 26%|██▌       | 107/408 [01:40<04:17,  1.17it/s] 26%|██▋       | 108/408 [01:41<04:36,  1.09it/s] 27%|██▋       | 109/408 [01:42<04:16,  1.17it/s] 27%|██▋       | 110/408 [01:42<03:52,  1.28it/s] 27%|██▋       | 111/408 [01:43<04:18,  1.15it/s] 27%|██▋       | 112/408 [01:44<03:52,  1.27it/s] 28%|██▊       | 113/408 [01:45<03:47,  1.30it/s] 28%|██▊       | 114/408 [01:46<04:34,  1.07it/s] 28%|██▊       | 115/408 [01:47<05:15,  1.08s/it] 28%|██▊       | 116/408 [01:48<05:25,  1.11s/it] 29%|██▊       | 117/408 [01:49<05:09,  1.06s/it] 29%|██▉       | 118/408 [01:50<05:08,  1.06s/it] 29%|██▉       | 119/408 [01:52<05:09,  1.07s/it] 29%|██▉       | 120/408 [01:52<04:49,  1.01s/it] 30%|██▉       | 121/408 [01:53<04:03,  1.18it/s] 30%|██▉       | 122/408 [01:54<03:42,  1.28it/s] 30%|███       | 123/408 [01:55<04:17,  1.11it/s] 30%|███       | 124/408 [01:55<04:01,  1.17it/s] 31%|███       | 125/408 [01:56<03:50,  1.23it/s] 31%|███       | 126/408 [01:57<03:39,  1.29it/s] 31%|███       | 127/408 [01:58<04:13,  1.11it/s] 31%|███▏      | 128/408 [01:58<03:16,  1.42it/s] 32%|███▏      | 129/408 [02:00<03:59,  1.17it/s] 32%|███▏      | 130/408 [02:01<04:50,  1.04s/it] 32%|███▏      | 131/408 [02:02<04:34,  1.01it/s] 32%|███▏      | 132/408 [02:03<04:21,  1.06it/s] 33%|███▎      | 133/408 [02:04<04:29,  1.02it/s] 33%|███▎      | 134/408 [02:06<05:38,  1.23s/it] 33%|███▎      | 135/408 [02:07<06:16,  1.38s/it] 33%|███▎      | 136/408 [02:08<05:54,  1.30s/it] 34%|███▎      | 137/408 [02:09<04:48,  1.06s/it] 34%|███▍      | 138/408 [02:10<04:41,  1.04s/it] 34%|███▍      | 139/408 [02:11<04:26,  1.01it/s] 34%|███▍      | 140/408 [02:12<05:16,  1.18s/it] 35%|███▍      | 141/408 [02:13<04:47,  1.08s/it] 35%|███▍      | 142/408 [02:15<05:05,  1.15s/it] 35%|███▌      | 143/408 [02:16<04:47,  1.09s/it] 35%|███▌      | 144/408 [02:16<04:30,  1.03s/it] 36%|███▌      | 145/408 [02:17<04:26,  1.01s/it] 36%|███▌      | 146/408 [02:18<04:10,  1.05it/s] 36%|███▌      | 147/408 [02:19<04:08,  1.05it/s] 36%|███▋      | 148/408 [02:20<03:50,  1.13it/s] 37%|███▋      | 149/408 [02:21<04:06,  1.05it/s] 37%|███▋      | 150/408 [02:22<04:06,  1.05it/s] 37%|███▋      | 151/408 [02:22<03:28,  1.23it/s] 37%|███▋      | 152/408 [02:23<03:45,  1.13it/s] 38%|███▊      | 153/408 [02:24<03:51,  1.10it/s] 38%|███▊      | 154/408 [02:25<03:46,  1.12it/s] 38%|███▊      | 155/408 [02:27<05:22,  1.28s/it] 38%|███▊      | 156/408 [02:28<04:57,  1.18s/it] 38%|███▊      | 157/408 [02:30<05:23,  1.29s/it] 39%|███▊      | 158/408 [02:31<05:05,  1.22s/it] 39%|███▉      | 159/408 [02:32<04:43,  1.14s/it] 39%|███▉      | 160/408 [02:33<04:03,  1.02it/s] 39%|███▉      | 161/408 [02:33<03:35,  1.15it/s] 40%|███▉      | 162/408 [02:34<03:32,  1.16it/s] 40%|███▉      | 163/408 [02:35<03:31,  1.16it/s] 40%|████      | 164/408 [02:36<03:20,  1.22it/s] 40%|████      | 165/408 [02:37<03:28,  1.16it/s] 41%|████      | 166/408 [02:37<03:27,  1.17it/s] 41%|████      | 167/408 [02:38<03:00,  1.34it/s] 41%|████      | 168/408 [02:39<02:49,  1.42it/s] 41%|████▏     | 169/408 [02:39<02:59,  1.33it/s] 42%|████▏     | 170/408 [02:40<03:14,  1.22it/s] 42%|████▏     | 171/408 [02:41<03:08,  1.26it/s] 42%|████▏     | 172/408 [02:42<02:54,  1.35it/s] 42%|████▏     | 173/408 [02:43<03:37,  1.08it/s] 43%|████▎     | 174/408 [02:44<04:01,  1.03s/it] 43%|████▎     | 175/408 [02:45<03:53,  1.00s/it] 43%|████▎     | 176/408 [02:46<03:34,  1.08it/s] 43%|████▎     | 177/408 [02:46<03:02,  1.27it/s] 44%|████▎     | 178/408 [02:48<03:38,  1.05it/s] 44%|████▍     | 179/408 [02:49<03:25,  1.11it/s] 44%|████▍     | 180/408 [02:49<03:14,  1.17it/s] 44%|████▍     | 181/408 [02:50<02:58,  1.27it/s] 45%|████▍     | 182/408 [02:51<03:01,  1.25it/s] 45%|████▍     | 183/408 [02:52<03:34,  1.05it/s] 45%|████▌     | 184/408 [02:53<03:11,  1.17it/s] 45%|████▌     | 185/408 [02:53<03:00,  1.24it/s] 46%|████▌     | 186/408 [02:54<03:09,  1.17it/s] 46%|████▌     | 187/408 [02:56<03:56,  1.07s/it] 46%|████▌     | 188/408 [02:57<03:33,  1.03it/s] 46%|████▋     | 189/408 [02:58<03:32,  1.03it/s] 47%|████▋     | 190/408 [02:59<03:29,  1.04it/s] 47%|████▋     | 191/408 [02:59<03:19,  1.09it/s] 47%|████▋     | 192/408 [03:01<03:27,  1.04it/s] 47%|████▋     | 193/408 [03:01<03:26,  1.04it/s] 48%|████▊     | 194/408 [03:02<03:11,  1.12it/s] 48%|████▊     | 195/408 [03:03<03:08,  1.13it/s] 48%|████▊     | 196/408 [03:04<02:41,  1.31it/s] 48%|████▊     | 197/408 [03:04<02:37,  1.34it/s] 49%|████▊     | 198/408 [03:05<02:27,  1.42it/s] 49%|████▉     | 199/408 [03:05<02:06,  1.65it/s] 49%|████▉     | 200/408 [03:06<02:37,  1.32it/s] 49%|████▉     | 201/408 [03:07<02:50,  1.21it/s] 50%|████▉     | 202/408 [03:08<02:42,  1.27it/s] 50%|████▉     | 203/408 [03:09<02:29,  1.37it/s] 50%|█████     | 204/408 [03:10<02:55,  1.16it/s] 50%|█████     | 205/408 [03:10<02:40,  1.26it/s] 50%|█████     | 206/408 [03:11<02:35,  1.30it/s] 51%|█████     | 207/408 [03:12<02:39,  1.26it/s] 51%|█████     | 208/408 [03:13<03:02,  1.09it/s] 51%|█████     | 209/408 [03:14<03:06,  1.07it/s] 51%|█████▏    | 210/408 [03:15<02:50,  1.16it/s] 52%|█████▏    | 211/408 [03:15<02:35,  1.27it/s] 52%|█████▏    | 212/408 [03:17<03:04,  1.06it/s] 52%|█████▏    | 213/408 [03:18<03:40,  1.13s/it] 52%|█████▏    | 214/408 [03:20<03:55,  1.21s/it] 53%|█████▎    | 215/408 [03:20<03:26,  1.07s/it] 53%|█████▎    | 216/408 [03:21<03:14,  1.02s/it] 53%|█████▎    | 217/408 [03:23<03:23,  1.07s/it] 53%|█████▎    | 218/408 [03:23<03:08,  1.01it/s] 54%|█████▎    | 219/408 [03:25<03:39,  1.16s/it] 54%|█████▍    | 220/408 [03:26<03:32,  1.13s/it] 54%|█████▍    | 221/408 [03:27<03:36,  1.16s/it] 54%|█████▍    | 222/408 [03:28<02:50,  1.09it/s] 55%|█████▍    | 223/408 [03:29<03:18,  1.08s/it] 55%|█████▍    | 224/408 [03:30<03:31,  1.15s/it] 55%|█████▌    | 225/408 [03:31<03:19,  1.09s/it] 55%|█████▌    | 226/408 [03:32<02:59,  1.02it/s] 56%|█████▌    | 227/408 [03:33<03:08,  1.04s/it] 56%|█████▌    | 228/408 [03:34<02:44,  1.10it/s] 56%|█████▌    | 229/408 [03:35<02:33,  1.16it/s] 56%|█████▋    | 230/408 [03:35<02:18,  1.28it/s] 57%|█████▋    | 231/408 [03:36<01:55,  1.53it/s] 57%|█████▋    | 232/408 [03:36<01:58,  1.49it/s] 57%|█████▋    | 233/408 [03:37<02:00,  1.46it/s] 57%|█████▋    | 234/408 [03:38<02:08,  1.35it/s] 58%|█████▊    | 235/408 [03:38<01:53,  1.52it/s] 58%|█████▊    | 236/408 [03:39<01:50,  1.55it/s] 58%|█████▊    | 237/408 [03:40<01:53,  1.50it/s] 58%|█████▊    | 238/408 [03:41<02:32,  1.12it/s] 59%|█████▊    | 239/408 [03:42<02:49,  1.00s/it] 59%|█████▉    | 240/408 [03:43<02:44,  1.02it/s] 59%|█████▉    | 241/408 [03:44<02:13,  1.25it/s] 59%|█████▉    | 242/408 [03:44<02:09,  1.28it/s] 60%|█████▉    | 243/408 [03:45<02:19,  1.18it/s] 60%|█████▉    | 244/408 [03:46<02:32,  1.08it/s] 60%|██████    | 245/408 [03:47<02:26,  1.11it/s] 60%|██████    | 246/408 [03:48<02:18,  1.17it/s] 61%|██████    | 247/408 [03:49<02:10,  1.23it/s] 61%|██████    | 248/408 [03:49<01:54,  1.40it/s] 61%|██████    | 249/408 [03:50<01:53,  1.40it/s] 61%|██████▏   | 250/408 [03:51<01:59,  1.32it/s] 62%|██████▏   | 251/408 [03:52<01:56,  1.35it/s] 62%|██████▏   | 252/408 [03:53<02:15,  1.15it/s] 62%|██████▏   | 253/408 [03:53<02:08,  1.21it/s] 62%|██████▏   | 254/408 [03:55<02:22,  1.08it/s] 62%|██████▎   | 255/408 [03:55<02:13,  1.15it/s] 63%|██████▎   | 256/408 [03:56<02:11,  1.16it/s] 63%|██████▎   | 257/408 [03:57<02:08,  1.17it/s] 63%|██████▎   | 258/408 [03:58<02:02,  1.22it/s] 63%|██████▎   | 259/408 [03:59<02:12,  1.12it/s] 64%|██████▎   | 260/408 [04:00<02:05,  1.18it/s] 64%|██████▍   | 261/408 [04:01<02:29,  1.02s/it] 64%|██████▍   | 262/408 [04:04<03:49,  1.57s/it] 64%|██████▍   | 263/408 [04:04<02:55,  1.21s/it] 65%|██████▍   | 264/408 [04:05<02:42,  1.13s/it] 65%|██████▍   | 265/408 [04:06<02:28,  1.04s/it] 65%|██████▌   | 266/408 [04:07<02:25,  1.02s/it] 65%|██████▌   | 267/408 [04:08<02:27,  1.05s/it] 66%|██████▌   | 268/408 [04:09<02:16,  1.02it/s] 66%|██████▌   | 269/408 [04:09<01:59,  1.16it/s] 66%|██████▌   | 270/408 [04:10<01:52,  1.22it/s] 66%|██████▋   | 271/408 [04:11<01:43,  1.32it/s] 67%|██████▋   | 272/408 [04:11<01:41,  1.34it/s] 67%|██████▋   | 273/408 [04:13<02:04,  1.08it/s] 67%|██████▋   | 274/408 [04:14<01:55,  1.16it/s] 67%|██████▋   | 275/408 [04:14<01:48,  1.23it/s] 68%|██████▊   | 276/408 [04:15<01:58,  1.11it/s] 68%|██████▊   | 277/408 [04:16<01:56,  1.12it/s] 68%|██████▊   | 278/408 [04:18<02:13,  1.03s/it] 68%|██████▊   | 279/408 [04:18<01:56,  1.10it/s] 69%|██████▊   | 280/408 [04:19<01:48,  1.18it/s] 69%|██████▉   | 281/408 [04:20<01:43,  1.23it/s] 69%|██████▉   | 282/408 [04:20<01:29,  1.40it/s] 69%|██████▉   | 283/408 [04:21<01:27,  1.43it/s] 70%|██████▉   | 284/408 [04:22<01:33,  1.33it/s] 70%|██████▉   | 285/408 [04:22<01:36,  1.28it/s] 70%|███████   | 286/408 [04:24<01:46,  1.14it/s] 70%|███████   | 287/408 [04:24<01:40,  1.20it/s] 71%|███████   | 288/408 [04:25<01:35,  1.25it/s] 71%|███████   | 289/408 [04:26<01:35,  1.24it/s] 71%|███████   | 290/408 [04:26<01:27,  1.35it/s] 71%|███████▏  | 291/408 [04:28<01:46,  1.10it/s] 72%|███████▏  | 292/408 [04:29<02:09,  1.12s/it] 72%|███████▏  | 293/408 [04:32<02:47,  1.45s/it] 72%|███████▏  | 294/408 [04:32<02:25,  1.27s/it] 72%|███████▏  | 295/408 [04:33<02:14,  1.19s/it] 73%|███████▎  | 296/408 [04:34<01:57,  1.05s/it] 73%|███████▎  | 297/408 [04:35<02:01,  1.09s/it] 73%|███████▎  | 298/408 [04:36<01:48,  1.01it/s] 73%|███████▎  | 299/408 [04:37<01:39,  1.10it/s] 74%|███████▎  | 300/408 [04:37<01:24,  1.28it/s] 74%|███████▍  | 301/408 [04:38<01:21,  1.31it/s] 74%|███████▍  | 302/408 [04:39<01:35,  1.11it/s] 74%|███████▍  | 303/408 [04:40<01:33,  1.13it/s] 75%|███████▍  | 304/408 [04:41<01:34,  1.10it/s] 75%|███████▍  | 305/408 [04:42<01:28,  1.16it/s] 75%|███████▌  | 306/408 [04:43<01:27,  1.17it/s] 75%|███████▌  | 307/408 [04:44<01:38,  1.03it/s] 75%|███████▌  | 308/408 [04:45<01:33,  1.07it/s] 76%|███████▌  | 309/408 [04:46<01:33,  1.06it/s] 76%|███████▌  | 310/408 [04:46<01:22,  1.19it/s] 76%|███████▌  | 311/408 [04:48<01:35,  1.01it/s] 76%|███████▋  | 312/408 [04:48<01:16,  1.25it/s] 77%|███████▋  | 313/408 [04:49<01:30,  1.05it/s] 77%|███████▋  | 314/408 [04:51<01:40,  1.07s/it] 77%|███████▋  | 315/408 [04:51<01:32,  1.00it/s] 77%|███████▋  | 316/408 [04:52<01:31,  1.01it/s] 78%|███████▊  | 317/408 [04:53<01:19,  1.14it/s] 78%|███████▊  | 318/408 [04:54<01:26,  1.03it/s] 78%|███████▊  | 319/408 [04:55<01:16,  1.16it/s] 78%|███████▊  | 320/408 [04:56<01:32,  1.06s/it] 79%|███████▊  | 321/408 [04:57<01:17,  1.13it/s] 79%|███████▉  | 322/408 [04:58<01:15,  1.14it/s] 79%|███████▉  | 323/408 [04:58<01:07,  1.27it/s] 79%|███████▉  | 324/408 [04:59<01:08,  1.23it/s] 80%|███████▉  | 325/408 [05:00<01:02,  1.33it/s] 80%|███████▉  | 326/408 [05:00<00:55,  1.48it/s] 80%|████████  | 327/408 [05:02<01:18,  1.03it/s] 80%|████████  | 328/408 [05:02<01:05,  1.22it/s] 81%|████████  | 329/408 [05:03<01:08,  1.16it/s] 81%|████████  | 330/408 [05:04<00:58,  1.32it/s] 81%|████████  | 331/408 [05:05<00:56,  1.35it/s] 81%|████████▏ | 332/408 [05:06<01:02,  1.22it/s] 82%|████████▏ | 333/408 [05:06<01:01,  1.22it/s] 82%|████████▏ | 334/408 [05:08<01:07,  1.10it/s] 82%|████████▏ | 335/408 [05:08<01:01,  1.18it/s] 82%|████████▏ | 336/408 [05:09<00:56,  1.28it/s] 83%|████████▎ | 337/408 [05:10<01:12,  1.03s/it] 83%|████████▎ | 338/408 [05:11<01:07,  1.04it/s] 83%|████████▎ | 339/408 [05:12<01:01,  1.12it/s] 83%|████████▎ | 340/408 [05:13<01:01,  1.10it/s] 84%|████████▎ | 341/408 [05:14<01:04,  1.05it/s] 84%|████████▍ | 342/408 [05:15<01:07,  1.02s/it] 84%|████████▍ | 343/408 [05:16<00:58,  1.12it/s] 84%|████████▍ | 344/408 [05:17<01:01,  1.04it/s] 85%|████████▍ | 345/408 [05:18<00:59,  1.06it/s] 85%|████████▍ | 346/408 [05:19<00:56,  1.10it/s] 85%|████████▌ | 347/408 [05:19<00:54,  1.12it/s] 85%|████████▌ | 348/408 [05:21<00:59,  1.01it/s] 86%|████████▌ | 349/408 [05:22<00:57,  1.03it/s] 86%|████████▌ | 350/408 [05:22<00:53,  1.08it/s] 86%|████████▌ | 351/408 [05:23<00:51,  1.11it/s] 86%|████████▋ | 352/408 [05:24<00:49,  1.14it/s] 87%|████████▋ | 353/408 [05:25<00:41,  1.31it/s] 87%|████████▋ | 354/408 [05:26<00:51,  1.05it/s] 87%|████████▋ | 355/408 [05:26<00:41,  1.28it/s] 87%|████████▋ | 356/408 [05:27<00:37,  1.39it/s] 88%|████████▊ | 357/408 [05:28<00:36,  1.39it/s] 88%|████████▊ | 358/408 [05:29<00:48,  1.03it/s] 88%|████████▊ | 359/408 [05:30<00:45,  1.08it/s] 88%|████████▊ | 360/408 [05:31<00:37,  1.27it/s] 88%|████████▊ | 361/408 [05:32<00:44,  1.05it/s] 89%|████████▊ | 362/408 [05:33<00:42,  1.09it/s] 89%|████████▉ | 363/408 [05:34<00:42,  1.07it/s] 89%|████████▉ | 364/408 [05:34<00:36,  1.20it/s] 89%|████████▉ | 365/408 [05:35<00:34,  1.26it/s] 90%|████████▉ | 366/408 [05:35<00:29,  1.42it/s] 90%|████████▉ | 367/408 [05:36<00:27,  1.47it/s] 90%|█████████ | 368/408 [05:37<00:27,  1.45it/s] 90%|█████████ | 369/408 [05:38<00:30,  1.29it/s] 91%|█████████ | 370/408 [05:39<00:32,  1.15it/s] 91%|█████████ | 371/408 [05:39<00:29,  1.27it/s] 91%|█████████ | 372/408 [05:41<00:32,  1.10it/s] 91%|█████████▏| 373/408 [05:42<00:33,  1.05it/s] 92%|█████████▏| 374/408 [05:43<00:41,  1.21s/it] 92%|█████████▏| 375/408 [05:44<00:34,  1.06s/it] 92%|█████████▏| 376/408 [05:45<00:33,  1.05s/it] 92%|█████████▏| 377/408 [05:46<00:31,  1.01s/it] 93%|█████████▎| 378/408 [05:47<00:29,  1.00it/s] 93%|█████████▎| 379/408 [05:48<00:28,  1.01it/s] 93%|█████████▎| 380/408 [05:49<00:28,  1.01s/it] 93%|█████████▎| 381/408 [05:50<00:26,  1.00it/s] 94%|█████████▎| 382/408 [05:51<00:27,  1.07s/it] 94%|█████████▍| 383/408 [05:52<00:25,  1.03s/it] 94%|█████████▍| 384/408 [05:54<00:26,  1.10s/it] 94%|█████████▍| 385/408 [05:55<00:26,  1.13s/it] 95%|█████████▍| 386/408 [05:56<00:25,  1.15s/it] 95%|█████████▍| 387/408 [05:57<00:21,  1.03s/it] 95%|█████████▌| 388/408 [05:57<00:18,  1.07it/s] 95%|█████████▌| 389/408 [05:58<00:17,  1.11it/s] 96%|█████████▌| 390/408 [05:59<00:15,  1.16it/s] 96%|█████████▌| 391/408 [06:00<00:15,  1.07it/s] 96%|█████████▌| 392/408 [06:02<00:17,  1.11s/it] 96%|█████████▋| 393/408 [06:02<00:14,  1.05it/s] 97%|█████████▋| 394/408 [06:03<00:13,  1.05it/s] 97%|█████████▋| 395/408 [06:04<00:11,  1.17it/s] 97%|█████████▋| 396/408 [06:05<00:09,  1.22it/s] 97%|█████████▋| 397/408 [06:05<00:09,  1.21it/s] 98%|█████████▊| 398/408 [06:06<00:08,  1.14it/s] 98%|█████████▊| 399/408 [06:07<00:08,  1.10it/s] 98%|█████████▊| 400/408 [06:08<00:07,  1.07it/s] 98%|█████████▊| 401/408 [06:09<00:06,  1.10it/s] 99%|█████████▊| 402/408 [06:10<00:05,  1.04it/s] 99%|█████████▉| 403/408 [06:11<00:03,  1.28it/s] 99%|█████████▉| 404/408 [06:12<00:03,  1.20it/s] 99%|█████████▉| 405/408 [06:13<00:02,  1.01it/s]100%|█████████▉| 406/408 [06:14<00:01,  1.01it/s]100%|█████████▉| 407/408 [06:15<00:00,  1.10it/s]100%|██████████| 408/408 [06:15<00:00,  1.17it/s]100%|██████████| 408/408 [06:15<00:00,  1.09it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 272.38it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-837e1ed28f8d413e.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-47f3fbde32afc117.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:06, 14.27it/s]  4%|▍         | 4/100 [00:00<00:06, 15.70it/s]  6%|▌         | 6/100 [00:00<00:05, 16.40it/s]  8%|▊         | 8/100 [00:00<00:05, 16.75it/s] 10%|█         | 10/100 [00:00<00:05, 16.94it/s] 12%|█▏        | 12/100 [00:00<00:05, 17.05it/s] 14%|█▍        | 14/100 [00:00<00:05, 17.14it/s] 16%|█▌        | 16/100 [00:00<00:04, 17.21it/s] 18%|█▊        | 18/100 [00:01<00:04, 17.24it/s] 20%|██        | 20/100 [00:01<00:04, 17.26it/s] 22%|██▏       | 22/100 [00:01<00:04, 17.28it/s] 24%|██▍       | 24/100 [00:01<00:04, 17.29it/s] 26%|██▌       | 26/100 [00:01<00:04, 17.30it/s] 28%|██▊       | 28/100 [00:01<00:04, 17.30it/s] 30%|███       | 30/100 [00:01<00:04, 17.30it/s] 32%|███▏      | 32/100 [00:01<00:03, 17.32it/s] 34%|███▍      | 34/100 [00:01<00:03, 17.31it/s] 36%|███▌      | 36/100 [00:02<00:03, 17.31it/s] 38%|███▊      | 38/100 [00:02<00:03, 17.31it/s] 40%|████      | 40/100 [00:02<00:03, 17.31it/s] 42%|████▏     | 42/100 [00:02<00:03, 17.32it/s] 44%|████▍     | 44/100 [00:02<00:03, 17.31it/s] 46%|████▌     | 46/100 [00:02<00:03, 17.31it/s] 48%|████▊     | 48/100 [00:02<00:03, 17.32it/s] 50%|█████     | 50/100 [00:02<00:02, 17.27it/s] 52%|█████▏    | 52/100 [00:03<00:02, 17.28it/s] 54%|█████▍    | 54/100 [00:03<00:02, 17.29it/s] 56%|█████▌    | 56/100 [00:03<00:02, 17.29it/s] 58%|█████▊    | 58/100 [00:03<00:02, 17.30it/s] 60%|██████    | 60/100 [00:03<00:02, 17.31it/s] 62%|██████▏   | 62/100 [00:03<00:02, 17.31it/s] 64%|██████▍   | 64/100 [00:03<00:02, 17.31it/s] 66%|██████▌   | 66/100 [00:03<00:01, 17.30it/s] 68%|██████▊   | 68/100 [00:03<00:01, 17.30it/s] 70%|███████   | 70/100 [00:04<00:01, 17.30it/s] 72%|███████▏  | 72/100 [00:04<00:01, 17.30it/s] 74%|███████▍  | 74/100 [00:04<00:01, 17.30it/s] 76%|███████▌  | 76/100 [00:04<00:01, 17.31it/s] 78%|███████▊  | 78/100 [00:04<00:01, 17.31it/s] 80%|████████  | 80/100 [00:04<00:01, 17.31it/s] 82%|████████▏ | 82/100 [00:04<00:01, 17.29it/s] 84%|████████▍ | 84/100 [00:04<00:00, 17.29it/s] 86%|████████▌ | 86/100 [00:04<00:00, 17.30it/s] 88%|████████▊ | 88/100 [00:05<00:00, 17.30it/s] 90%|█████████ | 90/100 [00:05<00:00, 17.30it/s] 92%|█████████▏| 92/100 [00:05<00:00, 17.30it/s] 94%|█████████▍| 94/100 [00:05<00:00, 17.31it/s] 96%|█████████▌| 96/100 [00:05<00:00, 17.28it/s] 98%|█████████▊| 98/100 [00:05<00:00, 17.28it/s]100%|██████████| 100/100 [00:05<00:00, 17.29it/s]100%|██████████| 100/100 [00:05<00:00, 17.22it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 358.92it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-43cd03e2ec313250.arrow
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (11896 > 2048). Running this sequence through the model will result in indexing errors
Map:   4%|▍         | 4/100 [00:00<00:03, 27.98 examples/s]Map:  19%|█▉        | 19/100 [00:00<00:00, 88.64 examples/s]Map:  33%|███▎      | 33/100 [00:00<00:00, 102.12 examples/s]Map:  44%|████▍     | 44/100 [00:00<00:00, 103.39 examples/s]Map:  63%|██████▎   | 63/100 [00:00<00:00, 127.34 examples/s]Map:  83%|████████▎ | 83/100 [00:00<00:00, 145.63 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.90it/s]  2%|▏         | 2/100 [00:00<00:11,  8.29it/s]  3%|▎         | 3/100 [00:00<00:11,  8.38it/s]  4%|▍         | 4/100 [00:00<00:11,  8.37it/s]  5%|▌         | 5/100 [00:00<00:11,  8.32it/s]  6%|▌         | 6/100 [00:00<00:11,  8.26it/s]  7%|▋         | 7/100 [00:00<00:11,  8.23it/s]  8%|▊         | 8/100 [00:00<00:11,  8.20it/s]  9%|▉         | 9/100 [00:01<00:11,  8.16it/s] 10%|█         | 10/100 [00:01<00:11,  8.13it/s] 11%|█         | 11/100 [00:01<00:10,  8.11it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.10it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.10it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.10it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.09it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.06it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.06it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.06it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.07it/s] 20%|██        | 20/100 [00:02<00:09,  8.06it/s] 21%|██        | 21/100 [00:02<00:09,  8.06it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.07it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.08it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.08it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.08it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.08it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.08it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.08it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.08it/s] 30%|███       | 30/100 [00:03<00:08,  8.08it/s] 31%|███       | 31/100 [00:03<00:08,  8.06it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.06it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.07it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.08it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.07it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.07it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.08it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.09it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.09it/s] 40%|████      | 40/100 [00:04<00:07,  8.08it/s] 41%|████      | 41/100 [00:05<00:07,  8.08it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.08it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.09it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.09it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.08it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.07it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.08it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.08it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.09it/s] 50%|█████     | 50/100 [00:06<00:06,  8.08it/s] 51%|█████     | 51/100 [00:06<00:06,  8.08it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.08it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.08it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.08it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.07it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.07it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.08it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.06it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.06it/s] 60%|██████    | 60/100 [00:07<00:04,  8.06it/s] 61%|██████    | 61/100 [00:07<00:04,  8.06it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.07it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.08it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.08it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.08it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.08it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.08it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.08it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.08it/s] 70%|███████   | 70/100 [00:08<00:03,  8.08it/s] 71%|███████   | 71/100 [00:08<00:03,  8.08it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.09it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.08it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.08it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.08it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.06it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.08it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.08it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.08it/s] 80%|████████  | 80/100 [00:09<00:02,  8.08it/s] 81%|████████  | 81/100 [00:10<00:02,  8.08it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.08it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.08it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.08it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.08it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.07it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.08it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.08it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.08it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.08it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.07it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.08it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.08it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.09it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.08it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.08it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.08it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.08it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.09it/s]100%|██████████| 100/100 [00:12<00:00,  8.08it/s]100%|██████████| 100/100 [00:12<00:00,  8.09it/s]
FOLD 1
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.296569  0.557555  4.943984     2.940423
[0.27786867 0.54799188 5.29910156 3.30077534]
MC1 Score: 0.2778686658037298, MC2 Score: 0.5479918831426852, CE Loss: 5.299101562500001, KL wrt Original: 3.3007753396034243
2023-11-01 13:18:13.566869: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 13:18:13.615990: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 13:18:14.355050: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 367.95it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.99it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.38it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.31it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 453.68it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.14it/s]  6%|▋         | 2/32 [00:00<00:13,  2.15it/s]  9%|▉         | 3/32 [00:01<00:14,  2.05it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.04it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.97it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.91it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.88it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.86it/s] 28%|██▊       | 9/32 [00:04<00:12,  1.78it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.63it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.60it/s] 41%|████      | 13/32 [00:07<00:12,  1.58it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.57it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.53it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.51it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.48it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.42it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.45it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.43it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.41it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.45it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.47it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.50it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.52it/s]100%|██████████| 32/32 [00:20<00:00,  1.41it/s]100%|██████████| 32/32 [00:20<00:00,  1.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.57457627 0.58305085 0.57457627 ... 0.57457627 0.57457627 0.57457627]
 [0.57457627 0.57457627 0.57457627 ... 0.61016949 0.57288136 0.57457627]
 [0.57457627 0.60169492 0.72033898 ... 0.63220339 0.57457627 0.64915254]
 ...
 [0.71864407 0.58305085 0.58474576 ... 0.62372881 0.57966102 0.57627119]
 [0.71525424 0.58644068 0.58813559 ... 0.58644068 0.68305085 0.57457627]
 [0.62881356 0.6559322  0.72711864 ... 0.64745763 0.68813559 0.68135593]]
Heads intervened:  [(7, 5), (7, 14), (9, 1), (9, 20), (10, 1), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 19), (11, 21), (11, 29), (12, 25), (13, 11), (13, 16), (13, 18), (13, 22), (13, 23), (14, 0), (14, 5), (14, 12), (14, 18), (14, 22), (15, 20), (15, 24), (15, 28), (16, 2), (16, 10), (16, 11), (16, 13), (16, 25), (17, 1), (17, 21), (17, 31), (18, 0), (18, 9), (18, 17), (20, 19), (20, 21), (21, 22), (21, 29), (22, 4), (22, 13), (23, 18), (30, 22), (31, 19)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/409 [00:00<?, ?it/s]  0%|          | 1/409 [00:01<09:07,  1.34s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 2/409 [00:02<07:44,  1.14s/it]  1%|          | 3/409 [00:03<06:20,  1.07it/s]  1%|          | 4/409 [00:03<06:08,  1.10it/s]  1%|          | 5/409 [00:04<06:31,  1.03it/s]  1%|▏         | 6/409 [00:06<06:47,  1.01s/it]  2%|▏         | 7/409 [00:06<05:52,  1.14it/s]  2%|▏         | 8/409 [00:08<07:14,  1.08s/it]  2%|▏         | 9/409 [00:10<08:43,  1.31s/it]  2%|▏         | 10/409 [00:10<07:57,  1.20s/it]  3%|▎         | 11/409 [00:11<07:12,  1.09s/it]  3%|▎         | 12/409 [00:12<06:12,  1.07it/s]  3%|▎         | 13/409 [00:12<05:30,  1.20it/s]  3%|▎         | 14/409 [00:13<05:04,  1.30it/s]  4%|▎         | 15/409 [00:14<05:26,  1.21it/s]  4%|▍         | 16/409 [00:15<05:30,  1.19it/s]  4%|▍         | 17/409 [00:16<06:09,  1.06it/s]  4%|▍         | 18/409 [00:17<06:50,  1.05s/it]  5%|▍         | 19/409 [00:18<06:11,  1.05it/s]  5%|▍         | 20/409 [00:19<06:27,  1.00it/s]  5%|▌         | 21/409 [00:20<05:57,  1.08it/s]  5%|▌         | 22/409 [00:21<06:43,  1.04s/it]  6%|▌         | 23/409 [00:22<06:57,  1.08s/it]  6%|▌         | 24/409 [00:23<06:25,  1.00s/it]  6%|▌         | 25/409 [00:25<06:48,  1.06s/it]  6%|▋         | 26/409 [00:26<07:03,  1.11s/it]  7%|▋         | 27/409 [00:27<06:31,  1.03s/it]  7%|▋         | 28/409 [00:28<07:27,  1.18s/it]  7%|▋         | 29/409 [00:29<07:29,  1.18s/it]  7%|▋         | 30/409 [00:30<06:39,  1.05s/it]  8%|▊         | 31/409 [00:31<06:25,  1.02s/it]  8%|▊         | 32/409 [00:32<06:19,  1.01s/it]  8%|▊         | 33/409 [00:33<06:46,  1.08s/it]  8%|▊         | 34/409 [00:34<05:51,  1.07it/s]  9%|▊         | 35/409 [00:35<06:06,  1.02it/s]  9%|▉         | 36/409 [00:36<06:02,  1.03it/s]  9%|▉         | 37/409 [00:36<05:21,  1.16it/s]  9%|▉         | 38/409 [00:37<05:04,  1.22it/s] 10%|▉         | 39/409 [00:38<05:04,  1.21it/s] 10%|▉         | 40/409 [00:39<04:52,  1.26it/s] 10%|█         | 41/409 [00:40<05:59,  1.02it/s] 10%|█         | 42/409 [00:41<05:41,  1.07it/s] 11%|█         | 43/409 [00:42<05:32,  1.10it/s] 11%|█         | 44/409 [00:43<05:47,  1.05it/s] 11%|█         | 45/409 [00:44<06:02,  1.00it/s] 11%|█         | 46/409 [00:45<06:13,  1.03s/it] 11%|█▏        | 47/409 [00:46<05:25,  1.11it/s] 12%|█▏        | 48/409 [00:47<05:32,  1.09it/s] 12%|█▏        | 49/409 [00:48<06:14,  1.04s/it] 12%|█▏        | 50/409 [00:49<05:52,  1.02it/s] 12%|█▏        | 51/409 [00:50<06:26,  1.08s/it] 13%|█▎        | 52/409 [00:51<06:29,  1.09s/it] 13%|█▎        | 53/409 [00:52<05:23,  1.10it/s] 13%|█▎        | 54/409 [00:53<05:30,  1.07it/s] 13%|█▎        | 55/409 [00:53<04:53,  1.21it/s] 14%|█▎        | 56/409 [00:54<04:39,  1.26it/s] 14%|█▍        | 57/409 [00:55<04:55,  1.19it/s] 14%|█▍        | 58/409 [00:56<05:58,  1.02s/it] 14%|█▍        | 59/409 [00:57<05:18,  1.10it/s] 15%|█▍        | 60/409 [00:58<05:34,  1.04it/s] 15%|█▍        | 61/409 [00:58<04:30,  1.29it/s] 15%|█▌        | 62/409 [00:59<04:10,  1.39it/s] 15%|█▌        | 63/409 [01:00<05:23,  1.07it/s] 16%|█▌        | 64/409 [01:01<04:09,  1.38it/s] 16%|█▌        | 65/409 [01:01<03:44,  1.53it/s] 16%|█▌        | 66/409 [01:03<05:04,  1.12it/s] 16%|█▋        | 67/409 [01:04<06:02,  1.06s/it] 17%|█▋        | 68/409 [01:05<05:02,  1.13it/s] 17%|█▋        | 69/409 [01:05<04:57,  1.14it/s] 17%|█▋        | 70/409 [01:06<05:03,  1.12it/s] 17%|█▋        | 71/409 [01:07<04:44,  1.19it/s] 18%|█▊        | 72/409 [01:08<05:29,  1.02it/s] 18%|█▊        | 73/409 [01:09<05:28,  1.02it/s] 18%|█▊        | 74/409 [01:10<05:02,  1.11it/s] 18%|█▊        | 75/409 [01:11<05:51,  1.05s/it] 19%|█▊        | 76/409 [01:13<05:55,  1.07s/it] 19%|█▉        | 77/409 [01:14<05:42,  1.03s/it] 19%|█▉        | 78/409 [01:14<05:23,  1.02it/s] 19%|█▉        | 79/409 [01:16<05:47,  1.05s/it] 20%|█▉        | 80/409 [01:16<05:09,  1.06it/s] 20%|█▉        | 81/409 [01:17<05:12,  1.05it/s] 20%|██        | 82/409 [01:18<05:01,  1.08it/s] 20%|██        | 83/409 [01:19<04:42,  1.15it/s] 21%|██        | 84/409 [01:20<04:41,  1.16it/s] 21%|██        | 85/409 [01:21<05:00,  1.08it/s] 21%|██        | 86/409 [01:22<04:53,  1.10it/s] 21%|██▏       | 87/409 [01:23<05:08,  1.04it/s] 22%|██▏       | 88/409 [01:24<05:44,  1.07s/it] 22%|██▏       | 89/409 [01:25<04:59,  1.07it/s] 22%|██▏       | 90/409 [01:25<04:38,  1.14it/s] 22%|██▏       | 91/409 [01:27<05:09,  1.03it/s] 22%|██▏       | 92/409 [01:27<04:32,  1.16it/s] 23%|██▎       | 93/409 [01:28<04:17,  1.23it/s] 23%|██▎       | 94/409 [01:28<03:45,  1.40it/s] 23%|██▎       | 95/409 [01:29<04:08,  1.26it/s] 23%|██▎       | 96/409 [01:30<04:21,  1.20it/s] 24%|██▎       | 97/409 [01:31<04:20,  1.20it/s] 24%|██▍       | 98/409 [01:32<04:09,  1.25it/s] 24%|██▍       | 99/409 [01:33<03:59,  1.30it/s] 24%|██▍       | 100/409 [01:33<03:52,  1.33it/s] 25%|██▍       | 101/409 [01:34<04:21,  1.18it/s] 25%|██▍       | 102/409 [01:35<04:22,  1.17it/s] 25%|██▌       | 103/409 [01:36<04:43,  1.08it/s] 25%|██▌       | 104/409 [01:37<04:46,  1.06it/s] 26%|██▌       | 105/409 [01:38<04:38,  1.09it/s] 26%|██▌       | 106/409 [01:39<04:29,  1.12it/s] 26%|██▌       | 107/409 [01:39<03:41,  1.36it/s] 26%|██▋       | 108/409 [01:40<03:28,  1.44it/s] 27%|██▋       | 109/409 [01:41<03:29,  1.43it/s] 27%|██▋       | 110/409 [01:41<03:29,  1.42it/s] 27%|██▋       | 111/409 [01:42<04:02,  1.23it/s] 27%|██▋       | 112/409 [01:43<04:07,  1.20it/s] 28%|██▊       | 113/409 [01:45<04:41,  1.05it/s] 28%|██▊       | 114/409 [01:45<04:21,  1.13it/s] 28%|██▊       | 115/409 [01:46<04:27,  1.10it/s] 28%|██▊       | 116/409 [01:48<05:14,  1.07s/it] 29%|██▊       | 117/409 [01:49<05:25,  1.11s/it] 29%|██▉       | 118/409 [01:49<04:29,  1.08it/s] 29%|██▉       | 119/409 [01:50<04:30,  1.07it/s] 29%|██▉       | 120/409 [01:51<04:32,  1.06it/s] 30%|██▉       | 121/409 [01:52<04:32,  1.06it/s] 30%|██▉       | 122/409 [01:54<05:23,  1.13s/it] 30%|███       | 123/409 [01:55<04:48,  1.01s/it] 30%|███       | 124/409 [01:55<04:32,  1.04it/s] 31%|███       | 125/409 [01:56<04:22,  1.08it/s] 31%|███       | 126/409 [01:57<04:06,  1.15it/s] 31%|███       | 127/409 [01:58<04:03,  1.16it/s] 31%|███▏      | 128/409 [01:59<03:51,  1.21it/s] 32%|███▏      | 129/409 [02:00<04:04,  1.15it/s] 32%|███▏      | 130/409 [02:00<03:49,  1.21it/s] 32%|███▏      | 131/409 [02:01<03:30,  1.32it/s] 32%|███▏      | 132/409 [02:02<03:25,  1.35it/s] 33%|███▎      | 133/409 [02:02<03:11,  1.44it/s] 33%|███▎      | 134/409 [02:03<03:43,  1.23it/s] 33%|███▎      | 135/409 [02:04<03:46,  1.21it/s] 33%|███▎      | 136/409 [02:05<03:26,  1.32it/s] 33%|███▎      | 137/409 [02:06<03:44,  1.21it/s] 34%|███▎      | 138/409 [02:07<04:17,  1.05it/s] 34%|███▍      | 139/409 [02:08<04:46,  1.06s/it] 34%|███▍      | 140/409 [02:09<03:59,  1.12it/s] 34%|███▍      | 141/409 [02:09<03:25,  1.30it/s] 35%|███▍      | 142/409 [02:10<03:11,  1.39it/s] 35%|███▍      | 143/409 [02:11<04:17,  1.03it/s] 35%|███▌      | 144/409 [02:13<04:36,  1.04s/it] 35%|███▌      | 145/409 [02:14<04:28,  1.02s/it] 36%|███▌      | 146/409 [02:14<04:05,  1.07it/s] 36%|███▌      | 147/409 [02:15<04:08,  1.05it/s] 36%|███▌      | 148/409 [02:16<03:49,  1.14it/s] 36%|███▋      | 149/409 [02:17<03:45,  1.15it/s] 37%|███▋      | 150/409 [02:18<03:41,  1.17it/s] 37%|███▋      | 151/409 [02:18<03:29,  1.23it/s] 37%|███▋      | 152/409 [02:19<03:47,  1.13it/s] 37%|███▋      | 153/409 [02:20<03:52,  1.10it/s] 38%|███▊      | 154/409 [02:21<03:10,  1.34it/s] 38%|███▊      | 155/409 [02:21<02:50,  1.49it/s] 38%|███▊      | 156/409 [02:22<03:10,  1.33it/s] 38%|███▊      | 157/409 [02:23<03:07,  1.34it/s] 39%|███▊      | 158/409 [02:24<03:13,  1.30it/s] 39%|███▉      | 159/409 [02:25<03:38,  1.14it/s] 39%|███▉      | 160/409 [02:26<03:43,  1.11it/s] 39%|███▉      | 161/409 [02:27<04:07,  1.00it/s] 40%|███▉      | 162/409 [02:28<03:45,  1.10it/s] 40%|███▉      | 163/409 [02:30<05:25,  1.32s/it] 40%|████      | 164/409 [02:31<05:00,  1.22s/it] 40%|████      | 165/409 [02:32<05:02,  1.24s/it] 41%|████      | 166/409 [02:33<04:51,  1.20s/it] 41%|████      | 167/409 [02:34<04:31,  1.12s/it] 41%|████      | 168/409 [02:36<04:52,  1.21s/it] 41%|████▏     | 169/409 [02:37<04:57,  1.24s/it] 42%|████▏     | 170/409 [02:38<04:36,  1.16s/it] 42%|████▏     | 171/409 [02:39<04:12,  1.06s/it] 42%|████▏     | 172/409 [02:40<04:21,  1.11s/it] 42%|████▏     | 173/409 [02:41<03:53,  1.01it/s] 43%|████▎     | 174/409 [02:42<03:50,  1.02it/s] 43%|████▎     | 175/409 [02:43<04:14,  1.09s/it] 43%|████▎     | 176/409 [02:44<03:38,  1.07it/s] 43%|████▎     | 177/409 [02:45<04:03,  1.05s/it] 44%|████▎     | 178/409 [02:46<03:48,  1.01it/s] 44%|████▍     | 179/409 [02:47<04:04,  1.06s/it] 44%|████▍     | 180/409 [02:48<03:40,  1.04it/s] 44%|████▍     | 181/409 [02:48<03:16,  1.16it/s] 44%|████▍     | 182/409 [02:49<03:05,  1.22it/s] 45%|████▍     | 183/409 [02:50<02:59,  1.26it/s] 45%|████▍     | 184/409 [02:51<03:01,  1.24it/s] 45%|████▌     | 185/409 [02:52<03:19,  1.13it/s] 45%|████▌     | 186/409 [02:53<03:38,  1.02it/s] 46%|████▌     | 187/409 [02:54<03:36,  1.02it/s] 46%|████▌     | 188/409 [02:55<03:19,  1.11it/s] 46%|████▌     | 189/409 [02:55<03:04,  1.19it/s] 46%|████▋     | 190/409 [02:56<03:04,  1.19it/s] 47%|████▋     | 191/409 [02:57<03:02,  1.19it/s] 47%|████▋     | 192/409 [02:58<03:09,  1.14it/s] 47%|████▋     | 193/409 [02:59<03:14,  1.11it/s] 47%|████▋     | 194/409 [03:00<03:03,  1.17it/s] 48%|████▊     | 195/409 [03:01<03:08,  1.14it/s] 48%|████▊     | 196/409 [03:02<03:19,  1.07it/s] 48%|████▊     | 197/409 [03:03<03:42,  1.05s/it] 48%|████▊     | 198/409 [03:04<03:36,  1.03s/it] 49%|████▊     | 199/409 [03:05<03:08,  1.12it/s] 49%|████▉     | 200/409 [03:06<03:18,  1.05it/s] 49%|████▉     | 201/409 [03:06<03:02,  1.14it/s] 49%|████▉     | 202/409 [03:07<03:05,  1.11it/s] 50%|████▉     | 203/409 [03:08<02:39,  1.29it/s] 50%|████▉     | 204/409 [03:09<02:43,  1.25it/s] 50%|█████     | 205/409 [03:10<03:25,  1.01s/it] 50%|█████     | 206/409 [03:11<02:58,  1.14it/s] 51%|█████     | 207/409 [03:12<03:02,  1.11it/s] 51%|█████     | 208/409 [03:12<02:51,  1.18it/s] 51%|█████     | 209/409 [03:13<02:42,  1.23it/s] 51%|█████▏    | 210/409 [03:14<02:50,  1.16it/s] 52%|█████▏    | 211/409 [03:15<02:34,  1.28it/s] 52%|█████▏    | 212/409 [03:15<02:22,  1.38it/s] 52%|█████▏    | 213/409 [03:16<02:43,  1.20it/s] 52%|█████▏    | 214/409 [03:18<02:57,  1.10it/s] 53%|█████▎    | 215/409 [03:18<02:45,  1.17it/s] 53%|█████▎    | 216/409 [03:21<04:09,  1.29s/it] 53%|█████▎    | 217/409 [03:21<03:28,  1.08s/it] 53%|█████▎    | 218/409 [03:22<02:52,  1.11it/s] 54%|█████▎    | 219/409 [03:22<02:42,  1.17it/s] 54%|█████▍    | 220/409 [03:23<02:33,  1.23it/s] 54%|█████▍    | 221/409 [03:24<02:27,  1.27it/s] 54%|█████▍    | 222/409 [03:25<02:30,  1.24it/s] 55%|█████▍    | 223/409 [03:26<02:32,  1.22it/s] 55%|█████▍    | 224/409 [03:26<02:33,  1.21it/s] 55%|█████▌    | 225/409 [03:27<02:20,  1.31it/s] 55%|█████▌    | 226/409 [03:28<02:25,  1.26it/s] 56%|█████▌    | 227/409 [03:28<02:13,  1.36it/s] 56%|█████▌    | 228/409 [03:30<02:39,  1.14it/s] 56%|█████▌    | 229/409 [03:30<02:16,  1.32it/s] 56%|█████▌    | 230/409 [03:31<02:21,  1.27it/s] 56%|█████▋    | 231/409 [03:32<02:24,  1.23it/s] 57%|█████▋    | 232/409 [03:33<02:43,  1.09it/s] 57%|█████▋    | 233/409 [03:34<02:32,  1.16it/s] 57%|█████▋    | 234/409 [03:34<02:23,  1.22it/s] 57%|█████▋    | 235/409 [03:35<02:11,  1.33it/s] 58%|█████▊    | 236/409 [03:36<02:14,  1.29it/s] 58%|█████▊    | 237/409 [03:36<01:58,  1.45it/s] 58%|█████▊    | 238/409 [03:38<02:24,  1.18it/s] 58%|█████▊    | 239/409 [03:40<03:21,  1.18s/it] 59%|█████▊    | 240/409 [03:40<02:57,  1.05s/it] 59%|█████▉    | 241/409 [03:41<02:45,  1.02it/s] 59%|█████▉    | 242/409 [03:42<02:57,  1.06s/it] 59%|█████▉    | 243/409 [03:43<02:40,  1.04it/s] 60%|█████▉    | 244/409 [03:44<02:57,  1.07s/it] 60%|█████▉    | 245/409 [03:45<02:33,  1.07it/s] 60%|██████    | 246/409 [03:46<02:09,  1.25it/s] 60%|██████    | 247/409 [03:47<02:17,  1.18it/s] 61%|██████    | 248/409 [03:47<02:17,  1.17it/s] 61%|██████    | 249/409 [03:48<02:10,  1.23it/s] 61%|██████    | 250/409 [03:49<02:16,  1.17it/s] 61%|██████▏   | 251/409 [03:51<03:08,  1.19s/it] 62%|██████▏   | 252/409 [03:52<02:50,  1.09s/it] 62%|██████▏   | 253/409 [03:53<03:00,  1.16s/it] 62%|██████▏   | 254/409 [03:54<02:44,  1.06s/it] 62%|██████▏   | 255/409 [03:55<02:49,  1.10s/it] 63%|██████▎   | 256/409 [03:56<02:36,  1.03s/it] 63%|██████▎   | 257/409 [03:57<02:32,  1.00s/it] 63%|██████▎   | 258/409 [03:58<02:07,  1.18it/s] 63%|██████▎   | 259/409 [03:58<02:07,  1.18it/s] 64%|██████▎   | 260/409 [04:00<02:27,  1.01it/s] 64%|██████▍   | 261/409 [04:01<02:25,  1.01it/s] 64%|██████▍   | 262/409 [04:01<02:02,  1.20it/s] 64%|██████▍   | 263/409 [04:02<02:08,  1.14it/s] 65%|██████▍   | 264/409 [04:03<01:50,  1.32it/s] 65%|██████▍   | 265/409 [04:03<01:47,  1.33it/s] 65%|██████▌   | 266/409 [04:05<02:05,  1.14it/s] 65%|██████▌   | 267/409 [04:05<02:08,  1.11it/s] 66%|██████▌   | 268/409 [04:06<01:54,  1.23it/s] 66%|██████▌   | 269/409 [04:07<01:55,  1.21it/s] 66%|██████▌   | 270/409 [04:08<02:09,  1.07it/s] 66%|██████▋   | 271/409 [04:09<02:00,  1.15it/s] 67%|██████▋   | 272/409 [04:10<02:26,  1.07s/it] 67%|██████▋   | 273/409 [04:11<02:10,  1.05it/s] 67%|██████▋   | 274/409 [04:12<02:19,  1.03s/it] 67%|██████▋   | 275/409 [04:14<02:59,  1.34s/it] 67%|██████▋   | 276/409 [04:15<02:44,  1.24s/it] 68%|██████▊   | 277/409 [04:16<02:23,  1.09s/it] 68%|██████▊   | 278/409 [04:17<02:22,  1.09s/it] 68%|██████▊   | 279/409 [04:18<02:11,  1.02s/it] 68%|██████▊   | 280/409 [04:19<01:55,  1.12it/s] 69%|██████▊   | 281/409 [04:19<01:53,  1.13it/s] 69%|██████▉   | 282/409 [04:20<01:50,  1.15it/s] 69%|██████▉   | 283/409 [04:22<02:14,  1.07s/it] 69%|██████▉   | 284/409 [04:23<02:19,  1.11s/it] 70%|██████▉   | 285/409 [04:24<01:55,  1.07it/s] 70%|██████▉   | 286/409 [04:24<01:37,  1.26it/s] 70%|███████   | 287/409 [04:25<01:38,  1.24it/s] 70%|███████   | 288/409 [04:26<01:33,  1.29it/s] 71%|███████   | 289/409 [04:26<01:27,  1.37it/s] 71%|███████   | 290/409 [04:27<01:26,  1.37it/s] 71%|███████   | 291/409 [04:28<01:38,  1.20it/s] 71%|███████▏  | 292/409 [04:29<01:33,  1.25it/s] 72%|███████▏  | 293/409 [04:30<01:34,  1.23it/s] 72%|███████▏  | 294/409 [04:31<01:47,  1.07it/s] 72%|███████▏  | 295/409 [04:32<01:43,  1.10it/s] 72%|███████▏  | 296/409 [04:32<01:24,  1.34it/s] 73%|███████▎  | 297/409 [04:33<01:30,  1.24it/s] 73%|███████▎  | 298/409 [04:34<01:42,  1.08it/s] 73%|███████▎  | 299/409 [04:35<01:51,  1.01s/it] 73%|███████▎  | 300/409 [04:37<02:04,  1.14s/it] 74%|███████▎  | 301/409 [04:38<02:01,  1.13s/it] 74%|███████▍  | 302/409 [04:39<02:13,  1.25s/it] 74%|███████▍  | 303/409 [04:41<02:22,  1.34s/it] 74%|███████▍  | 304/409 [04:41<01:53,  1.08s/it] 75%|███████▍  | 305/409 [04:42<01:49,  1.05s/it] 75%|███████▍  | 306/409 [04:43<01:46,  1.04s/it] 75%|███████▌  | 307/409 [04:45<01:54,  1.13s/it] 75%|███████▌  | 308/409 [04:45<01:41,  1.00s/it] 76%|███████▌  | 309/409 [04:46<01:32,  1.09it/s] 76%|███████▌  | 310/409 [04:47<01:37,  1.02it/s] 76%|███████▌  | 311/409 [04:48<01:35,  1.03it/s] 76%|███████▋  | 312/409 [04:49<01:34,  1.03it/s] 77%|███████▋  | 313/409 [04:50<01:27,  1.10it/s] 77%|███████▋  | 314/409 [04:51<01:35,  1.01s/it] 77%|███████▋  | 315/409 [04:53<01:41,  1.08s/it] 77%|███████▋  | 316/409 [04:53<01:20,  1.16it/s] 78%|███████▊  | 317/409 [04:54<01:32,  1.01s/it] 78%|███████▊  | 318/409 [04:55<01:33,  1.03s/it] 78%|███████▊  | 319/409 [04:56<01:31,  1.02s/it] 78%|███████▊  | 320/409 [04:57<01:26,  1.03it/s] 78%|███████▊  | 321/409 [04:58<01:16,  1.16it/s] 79%|███████▊  | 322/409 [04:59<01:15,  1.15it/s] 79%|███████▉  | 323/409 [05:00<01:17,  1.11it/s] 79%|███████▉  | 324/409 [05:00<01:05,  1.29it/s] 79%|███████▉  | 325/409 [05:01<01:00,  1.39it/s] 80%|███████▉  | 326/409 [05:01<00:56,  1.46it/s] 80%|███████▉  | 327/409 [05:02<00:54,  1.50it/s] 80%|████████  | 328/409 [05:03<00:52,  1.55it/s] 80%|████████  | 329/409 [05:03<00:59,  1.35it/s] 81%|████████  | 330/409 [05:04<01:03,  1.24it/s] 81%|████████  | 331/409 [05:05<01:03,  1.22it/s] 81%|████████  | 332/409 [05:07<01:19,  1.03s/it] 81%|████████▏ | 333/409 [05:08<01:16,  1.01s/it] 82%|████████▏ | 334/409 [05:09<01:17,  1.03s/it] 82%|████████▏ | 335/409 [05:10<01:28,  1.20s/it] 82%|████████▏ | 336/409 [05:12<01:26,  1.19s/it] 82%|████████▏ | 337/409 [05:12<01:13,  1.02s/it] 83%|████████▎ | 338/409 [05:13<01:00,  1.17it/s] 83%|████████▎ | 339/409 [05:13<00:54,  1.28it/s] 83%|████████▎ | 340/409 [05:14<00:45,  1.53it/s] 83%|████████▎ | 341/409 [05:14<00:35,  1.89it/s] 84%|████████▎ | 342/409 [05:15<00:39,  1.71it/s] 84%|████████▍ | 343/409 [05:16<00:48,  1.36it/s] 84%|████████▍ | 344/409 [05:16<00:45,  1.42it/s] 84%|████████▍ | 345/409 [05:18<00:56,  1.12it/s] 85%|████████▍ | 346/409 [05:18<00:55,  1.14it/s] 85%|████████▍ | 347/409 [05:19<00:55,  1.11it/s] 85%|████████▌ | 348/409 [05:20<00:53,  1.13it/s] 85%|████████▌ | 349/409 [05:21<00:52,  1.13it/s] 86%|████████▌ | 350/409 [05:22<00:59,  1.02s/it] 86%|████████▌ | 351/409 [05:23<00:54,  1.07it/s] 86%|████████▌ | 352/409 [05:24<00:49,  1.15it/s] 86%|████████▋ | 353/409 [05:25<00:46,  1.20it/s] 87%|████████▋ | 354/409 [05:26<00:48,  1.14it/s] 87%|████████▋ | 355/409 [05:27<00:48,  1.12it/s] 87%|████████▋ | 356/409 [05:27<00:46,  1.14it/s] 87%|████████▋ | 357/409 [05:28<00:45,  1.15it/s] 88%|████████▊ | 358/409 [05:29<00:45,  1.11it/s] 88%|████████▊ | 359/409 [05:30<00:42,  1.18it/s] 88%|████████▊ | 360/409 [05:31<00:44,  1.10it/s] 88%|████████▊ | 361/409 [05:32<00:39,  1.23it/s] 89%|████████▊ | 362/409 [05:32<00:37,  1.27it/s] 89%|████████▉ | 363/409 [05:34<00:41,  1.10it/s] 89%|████████▉ | 364/409 [05:34<00:38,  1.18it/s] 89%|████████▉ | 365/409 [05:36<00:44,  1.01s/it] 89%|████████▉ | 366/409 [05:36<00:38,  1.13it/s] 90%|████████▉ | 367/409 [05:37<00:36,  1.14it/s] 90%|████████▉ | 368/409 [05:38<00:33,  1.23it/s] 90%|█████████ | 369/409 [05:39<00:34,  1.17it/s] 90%|█████████ | 370/409 [05:40<00:34,  1.13it/s] 91%|█████████ | 371/409 [05:41<00:35,  1.06it/s] 91%|█████████ | 372/409 [05:42<00:32,  1.14it/s] 91%|█████████ | 373/409 [05:42<00:31,  1.15it/s] 91%|█████████▏| 374/409 [05:43<00:30,  1.15it/s] 92%|█████████▏| 375/409 [05:44<00:30,  1.12it/s] 92%|█████████▏| 376/409 [05:45<00:32,  1.01it/s] 92%|█████████▏| 377/409 [05:46<00:30,  1.06it/s] 92%|█████████▏| 378/409 [05:47<00:28,  1.09it/s] 93%|█████████▎| 379/409 [05:48<00:28,  1.04it/s] 93%|█████████▎| 380/409 [05:49<00:26,  1.07it/s] 93%|█████████▎| 381/409 [05:50<00:25,  1.10it/s] 93%|█████████▎| 382/409 [05:51<00:27,  1.03s/it] 94%|█████████▎| 383/409 [05:52<00:23,  1.11it/s] 94%|█████████▍| 384/409 [05:53<00:25,  1.03s/it] 94%|█████████▍| 385/409 [05:53<00:19,  1.20it/s] 94%|█████████▍| 386/409 [05:54<00:15,  1.52it/s] 95%|█████████▍| 387/409 [05:54<00:12,  1.76it/s] 95%|█████████▍| 388/409 [05:55<00:12,  1.63it/s] 95%|█████████▌| 389/409 [05:55<00:12,  1.64it/s] 95%|█████████▌| 390/409 [05:56<00:12,  1.47it/s] 96%|█████████▌| 391/409 [05:57<00:11,  1.53it/s] 96%|█████████▌| 392/409 [05:57<00:10,  1.58it/s] 96%|█████████▌| 393/409 [05:59<00:12,  1.23it/s] 96%|█████████▋| 394/409 [06:00<00:12,  1.16it/s] 97%|█████████▋| 395/409 [06:01<00:13,  1.03it/s] 97%|█████████▋| 396/409 [06:02<00:11,  1.12it/s] 97%|█████████▋| 397/409 [06:03<00:11,  1.00it/s] 97%|█████████▋| 398/409 [06:04<00:10,  1.09it/s] 98%|█████████▊| 399/409 [06:04<00:08,  1.12it/s] 98%|█████████▊| 400/409 [06:05<00:07,  1.24it/s] 98%|█████████▊| 401/409 [06:06<00:07,  1.08it/s] 98%|█████████▊| 402/409 [06:07<00:06,  1.09it/s] 99%|█████████▊| 403/409 [06:08<00:05,  1.03it/s] 99%|█████████▉| 404/409 [06:09<00:05,  1.04s/it] 99%|█████████▉| 405/409 [06:10<00:04,  1.06s/it] 99%|█████████▉| 406/409 [06:11<00:03,  1.04s/it]100%|█████████▉| 407/409 [06:12<00:01,  1.06it/s]100%|█████████▉| 408/409 [06:13<00:00,  1.01it/s]100%|██████████| 409/409 [06:14<00:00,  1.19it/s]100%|██████████| 409/409 [06:14<00:00,  1.09it/s]
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:274: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
2023-11-01 13:25:07.128853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24077 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:17:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 260.74it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-b9214d3ed3d97729.arrow
Loading cached processed dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-d676d6790b922030.arrow
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.23it/s]  3%|▎         | 3/100 [00:00<00:07, 13.71it/s]  5%|▌         | 5/100 [00:00<00:06, 15.11it/s]  7%|▋         | 7/100 [00:00<00:05, 15.75it/s]  9%|▉         | 9/100 [00:00<00:05, 16.12it/s] 11%|█         | 11/100 [00:00<00:05, 16.34it/s] 13%|█▎        | 13/100 [00:00<00:05, 16.47it/s] 15%|█▌        | 15/100 [00:00<00:05, 16.56it/s] 17%|█▋        | 17/100 [00:01<00:04, 16.62it/s] 19%|█▉        | 19/100 [00:01<00:04, 16.66it/s] 21%|██        | 21/100 [00:01<00:04, 16.69it/s] 23%|██▎       | 23/100 [00:01<00:04, 16.66it/s] 25%|██▌       | 25/100 [00:01<00:04, 16.67it/s] 27%|██▋       | 27/100 [00:01<00:04, 16.70it/s] 29%|██▉       | 29/100 [00:01<00:04, 16.72it/s] 31%|███       | 31/100 [00:01<00:04, 16.73it/s] 33%|███▎      | 33/100 [00:02<00:04, 16.73it/s] 35%|███▌      | 35/100 [00:02<00:03, 16.75it/s] 37%|███▋      | 37/100 [00:02<00:03, 16.75it/s] 39%|███▉      | 39/100 [00:02<00:03, 16.75it/s] 41%|████      | 41/100 [00:02<00:03, 16.75it/s] 43%|████▎     | 43/100 [00:02<00:03, 16.75it/s] 45%|████▌     | 45/100 [00:02<00:03, 16.76it/s] 47%|████▋     | 47/100 [00:02<00:03, 16.76it/s] 49%|████▉     | 49/100 [00:02<00:03, 16.76it/s] 51%|█████     | 51/100 [00:03<00:02, 16.75it/s] 53%|█████▎    | 53/100 [00:03<00:02, 16.72it/s] 55%|█████▌    | 55/100 [00:03<00:02, 16.70it/s] 57%|█████▋    | 57/100 [00:03<00:02, 16.70it/s] 59%|█████▉    | 59/100 [00:03<00:02, 16.70it/s] 61%|██████    | 61/100 [00:03<00:02, 16.70it/s] 63%|██████▎   | 63/100 [00:03<00:02, 16.71it/s] 65%|██████▌   | 65/100 [00:03<00:02, 16.73it/s] 67%|██████▋   | 67/100 [00:04<00:01, 16.74it/s] 69%|██████▉   | 69/100 [00:04<00:01, 16.73it/s] 71%|███████   | 71/100 [00:04<00:01, 16.72it/s] 73%|███████▎  | 73/100 [00:04<00:01, 16.72it/s] 75%|███████▌  | 75/100 [00:04<00:01, 16.72it/s] 77%|███████▋  | 77/100 [00:04<00:01, 16.72it/s] 79%|███████▉  | 79/100 [00:04<00:01, 16.72it/s] 81%|████████  | 81/100 [00:04<00:01, 16.73it/s] 83%|████████▎ | 83/100 [00:05<00:01, 16.74it/s] 85%|████████▌ | 85/100 [00:05<00:00, 16.73it/s] 87%|████████▋ | 87/100 [00:05<00:00, 16.63it/s] 89%|████████▉ | 89/100 [00:05<00:00, 16.55it/s] 91%|█████████ | 91/100 [00:05<00:00, 16.56it/s] 93%|█████████▎| 93/100 [00:05<00:00, 16.57it/s] 95%|█████████▌| 95/100 [00:05<00:00, 16.58it/s] 97%|█████████▋| 97/100 [00:05<00:00, 16.59it/s] 99%|█████████▉| 99/100 [00:05<00:00, 16.63it/s]100%|██████████| 100/100 [00:06<00:00, 16.57it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 340.25it/s]
Loading cached shuffled indices for dataset at /home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b/cache-61defe671af6dfe0.arrow
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (2102 > 2048). Running this sequence through the model will result in indexing errors
Map:  17%|█▋        | 17/100 [00:00<00:00, 141.89 examples/s]Map:  34%|███▍      | 34/100 [00:00<00:00, 149.88 examples/s]Map:  54%|█████▍    | 54/100 [00:00<00:00, 157.57 examples/s]Map:  73%|███████▎  | 73/100 [00:00<00:00, 154.57 examples/s]Map:  99%|█████████▉| 99/100 [00:00<00:00, 147.42 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.08it/s]  2%|▏         | 2/100 [00:00<00:12,  7.70it/s]  3%|▎         | 3/100 [00:00<00:12,  7.96it/s]  4%|▍         | 4/100 [00:00<00:12,  7.72it/s]  5%|▌         | 5/100 [00:00<00:12,  7.87it/s]  6%|▌         | 6/100 [00:00<00:11,  7.89it/s]  7%|▋         | 7/100 [00:00<00:12,  7.66it/s]  8%|▊         | 8/100 [00:01<00:11,  7.79it/s]  9%|▉         | 9/100 [00:01<00:11,  7.70it/s] 10%|█         | 10/100 [00:01<00:11,  7.81it/s] 11%|█         | 11/100 [00:01<00:11,  7.67it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.76it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.66it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.61it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.65it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.76it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.73it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.76it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.78it/s] 20%|██        | 20/100 [00:02<00:10,  7.83it/s] 21%|██        | 21/100 [00:02<00:10,  7.87it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.81it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.88it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.91it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.92it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.81it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.83it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.82it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.73it/s] 30%|███       | 30/100 [00:03<00:08,  7.78it/s] 31%|███       | 31/100 [00:03<00:08,  7.85it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.61it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.72it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.73it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.76it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.83it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.87it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.73it/s] 39%|███▉      | 39/100 [00:05<00:07,  7.79it/s] 40%|████      | 40/100 [00:05<00:07,  7.73it/s] 41%|████      | 41/100 [00:05<00:07,  7.73it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.79it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.84it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.78it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.84it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.83it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.87it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.81it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.86it/s] 50%|█████     | 50/100 [00:06<00:06,  7.72it/s] 51%|█████     | 51/100 [00:06<00:06,  7.71it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.80it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.59it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.55it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.70it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.72it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.80it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.77it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.82it/s] 60%|██████    | 60/100 [00:07<00:05,  7.69it/s] 61%|██████    | 61/100 [00:07<00:05,  7.57it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.71it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.69it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.67it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.78it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.84it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.88it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.75it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.69it/s] 70%|███████   | 70/100 [00:09<00:03,  7.62it/s] 71%|███████   | 71/100 [00:09<00:03,  7.61it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.75it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.71it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.81it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.83it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.87it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.90it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.64it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.63it/s] 80%|████████  | 80/100 [00:10<00:02,  7.76it/s] 81%|████████  | 81/100 [00:10<00:02,  7.78it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.85it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.88it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.68it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.78it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.65it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.77it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.77it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.86it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.60it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.74it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.72it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.55it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.67it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.58it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.74it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.83it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.80it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.68it/s]100%|██████████| 100/100 [00:12<00:00,  7.80it/s]100%|██████████| 100/100 [00:12<00:00,  7.75it/s]
FOLD 0
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.266504  0.530332  5.110156     3.163941
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.07it/s]  6%|▋         | 2/32 [00:00<00:14,  2.10it/s]  9%|▉         | 3/32 [00:01<00:14,  2.01it/s] 12%|█▎        | 4/32 [00:01<00:14,  1.99it/s] 16%|█▌        | 5/32 [00:02<00:14,  1.92it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.89it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.84it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.81it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.72it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.64it/s] 34%|███▍      | 11/32 [00:06<00:13,  1.60it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.59it/s] 41%|████      | 13/32 [00:07<00:12,  1.57it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.55it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.52it/s] 50%|█████     | 16/32 [00:09<00:10,  1.53it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.52it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.49it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.43it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:13<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.41it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.42it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.41it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.40it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.43it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.44it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.47it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.48it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.53it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.54it/s]100%|██████████| 32/32 [00:20<00:00,  1.40it/s]100%|██████████| 32/32 [00:20<00:00,  1.55it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.55536627 0.57751278 0.55536627 ... 0.55536627 0.55536627 0.55536627]
 [0.55536627 0.55536627 0.55536627 ... 0.57751278 0.55536627 0.55536627]
 [0.55536627 0.58603066 0.66780239 ... 0.60647359 0.55536627 0.59284497]
 ...
 [0.66950596 0.560477   0.58091993 ... 0.61669506 0.55706985 0.560477  ]
 [0.67291312 0.54684838 0.57069847 ... 0.57069847 0.63713799 0.55536627]
 [0.56899489 0.6286201  0.64054514 ... 0.62350937 0.62010221 0.62010221]]
Heads intervened:  [(6, 28), (7, 14), (7, 23), (8, 12), (9, 19), (9, 20), (9, 29), (10, 1), (10, 2), (10, 5), (10, 15), (10, 17), (10, 22), (10, 28), (10, 29), (11, 0), (11, 3), (11, 5), (11, 6), (11, 8), (11, 21), (11, 29), (11, 31), (12, 3), (12, 9), (12, 14), (13, 16), (13, 22), (13, 23), (14, 14), (14, 18), (14, 22), (14, 30), (15, 20), (15, 28), (16, 17), (16, 26), (17, 1), (18, 0), (18, 9), (18, 10), (18, 17), (19, 9), (20, 9), (20, 30), (26, 14), (30, 22), (31, 6)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/408 [00:00<?, ?it/s]  0%|          | 1/408 [00:01<10:27,  1.54s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 2/408 [00:02<09:22,  1.39s/it]  1%|          | 3/408 [00:03<08:24,  1.25s/it]  1%|          | 4/408 [00:05<09:56,  1.48s/it]  1%|          | 5/408 [00:06<07:49,  1.16s/it]  1%|▏         | 6/408 [00:07<07:04,  1.06s/it]  2%|▏         | 7/408 [00:07<05:16,  1.27it/s]  2%|▏         | 8/408 [00:08<05:41,  1.17it/s]  2%|▏         | 9/408 [00:08<04:55,  1.35it/s]  2%|▏         | 10/408 [00:09<04:39,  1.43it/s]  3%|▎         | 11/408 [00:10<05:56,  1.11it/s]  3%|▎         | 12/408 [00:11<05:51,  1.13it/s]  3%|▎         | 13/408 [00:12<05:35,  1.18it/s]  3%|▎         | 14/408 [00:13<05:42,  1.15it/s]  4%|▎         | 15/408 [00:14<05:23,  1.21it/s]  4%|▍         | 16/408 [00:14<05:12,  1.25it/s]  4%|▍         | 17/408 [00:15<04:48,  1.36it/s]  4%|▍         | 18/408 [00:16<05:17,  1.23it/s]  5%|▍         | 19/408 [00:16<04:40,  1.39it/s]  5%|▍         | 20/408 [00:17<04:12,  1.54it/s]  5%|▌         | 21/408 [00:18<05:31,  1.17it/s]  5%|▌         | 22/408 [00:19<05:30,  1.17it/s]  6%|▌         | 23/408 [00:21<07:40,  1.20s/it]  6%|▌         | 24/408 [00:22<07:14,  1.13s/it]  6%|▌         | 25/408 [00:23<07:25,  1.16s/it]  6%|▋         | 26/408 [00:24<07:12,  1.13s/it]  7%|▋         | 27/408 [00:25<06:42,  1.06s/it]  7%|▋         | 28/408 [00:26<05:51,  1.08it/s]  7%|▋         | 29/408 [00:27<07:04,  1.12s/it]  7%|▋         | 30/408 [00:28<06:17,  1.00it/s]  8%|▊         | 31/408 [00:30<07:18,  1.16s/it]  8%|▊         | 32/408 [00:31<06:54,  1.10s/it]  8%|▊         | 33/408 [00:32<06:29,  1.04s/it]  8%|▊         | 34/408 [00:33<06:44,  1.08s/it]  9%|▊         | 35/408 [00:34<06:18,  1.02s/it]  9%|▉         | 36/408 [00:34<04:51,  1.28it/s]  9%|▉         | 37/408 [00:35<04:44,  1.30it/s]  9%|▉         | 38/408 [00:35<04:28,  1.38it/s] 10%|▉         | 39/408 [00:36<04:14,  1.45it/s] 10%|▉         | 40/408 [00:37<05:09,  1.19it/s] 10%|█         | 41/408 [00:38<05:08,  1.19it/s] 10%|█         | 42/408 [00:39<05:10,  1.18it/s] 11%|█         | 43/408 [00:40<05:40,  1.07it/s] 11%|█         | 44/408 [00:41<06:00,  1.01it/s] 11%|█         | 45/408 [00:42<06:11,  1.02s/it] 11%|█▏        | 46/408 [00:44<06:53,  1.14s/it] 12%|█▏        | 47/408 [00:44<06:33,  1.09s/it] 12%|█▏        | 48/408 [00:46<06:32,  1.09s/it] 12%|█▏        | 49/408 [00:47<06:32,  1.09s/it] 12%|█▏        | 50/408 [00:48<06:28,  1.08s/it] 12%|█▎        | 51/408 [00:49<06:29,  1.09s/it] 13%|█▎        | 52/408 [00:50<06:02,  1.02s/it] 13%|█▎        | 53/408 [00:50<05:30,  1.07it/s] 13%|█▎        | 54/408 [00:52<06:05,  1.03s/it] 13%|█▎        | 55/408 [00:52<05:19,  1.10it/s] 14%|█▎        | 56/408 [00:53<05:14,  1.12it/s] 14%|█▍        | 57/408 [00:54<04:17,  1.36it/s] 14%|█▍        | 58/408 [00:55<05:56,  1.02s/it] 14%|█▍        | 59/408 [00:57<06:29,  1.12s/it] 15%|█▍        | 60/408 [00:58<06:52,  1.19s/it] 15%|█▍        | 61/408 [00:59<05:53,  1.02s/it] 15%|█▌        | 62/408 [00:59<05:34,  1.03it/s] 15%|█▌        | 63/408 [01:00<05:09,  1.11it/s] 16%|█▌        | 64/408 [01:01<04:51,  1.18it/s] 16%|█▌        | 65/408 [01:02<05:30,  1.04it/s] 16%|█▌        | 66/408 [01:03<04:41,  1.22it/s] 16%|█▋        | 67/408 [01:03<04:15,  1.33it/s] 17%|█▋        | 68/408 [01:04<04:11,  1.35it/s] 17%|█▋        | 69/408 [01:04<03:44,  1.51it/s] 17%|█▋        | 70/408 [01:05<04:13,  1.33it/s] 17%|█▋        | 71/408 [01:06<03:33,  1.58it/s] 18%|█▊        | 72/408 [01:08<05:39,  1.01s/it] 18%|█▊        | 73/408 [01:09<06:37,  1.19s/it] 18%|█▊        | 74/408 [01:10<05:25,  1.03it/s] 18%|█▊        | 75/408 [01:11<05:48,  1.05s/it] 19%|█▊        | 76/408 [01:12<05:19,  1.04it/s] 19%|█▉        | 77/408 [01:12<05:07,  1.08it/s] 19%|█▉        | 78/408 [01:13<05:08,  1.07it/s] 19%|█▉        | 79/408 [01:14<05:15,  1.04it/s] 20%|█▉        | 80/408 [01:16<05:39,  1.03s/it] 20%|█▉        | 81/408 [01:16<05:20,  1.02it/s] 20%|██        | 82/408 [01:17<04:55,  1.10it/s] 20%|██        | 83/408 [01:18<04:25,  1.22it/s] 21%|██        | 84/408 [01:19<05:14,  1.03it/s] 21%|██        | 85/408 [01:20<05:15,  1.02it/s] 21%|██        | 86/408 [01:22<06:02,  1.13s/it] 21%|██▏       | 87/408 [01:22<05:35,  1.04s/it] 22%|██▏       | 88/408 [01:24<05:50,  1.09s/it] 22%|██▏       | 89/408 [01:25<05:37,  1.06s/it] 22%|██▏       | 90/408 [01:25<04:41,  1.13it/s] 22%|██▏       | 91/408 [01:26<05:16,  1.00it/s] 23%|██▎       | 92/408 [01:27<05:01,  1.05it/s] 23%|██▎       | 93/408 [01:29<05:51,  1.12s/it] 23%|██▎       | 94/408 [01:30<05:48,  1.11s/it] 23%|██▎       | 95/408 [01:30<05:00,  1.04it/s] 24%|██▎       | 96/408 [01:31<04:39,  1.12it/s] 24%|██▍       | 97/408 [01:32<04:36,  1.12it/s] 24%|██▍       | 98/408 [01:33<04:52,  1.06it/s] 24%|██▍       | 99/408 [01:35<05:38,  1.10s/it] 25%|██▍       | 100/408 [01:35<05:15,  1.03s/it] 25%|██▍       | 101/408 [01:36<04:03,  1.26it/s] 25%|██▌       | 102/408 [01:36<03:55,  1.30it/s] 25%|██▌       | 103/408 [01:37<04:04,  1.25it/s] 25%|██▌       | 104/408 [01:38<04:10,  1.21it/s] 26%|██▌       | 105/408 [01:39<04:22,  1.16it/s] 26%|██▌       | 106/408 [01:41<05:10,  1.03s/it] 26%|██▌       | 107/408 [01:41<04:22,  1.14it/s] 26%|██▋       | 108/408 [01:42<04:40,  1.07it/s] 27%|██▋       | 109/408 [01:43<04:20,  1.15it/s] 27%|██▋       | 110/408 [01:43<03:53,  1.27it/s] 27%|██▋       | 111/408 [01:45<04:22,  1.13it/s] 27%|██▋       | 112/408 [01:45<03:56,  1.25it/s] 28%|██▊       | 113/408 [01:46<03:52,  1.27it/s] 28%|██▊       | 114/408 [01:47<04:37,  1.06it/s] 28%|██▊       | 115/408 [01:49<05:23,  1.11s/it] 28%|██▊       | 116/408 [01:50<05:34,  1.15s/it] 29%|██▊       | 117/408 [01:51<05:16,  1.09s/it] 29%|██▉       | 118/408 [01:52<05:14,  1.08s/it] 29%|██▉       | 119/408 [01:53<05:13,  1.08s/it] 29%|██▉       | 120/408 [01:54<04:49,  1.01s/it] 30%|██▉       | 121/408 [01:54<04:04,  1.18it/s] 30%|██▉       | 122/408 [01:55<03:41,  1.29it/s] 30%|███       | 123/408 [01:56<04:18,  1.10it/s] 30%|███       | 124/408 [01:57<04:02,  1.17it/s] 31%|███       | 125/408 [01:58<03:50,  1.23it/s] 31%|███       | 126/408 [01:58<03:41,  1.27it/s] 31%|███       | 127/408 [02:00<04:16,  1.10it/s] 31%|███▏      | 128/408 [02:00<03:19,  1.40it/s] 32%|███▏      | 129/408 [02:01<04:06,  1.13it/s] 32%|███▏      | 130/408 [02:03<04:50,  1.04s/it] 32%|███▏      | 131/408 [02:03<04:34,  1.01it/s] 32%|███▏      | 132/408 [02:04<04:23,  1.05it/s] 33%|███▎      | 133/408 [02:05<04:37,  1.01s/it] 33%|███▎      | 134/408 [02:07<05:47,  1.27s/it] 33%|███▎      | 135/408 [02:09<06:20,  1.40s/it] 33%|███▎      | 136/408 [02:10<05:54,  1.30s/it] 34%|███▎      | 137/408 [02:11<04:46,  1.06s/it] 34%|███▍      | 138/408 [02:11<04:36,  1.02s/it] 34%|███▍      | 139/408 [02:12<04:21,  1.03it/s] 34%|███▍      | 140/408 [02:14<05:14,  1.17s/it] 35%|███▍      | 141/408 [02:15<04:51,  1.09s/it] 35%|███▍      | 142/408 [02:16<05:05,  1.15s/it] 35%|███▌      | 143/408 [02:17<04:49,  1.09s/it] 35%|███▌      | 144/408 [02:18<04:29,  1.02s/it] 36%|███▌      | 145/408 [02:19<04:25,  1.01s/it] 36%|███▌      | 146/408 [02:20<04:12,  1.04it/s] 36%|███▌      | 147/408 [02:21<04:13,  1.03it/s] 36%|███▋      | 148/408 [02:21<03:52,  1.12it/s] 37%|███▋      | 149/408 [02:23<04:10,  1.03it/s] 37%|███▋      | 150/408 [02:24<04:11,  1.02it/s] 37%|███▋      | 151/408 [02:24<03:35,  1.19it/s] 37%|███▋      | 152/408 [02:25<03:55,  1.09it/s] 38%|███▊      | 153/408 [02:26<03:59,  1.07it/s] 38%|███▊      | 154/408 [02:27<03:54,  1.08it/s] 38%|███▊      | 155/408 [02:29<05:28,  1.30s/it] 38%|███▊      | 156/408 [02:30<05:02,  1.20s/it] 38%|███▊      | 157/408 [02:32<05:29,  1.31s/it] 39%|███▊      | 158/408 [02:33<05:11,  1.24s/it] 39%|███▉      | 159/408 [02:34<04:53,  1.18s/it] 39%|███▉      | 160/408 [02:35<04:12,  1.02s/it] 39%|███▉      | 161/408 [02:35<03:41,  1.12it/s] 40%|███▉      | 162/408 [02:36<03:36,  1.14it/s] 40%|███▉      | 163/408 [02:37<03:34,  1.14it/s] 40%|████      | 164/408 [02:38<03:22,  1.21it/s] 40%|████      | 165/408 [02:39<03:30,  1.15it/s] 41%|████      | 166/408 [02:39<03:28,  1.16it/s] 41%|████      | 167/408 [02:40<03:02,  1.32it/s] 41%|████      | 168/408 [02:41<02:57,  1.35it/s] 41%|████▏     | 169/408 [02:41<03:04,  1.30it/s] 42%|████▏     | 170/408 [02:42<03:18,  1.20it/s] 42%|████▏     | 171/408 [02:43<03:10,  1.25it/s] 42%|████▏     | 172/408 [02:44<02:56,  1.34it/s] 42%|████▏     | 173/408 [02:45<03:36,  1.08it/s] 43%|████▎     | 174/408 [02:46<04:03,  1.04s/it] 43%|████▎     | 175/408 [02:47<03:57,  1.02s/it] 43%|████▎     | 176/408 [02:48<03:38,  1.06it/s] 43%|████▎     | 177/408 [02:49<03:06,  1.24it/s] 44%|████▎     | 178/408 [02:50<03:42,  1.03it/s] 44%|████▍     | 179/408 [02:51<03:27,  1.11it/s] 44%|████▍     | 180/408 [02:52<03:15,  1.17it/s] 44%|████▍     | 181/408 [02:52<02:58,  1.27it/s] 45%|████▍     | 182/408 [02:53<03:04,  1.22it/s] 45%|████▍     | 183/408 [02:54<03:38,  1.03it/s] 45%|████▌     | 184/408 [02:55<03:14,  1.15it/s] 45%|████▌     | 185/408 [02:56<03:02,  1.22it/s] 46%|████▌     | 186/408 [02:57<03:14,  1.14it/s] 46%|████▌     | 187/408 [02:58<03:59,  1.08s/it] 46%|████▌     | 188/408 [02:59<03:35,  1.02it/s] 46%|████▋     | 189/408 [03:00<03:35,  1.02it/s] 47%|████▋     | 190/408 [03:01<03:35,  1.01it/s] 47%|████▋     | 191/408 [03:02<03:26,  1.05it/s] 47%|████▋     | 192/408 [03:03<03:32,  1.02it/s] 47%|████▋     | 193/408 [03:04<03:31,  1.02it/s] 48%|████▊     | 194/408 [03:05<03:13,  1.11it/s] 48%|████▊     | 195/408 [03:06<03:10,  1.12it/s] 48%|████▊     | 196/408 [03:06<02:44,  1.29it/s] 48%|████▊     | 197/408 [03:07<02:42,  1.30it/s] 49%|████▊     | 198/408 [03:07<02:31,  1.39it/s] 49%|████▉     | 199/408 [03:08<02:08,  1.63it/s] 49%|████▉     | 200/408 [03:09<02:37,  1.32it/s] 49%|████▉     | 201/408 [03:10<02:49,  1.22it/s] 50%|████▉     | 202/408 [03:11<02:43,  1.26it/s] 50%|████▉     | 203/408 [03:11<02:31,  1.35it/s] 50%|█████     | 204/408 [03:12<02:58,  1.15it/s] 50%|█████     | 205/408 [03:13<02:41,  1.26it/s] 50%|█████     | 206/408 [03:14<02:36,  1.29it/s] 51%|█████     | 207/408 [03:15<02:42,  1.24it/s] 51%|█████     | 208/408 [03:16<03:05,  1.08it/s] 51%|█████     | 209/408 [03:17<03:07,  1.06it/s] 51%|█████▏    | 210/408 [03:17<02:54,  1.13it/s] 52%|█████▏    | 211/408 [03:18<02:37,  1.25it/s] 52%|█████▏    | 212/408 [03:19<03:11,  1.02it/s] 52%|█████▏    | 213/408 [03:21<03:48,  1.17s/it] 52%|█████▏    | 214/408 [03:23<04:01,  1.25s/it] 53%|█████▎    | 215/408 [03:23<03:31,  1.10s/it] 53%|█████▎    | 216/408 [03:24<03:17,  1.03s/it] 53%|█████▎    | 217/408 [03:25<03:27,  1.09s/it] 53%|█████▎    | 218/408 [03:26<03:13,  1.02s/it] 54%|█████▎    | 219/408 [03:28<03:44,  1.19s/it] 54%|█████▍    | 220/408 [03:29<03:40,  1.17s/it] 54%|█████▍    | 221/408 [03:30<03:44,  1.20s/it] 54%|█████▍    | 222/408 [03:31<02:56,  1.05it/s] 55%|█████▍    | 223/408 [03:32<03:27,  1.12s/it] 55%|█████▍    | 224/408 [03:33<03:38,  1.19s/it] 55%|█████▌    | 225/408 [03:34<03:24,  1.12s/it] 55%|█████▌    | 226/408 [03:35<03:03,  1.01s/it] 56%|█████▌    | 227/408 [03:36<03:16,  1.08s/it] 56%|█████▌    | 228/408 [03:37<02:50,  1.06it/s] 56%|█████▌    | 229/408 [03:38<02:37,  1.13it/s] 56%|█████▋    | 230/408 [03:38<02:22,  1.25it/s] 57%|█████▋    | 231/408 [03:39<01:58,  1.49it/s] 57%|█████▋    | 232/408 [03:39<02:02,  1.44it/s] 57%|█████▋    | 233/408 [03:40<02:03,  1.42it/s] 57%|█████▋    | 234/408 [03:41<02:09,  1.34it/s] 58%|█████▊    | 235/408 [03:42<01:55,  1.50it/s] 58%|█████▊    | 236/408 [03:42<01:52,  1.53it/s] 58%|█████▊    | 237/408 [03:43<01:56,  1.47it/s] 58%|█████▊    | 238/408 [03:44<02:36,  1.09it/s] 59%|█████▊    | 239/408 [03:46<02:51,  1.01s/it] 59%|█████▉    | 240/408 [03:47<02:48,  1.00s/it] 59%|█████▉    | 241/408 [03:47<02:15,  1.23it/s] 59%|█████▉    | 242/408 [03:48<02:12,  1.25it/s] 60%|█████▉    | 243/408 [03:49<02:22,  1.16it/s] 60%|█████▉    | 244/408 [03:50<02:33,  1.07it/s] 60%|██████    | 245/408 [03:51<02:28,  1.10it/s] 60%|██████    | 246/408 [03:51<02:18,  1.17it/s] 61%|██████    | 247/408 [03:52<02:11,  1.23it/s] 61%|██████    | 248/408 [03:53<01:54,  1.40it/s] 61%|██████    | 249/408 [03:53<01:54,  1.39it/s] 61%|██████▏   | 250/408 [03:54<02:00,  1.31it/s] 62%|██████▏   | 251/408 [03:55<01:58,  1.33it/s] 62%|██████▏   | 252/408 [03:56<02:20,  1.11it/s] 62%|██████▏   | 253/408 [03:57<02:11,  1.18it/s] 62%|██████▏   | 254/408 [03:58<02:25,  1.06it/s] 62%|██████▎   | 255/408 [03:59<02:14,  1.14it/s] 63%|██████▎   | 256/408 [04:00<02:15,  1.13it/s] 63%|██████▎   | 257/408 [04:01<02:13,  1.13it/s] 63%|██████▎   | 258/408 [04:01<02:07,  1.18it/s] 63%|██████▎   | 259/408 [04:02<02:19,  1.07it/s] 64%|██████▎   | 260/408 [04:03<02:10,  1.13it/s] 64%|██████▍   | 261/408 [04:05<02:31,  1.03s/it] 64%|██████▍   | 262/408 [04:08<03:54,  1.61s/it] 64%|██████▍   | 263/408 [04:08<02:59,  1.24s/it] 65%|██████▍   | 264/408 [04:09<02:45,  1.15s/it] 65%|██████▍   | 265/408 [04:10<02:30,  1.05s/it] 65%|██████▌   | 266/408 [04:11<02:26,  1.03s/it] 65%|██████▌   | 267/408 [04:12<02:29,  1.06s/it] 66%|██████▌   | 268/408 [04:13<02:18,  1.01it/s] 66%|██████▌   | 269/408 [04:13<02:01,  1.15it/s] 66%|██████▌   | 270/408 [04:14<01:54,  1.21it/s] 66%|██████▋   | 271/408 [04:15<01:44,  1.31it/s] 67%|██████▋   | 272/408 [04:15<01:42,  1.32it/s] 67%|██████▋   | 273/408 [04:17<02:07,  1.06it/s] 67%|██████▋   | 274/408 [04:17<01:56,  1.15it/s] 67%|██████▋   | 275/408 [04:18<01:50,  1.20it/s] 68%|██████▊   | 276/408 [04:19<01:59,  1.10it/s] 68%|██████▊   | 277/408 [04:20<01:56,  1.13it/s] 68%|██████▊   | 278/408 [04:21<02:12,  1.02s/it] 68%|██████▊   | 279/408 [04:22<01:55,  1.12it/s] 69%|██████▊   | 280/408 [04:23<01:48,  1.18it/s] 69%|██████▉   | 281/408 [04:24<01:44,  1.22it/s] 69%|██████▉   | 282/408 [04:24<01:31,  1.38it/s] 69%|██████▉   | 283/408 [04:25<01:30,  1.38it/s] 70%|██████▉   | 284/408 [04:26<01:35,  1.30it/s] 70%|██████▉   | 285/408 [04:26<01:37,  1.26it/s] 70%|███████   | 286/408 [04:28<01:49,  1.12it/s] 70%|███████   | 287/408 [04:28<01:41,  1.19it/s] 71%|███████   | 288/408 [04:29<01:37,  1.23it/s] 71%|███████   | 289/408 [04:30<01:38,  1.20it/s] 71%|███████   | 290/408 [04:31<01:29,  1.31it/s] 71%|███████▏  | 291/408 [04:32<01:50,  1.06it/s] 72%|███████▏  | 292/408 [04:34<02:13,  1.15s/it] 72%|███████▏  | 293/408 [04:36<02:50,  1.48s/it] 72%|███████▏  | 294/408 [04:37<02:27,  1.29s/it] 72%|███████▏  | 295/408 [04:38<02:14,  1.19s/it] 73%|███████▎  | 296/408 [04:38<01:58,  1.06s/it] 73%|███████▎  | 297/408 [04:40<02:03,  1.12s/it] 73%|███████▎  | 298/408 [04:40<01:49,  1.00it/s] 73%|███████▎  | 299/408 [04:41<01:40,  1.09it/s] 74%|███████▎  | 300/408 [04:42<01:25,  1.26it/s] 74%|███████▍  | 301/408 [04:42<01:22,  1.29it/s] 74%|███████▍  | 302/408 [04:43<01:36,  1.10it/s] 74%|███████▍  | 303/408 [04:44<01:33,  1.12it/s] 75%|███████▍  | 304/408 [04:45<01:35,  1.09it/s] 75%|███████▍  | 305/408 [04:46<01:30,  1.14it/s] 75%|███████▌  | 306/408 [04:47<01:28,  1.16it/s] 75%|███████▌  | 307/408 [04:48<01:38,  1.02it/s] 75%|███████▌  | 308/408 [04:49<01:34,  1.06it/s] 76%|███████▌  | 309/408 [04:50<01:33,  1.05it/s] 76%|███████▌  | 310/408 [04:51<01:22,  1.19it/s] 76%|███████▌  | 311/408 [04:52<01:36,  1.00it/s] 76%|███████▋  | 312/408 [04:52<01:17,  1.24it/s] 77%|███████▋  | 313/408 [04:53<01:26,  1.10it/s] 77%|███████▋  | 314/408 [04:55<01:39,  1.06s/it] 77%|███████▋  | 315/408 [04:56<01:31,  1.01it/s] 77%|███████▋  | 316/408 [04:57<01:30,  1.02it/s] 78%|███████▊  | 317/408 [04:57<01:19,  1.15it/s] 78%|███████▊  | 318/408 [04:59<01:27,  1.03it/s] 78%|███████▊  | 319/408 [04:59<01:17,  1.15it/s] 78%|███████▊  | 320/408 [05:01<01:35,  1.08s/it] 79%|███████▊  | 321/408 [05:01<01:18,  1.11it/s] 79%|███████▉  | 322/408 [05:02<01:16,  1.12it/s] 79%|███████▉  | 323/408 [05:03<01:08,  1.24it/s] 79%|███████▉  | 324/408 [05:04<01:09,  1.21it/s] 80%|███████▉  | 325/408 [05:04<01:03,  1.31it/s] 80%|███████▉  | 326/408 [05:05<00:55,  1.47it/s] 80%|████████  | 327/408 [05:06<01:20,  1.01it/s] 80%|████████  | 328/408 [05:07<01:07,  1.19it/s] 81%|████████  | 329/408 [05:08<01:10,  1.11it/s] 81%|████████  | 330/408 [05:08<01:00,  1.29it/s] 81%|████████  | 331/408 [05:09<00:58,  1.31it/s] 81%|████████▏ | 332/408 [05:10<01:02,  1.21it/s] 82%|████████▏ | 333/408 [05:11<01:02,  1.20it/s] 82%|████████▏ | 334/408 [05:12<01:07,  1.09it/s] 82%|████████▏ | 335/408 [05:13<01:03,  1.15it/s] 82%|████████▏ | 336/408 [05:13<00:56,  1.27it/s] 83%|████████▎ | 337/408 [05:15<01:12,  1.02s/it] 83%|████████▎ | 338/408 [05:16<01:07,  1.03it/s] 83%|████████▎ | 339/408 [05:17<01:02,  1.11it/s] 83%|████████▎ | 340/408 [05:18<01:02,  1.08it/s] 84%|████████▎ | 341/408 [05:19<01:05,  1.02it/s] 84%|████████▍ | 342/408 [05:20<01:08,  1.04s/it] 84%|████████▍ | 343/408 [05:20<00:58,  1.10it/s] 84%|████████▍ | 344/408 [05:21<01:00,  1.05it/s] 85%|████████▍ | 345/408 [05:22<00:58,  1.07it/s] 85%|████████▍ | 346/408 [05:23<00:55,  1.11it/s] 85%|████████▌ | 347/408 [05:24<00:54,  1.13it/s] 85%|████████▌ | 348/408 [05:25<00:58,  1.02it/s] 86%|████████▌ | 349/408 [05:26<00:57,  1.02it/s] 86%|████████▌ | 350/408 [05:27<00:54,  1.07it/s] 86%|████████▌ | 351/408 [05:28<00:51,  1.10it/s] 86%|████████▋ | 352/408 [05:29<00:49,  1.13it/s] 87%|████████▋ | 353/408 [05:29<00:42,  1.30it/s] 87%|████████▋ | 354/408 [05:31<00:51,  1.05it/s] 87%|████████▋ | 355/408 [05:31<00:41,  1.29it/s] 87%|████████▋ | 356/408 [05:32<00:37,  1.37it/s] 88%|████████▊ | 357/408 [05:32<00:37,  1.38it/s] 88%|████████▊ | 358/408 [05:34<00:49,  1.02it/s] 88%|████████▊ | 359/408 [05:35<00:46,  1.06it/s] 88%|████████▊ | 360/408 [05:35<00:39,  1.23it/s] 88%|████████▊ | 361/408 [05:37<00:45,  1.04it/s] 89%|████████▊ | 362/408 [05:37<00:43,  1.06it/s] 89%|████████▉ | 363/408 [05:38<00:43,  1.04it/s] 89%|████████▉ | 364/408 [05:39<00:37,  1.17it/s] 89%|████████▉ | 365/408 [05:40<00:35,  1.21it/s] 90%|████████▉ | 366/408 [05:40<00:30,  1.38it/s] 90%|████████▉ | 367/408 [05:41<00:28,  1.45it/s] 90%|█████████ | 368/408 [05:42<00:28,  1.40it/s] 90%|█████████ | 369/408 [05:43<00:30,  1.27it/s] 91%|█████████ | 370/408 [05:44<00:33,  1.14it/s] 91%|█████████ | 371/408 [05:44<00:29,  1.25it/s] 91%|█████████ | 372/408 [05:46<00:33,  1.09it/s] 91%|█████████▏| 373/408 [05:47<00:33,  1.04it/s] 92%|█████████▏| 374/408 [05:48<00:41,  1.22s/it] 92%|█████████▏| 375/408 [05:49<00:35,  1.07s/it] 92%|█████████▏| 376/408 [05:50<00:33,  1.05s/it] 92%|█████████▏| 377/408 [05:51<00:31,  1.03s/it] 93%|█████████▎| 378/408 [05:52<00:30,  1.02s/it] 93%|█████████▎| 379/408 [05:53<00:29,  1.01s/it] 93%|█████████▎| 380/408 [05:54<00:29,  1.04s/it] 93%|█████████▎| 381/408 [05:55<00:27,  1.02s/it] 94%|█████████▎| 382/408 [05:56<00:27,  1.07s/it] 94%|█████████▍| 383/408 [05:57<00:26,  1.04s/it] 94%|█████████▍| 384/408 [05:59<00:26,  1.09s/it] 94%|█████████▍| 385/408 [06:00<00:26,  1.14s/it] 95%|█████████▍| 386/408 [06:01<00:25,  1.17s/it] 95%|█████████▍| 387/408 [06:02<00:21,  1.04s/it] 95%|█████████▌| 388/408 [06:03<00:18,  1.06it/s] 95%|█████████▌| 389/408 [06:03<00:17,  1.08it/s] 96%|█████████▌| 390/408 [06:04<00:15,  1.14it/s] 96%|█████████▌| 391/408 [06:05<00:16,  1.06it/s] 96%|█████████▌| 392/408 [06:07<00:18,  1.14s/it] 96%|█████████▋| 393/408 [06:07<00:14,  1.02it/s] 97%|█████████▋| 394/408 [06:08<00:13,  1.03it/s] 97%|█████████▋| 395/408 [06:09<00:11,  1.16it/s] 97%|█████████▋| 396/408 [06:10<00:09,  1.20it/s] 97%|█████████▋| 397/408 [06:11<00:09,  1.19it/s] 98%|█████████▊| 398/408 [06:12<00:08,  1.14it/s] 98%|█████████▊| 399/408 [06:13<00:08,  1.09it/s] 98%|█████████▊| 400/408 [06:14<00:07,  1.07it/s] 98%|█████████▊| 401/408 [06:14<00:06,  1.11it/s] 99%|█████████▊| 402/408 [06:16<00:05,  1.04it/s] 99%|█████████▉| 403/408 [06:16<00:03,  1.27it/s] 99%|█████████▉| 404/408 [06:17<00:03,  1.19it/s] 99%|█████████▉| 405/408 [06:18<00:02,  1.00it/s]100%|█████████▉| 406/408 [06:19<00:01,  1.01it/s]100%|█████████▉| 407/408 [06:20<00:00,  1.10it/s]100%|██████████| 408/408 [06:21<00:00,  1.17it/s]100%|██████████| 408/408 [06:21<00:00,  1.07it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 268.30it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (2467 > 2048). Running this sequence through the model will result in indexing errors
Map:  13%|█▎        | 13/100 [00:00<00:00, 115.37 examples/s]Map:  32%|███▏      | 32/100 [00:00<00:00, 139.65 examples/s]Map:  48%|████▊     | 48/100 [00:00<00:00, 145.07 examples/s]Map:  69%|██████▉   | 69/100 [00:00<00:00, 167.83 examples/s]Map:  99%|█████████▉| 99/100 [00:00<00:00, 173.40 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:05, 16.63it/s]  4%|▍         | 4/100 [00:00<00:05, 16.74it/s]  6%|▌         | 6/100 [00:00<00:05, 16.77it/s]  8%|▊         | 8/100 [00:00<00:05, 16.78it/s] 10%|█         | 10/100 [00:00<00:05, 16.78it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.79it/s] 14%|█▍        | 14/100 [00:00<00:05, 16.80it/s] 16%|█▌        | 16/100 [00:00<00:05, 16.80it/s] 18%|█▊        | 18/100 [00:01<00:04, 16.80it/s] 20%|██        | 20/100 [00:01<00:04, 16.80it/s] 22%|██▏       | 22/100 [00:01<00:04, 16.80it/s] 24%|██▍       | 24/100 [00:01<00:04, 16.79it/s] 26%|██▌       | 26/100 [00:01<00:04, 16.80it/s] 28%|██▊       | 28/100 [00:01<00:04, 16.78it/s] 30%|███       | 30/100 [00:01<00:04, 16.79it/s] 32%|███▏      | 32/100 [00:01<00:04, 16.79it/s] 34%|███▍      | 34/100 [00:02<00:03, 16.79it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.79it/s] 38%|███▊      | 38/100 [00:02<00:03, 16.80it/s] 40%|████      | 40/100 [00:02<00:03, 16.80it/s] 42%|████▏     | 42/100 [00:02<00:03, 16.80it/s] 44%|████▍     | 44/100 [00:02<00:03, 16.80it/s] 46%|████▌     | 46/100 [00:02<00:03, 16.80it/s] 48%|████▊     | 48/100 [00:02<00:03, 16.80it/s] 50%|█████     | 50/100 [00:02<00:02, 16.81it/s] 52%|█████▏    | 52/100 [00:03<00:02, 16.81it/s] 54%|█████▍    | 54/100 [00:03<00:02, 16.80it/s] 56%|█████▌    | 56/100 [00:03<00:02, 16.80it/s] 58%|█████▊    | 58/100 [00:03<00:02, 16.81it/s] 60%|██████    | 60/100 [00:03<00:02, 16.81it/s] 62%|██████▏   | 62/100 [00:03<00:02, 16.81it/s] 64%|██████▍   | 64/100 [00:03<00:02, 16.81it/s] 66%|██████▌   | 66/100 [00:03<00:02, 16.81it/s] 68%|██████▊   | 68/100 [00:04<00:01, 16.80it/s] 70%|███████   | 70/100 [00:04<00:01, 16.82it/s] 72%|███████▏  | 72/100 [00:04<00:01, 16.83it/s] 74%|███████▍  | 74/100 [00:04<00:01, 16.83it/s] 76%|███████▌  | 76/100 [00:04<00:01, 16.82it/s] 78%|███████▊  | 78/100 [00:04<00:01, 16.82it/s] 80%|████████  | 80/100 [00:04<00:01, 16.82it/s] 82%|████████▏ | 82/100 [00:04<00:01, 16.83it/s] 84%|████████▍ | 84/100 [00:04<00:00, 16.84it/s] 86%|████████▌ | 86/100 [00:05<00:00, 16.76it/s] 88%|████████▊ | 88/100 [00:05<00:00, 16.77it/s] 90%|█████████ | 90/100 [00:05<00:00, 16.79it/s] 92%|█████████▏| 92/100 [00:05<00:00, 16.79it/s] 94%|█████████▍| 94/100 [00:05<00:00, 16.80it/s] 96%|█████████▌| 96/100 [00:05<00:00, 16.79it/s] 98%|█████████▊| 98/100 [00:05<00:00, 16.78it/s]100%|██████████| 100/100 [00:05<00:00, 16.77it/s]100%|██████████| 100/100 [00:05<00:00, 16.80it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 356.54it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  14%|█▍        | 14/100 [00:00<00:00, 100.11 examples/s]Map:  37%|███▋      | 37/100 [00:00<00:00, 158.37 examples/s]Map:  63%|██████▎   | 63/100 [00:00<00:00, 162.26 examples/s]Map:  83%|████████▎ | 83/100 [00:00<00:00, 171.74 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.88it/s]  2%|▏         | 2/100 [00:00<00:12,  8.08it/s]  3%|▎         | 3/100 [00:00<00:12,  7.98it/s]  4%|▍         | 4/100 [00:00<00:11,  8.09it/s]  5%|▌         | 5/100 [00:00<00:11,  8.13it/s]  6%|▌         | 6/100 [00:00<00:11,  8.14it/s]  7%|▋         | 7/100 [00:00<00:11,  8.03it/s]  8%|▊         | 8/100 [00:00<00:11,  8.04it/s]  9%|▉         | 9/100 [00:01<00:11,  7.86it/s] 10%|█         | 10/100 [00:01<00:11,  7.88it/s] 11%|█         | 11/100 [00:01<00:11,  7.89it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.74it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.84it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.69it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.81it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.62it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.70it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.68it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.71it/s] 20%|██        | 20/100 [00:02<00:10,  7.81it/s] 21%|██        | 21/100 [00:02<00:10,  7.86it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.75it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.83it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.88it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.91it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.93it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.73it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.79it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.86it/s] 30%|███       | 30/100 [00:03<00:08,  7.81it/s] 31%|███       | 31/100 [00:03<00:08,  7.87it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.77it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.78it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.75it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.83it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.87it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.76it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.80it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.60it/s] 40%|████      | 40/100 [00:05<00:07,  7.71it/s] 41%|████      | 41/100 [00:05<00:07,  7.76it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.86it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.89it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.82it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.86it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.85it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.88it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.76it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.74it/s] 50%|█████     | 50/100 [00:06<00:06,  7.83it/s] 51%|█████     | 51/100 [00:06<00:06,  7.72it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.77it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.85it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.84it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.89it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.70it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.81it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.87it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.90it/s] 60%|██████    | 60/100 [00:07<00:05,  7.79it/s] 61%|██████    | 61/100 [00:07<00:04,  7.84it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.70it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.64it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.69it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.79it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.85it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.73it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.78it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.76it/s] 70%|███████   | 70/100 [00:08<00:03,  7.84it/s] 71%|███████   | 71/100 [00:09<00:03,  7.73it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.78it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.83it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.69it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.79it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.73it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.72it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.77it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.84it/s] 80%|████████  | 80/100 [00:10<00:02,  7.59it/s] 81%|████████  | 81/100 [00:10<00:02,  7.45it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.58it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.72it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.71it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.80it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.80it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.86it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.71it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.53it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.68it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.81it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.69it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.72it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.81it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.81it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.76it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.84it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.80it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.72it/s]100%|██████████| 100/100 [00:12<00:00,  7.80it/s]100%|██████████| 100/100 [00:12<00:00,  7.79it/s]
FOLD 1
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.286765  0.551445  5.742266     3.683556
[0.27663419 0.54088836 5.42621094 3.42374863]
MC1 Score: 0.2766341866820078, MC2 Score: 0.5408883577254406, CE Loss: 5.4262109375000005, KL wrt Original: 3.4237486338615417
2023-11-01 13:32:49.341993: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 13:32:49.390447: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 13:32:50.153791: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 346.89it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.26it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.03it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.90it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 463.10it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.07it/s]  6%|▋         | 2/32 [00:00<00:14,  2.09it/s]  9%|▉         | 3/32 [00:01<00:14,  2.00it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.00it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.95it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.89it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.84it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.82it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.75it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.66it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.62it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.60it/s] 41%|████      | 13/32 [00:07<00:12,  1.58it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.56it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.52it/s] 50%|█████     | 16/32 [00:09<00:10,  1.51it/s] 53%|█████▎    | 17/32 [00:10<00:10,  1.49it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.48it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.42it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:13<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.41it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.44it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.42it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.44it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.45it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.46it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.47it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.49it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.51it/s]100%|██████████| 32/32 [00:20<00:00,  1.39it/s]100%|██████████| 32/32 [00:20<00:00,  1.55it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.57191201 0.58375635 0.57191201 ... 0.57191201 0.57191201 0.57191201]
 [0.57360406 0.57191201 0.57191201 ... 0.59221658 0.57360406 0.57191201]
 [0.57191201 0.58883249 0.70389171 ... 0.60913706 0.57191201 0.59052453]
 ...
 [0.71235195 0.5820643  0.59898477 ... 0.62436548 0.58037225 0.57529611]
 [0.71573604 0.59729272 0.59052453 ... 0.58714044 0.67005076 0.57191201]
 [0.6142132  0.67174281 0.70389171 ... 0.60913706 0.66497462 0.68527919]]
Heads intervened:  [(6, 1), (9, 11), (9, 20), (9, 29), (10, 1), (10, 17), (10, 22), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (12, 3), (12, 14), (12, 21), (13, 11), (13, 16), (13, 22), (13, 30), (14, 4), (14, 5), (14, 12), (14, 14), (14, 18), (14, 22), (15, 3), (15, 20), (15, 21), (15, 24), (15, 28), (16, 1), (16, 17), (16, 26), (17, 1), (17, 21), (17, 31), (18, 9), (18, 10), (18, 17), (19, 6), (20, 19), (20, 30), (22, 4), (22, 11), (22, 13), (23, 18), (24, 20)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/409 [00:00<?, ?it/s]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 1/409 [00:01<09:18,  1.37s/it]  0%|          | 2/409 [00:02<07:40,  1.13s/it]  1%|          | 3/409 [00:03<06:22,  1.06it/s]  1%|          | 4/409 [00:03<06:08,  1.10it/s]  1%|          | 5/409 [00:04<06:32,  1.03it/s]  1%|▏         | 6/409 [00:06<06:45,  1.01s/it]  2%|▏         | 7/409 [00:06<05:50,  1.15it/s]  2%|▏         | 8/409 [00:08<07:18,  1.09s/it]  2%|▏         | 9/409 [00:10<08:49,  1.32s/it]  2%|▏         | 10/409 [00:11<08:01,  1.21s/it]  3%|▎         | 11/409 [00:11<07:15,  1.10s/it]  3%|▎         | 12/409 [00:12<06:16,  1.06it/s]  3%|▎         | 13/409 [00:13<05:34,  1.18it/s]  3%|▎         | 14/409 [00:13<05:04,  1.30it/s]  4%|▎         | 15/409 [00:14<05:24,  1.21it/s]  4%|▍         | 16/409 [00:15<05:26,  1.20it/s]  4%|▍         | 17/409 [00:16<06:12,  1.05it/s]  4%|▍         | 18/409 [00:18<06:55,  1.06s/it]  5%|▍         | 19/409 [00:18<06:17,  1.03it/s]  5%|▍         | 20/409 [00:19<06:32,  1.01s/it]  5%|▌         | 21/409 [00:20<06:01,  1.07it/s]  5%|▌         | 22/409 [00:21<06:48,  1.05s/it]  6%|▌         | 23/409 [00:23<07:09,  1.11s/it]  6%|▌         | 24/409 [00:24<06:53,  1.07s/it]  6%|▌         | 25/409 [00:25<07:09,  1.12s/it]  6%|▋         | 26/409 [00:26<07:14,  1.13s/it]  7%|▋         | 27/409 [00:27<06:39,  1.05s/it]  7%|▋         | 28/409 [00:28<07:37,  1.20s/it]  7%|▋         | 29/409 [00:30<07:33,  1.19s/it]  7%|▋         | 30/409 [00:30<06:39,  1.05s/it]  8%|▊         | 31/409 [00:31<06:25,  1.02s/it]  8%|▊         | 32/409 [00:32<06:20,  1.01s/it]  8%|▊         | 33/409 [00:34<06:44,  1.07s/it]  8%|▊         | 34/409 [00:34<05:50,  1.07it/s]  9%|▊         | 35/409 [00:35<06:06,  1.02it/s]  9%|▉         | 36/409 [00:36<06:03,  1.02it/s]  9%|▉         | 37/409 [00:37<05:22,  1.15it/s]  9%|▉         | 38/409 [00:38<05:09,  1.20it/s] 10%|▉         | 39/409 [00:38<05:09,  1.20it/s] 10%|▉         | 40/409 [00:39<04:56,  1.24it/s] 10%|█         | 41/409 [00:41<06:04,  1.01it/s] 10%|█         | 42/409 [00:41<05:48,  1.05it/s] 11%|█         | 43/409 [00:42<05:37,  1.08it/s] 11%|█         | 44/409 [00:43<05:51,  1.04it/s] 11%|█         | 45/409 [00:44<06:07,  1.01s/it] 11%|█         | 46/409 [00:46<06:13,  1.03s/it] 11%|█▏        | 47/409 [00:46<05:26,  1.11it/s] 12%|█▏        | 48/409 [00:47<05:34,  1.08it/s] 12%|█▏        | 49/409 [00:48<06:16,  1.05s/it] 12%|█▏        | 50/409 [00:49<05:57,  1.00it/s] 12%|█▏        | 51/409 [00:51<06:33,  1.10s/it] 13%|█▎        | 52/409 [00:52<06:29,  1.09s/it] 13%|█▎        | 53/409 [00:52<05:22,  1.10it/s] 13%|█▎        | 54/409 [00:53<05:28,  1.08it/s] 13%|█▎        | 55/409 [00:54<04:53,  1.21it/s] 14%|█▎        | 56/409 [00:55<04:43,  1.24it/s] 14%|█▍        | 57/409 [00:55<04:58,  1.18it/s] 14%|█▍        | 58/409 [00:57<06:00,  1.03s/it] 14%|█▍        | 59/409 [00:58<05:18,  1.10it/s] 15%|█▍        | 60/409 [00:59<05:34,  1.04it/s] 15%|█▍        | 61/409 [00:59<04:32,  1.28it/s] 15%|█▌        | 62/409 [01:00<04:12,  1.37it/s] 15%|█▌        | 63/409 [01:01<05:26,  1.06it/s] 16%|█▌        | 64/409 [01:01<04:12,  1.37it/s] 16%|█▌        | 65/409 [01:02<03:46,  1.52it/s] 16%|█▌        | 66/409 [01:03<05:02,  1.13it/s] 16%|█▋        | 67/409 [01:05<05:59,  1.05s/it] 17%|█▋        | 68/409 [01:05<05:01,  1.13it/s] 17%|█▋        | 69/409 [01:06<04:57,  1.14it/s] 17%|█▋        | 70/409 [01:07<05:02,  1.12it/s] 17%|█▋        | 71/409 [01:08<04:43,  1.19it/s] 18%|█▊        | 72/409 [01:09<05:29,  1.02it/s] 18%|█▊        | 73/409 [01:10<05:26,  1.03it/s] 18%|█▊        | 74/409 [01:11<04:59,  1.12it/s] 18%|█▊        | 75/409 [01:12<05:52,  1.05s/it] 19%|█▊        | 76/409 [01:13<05:57,  1.07s/it] 19%|█▉        | 77/409 [01:14<05:41,  1.03s/it] 19%|█▉        | 78/409 [01:15<05:21,  1.03it/s] 19%|█▉        | 79/409 [01:16<05:40,  1.03s/it] 20%|█▉        | 80/409 [01:17<05:09,  1.06it/s] 20%|█▉        | 81/409 [01:18<05:11,  1.05it/s] 20%|██        | 82/409 [01:19<04:59,  1.09it/s] 20%|██        | 83/409 [01:19<04:41,  1.16it/s] 21%|██        | 84/409 [01:20<04:39,  1.16it/s] 21%|██        | 85/409 [01:21<05:00,  1.08it/s] 21%|██        | 86/409 [01:22<04:50,  1.11it/s] 21%|██▏       | 87/409 [01:23<05:07,  1.05it/s] 22%|██▏       | 88/409 [01:25<05:41,  1.06s/it] 22%|██▏       | 89/409 [01:25<04:59,  1.07it/s] 22%|██▏       | 90/409 [01:26<04:39,  1.14it/s] 22%|██▏       | 91/409 [01:27<05:06,  1.04it/s] 22%|██▏       | 92/409 [01:28<04:31,  1.17it/s] 23%|██▎       | 93/409 [01:28<04:18,  1.22it/s] 23%|██▎       | 94/409 [01:29<03:47,  1.38it/s] 23%|██▎       | 95/409 [01:30<04:07,  1.27it/s] 23%|██▎       | 96/409 [01:31<04:21,  1.20it/s] 24%|██▎       | 97/409 [01:32<04:26,  1.17it/s] 24%|██▍       | 98/409 [01:32<04:11,  1.23it/s] 24%|██▍       | 99/409 [01:33<04:03,  1.27it/s] 24%|██▍       | 100/409 [01:34<03:57,  1.30it/s] 25%|██▍       | 101/409 [01:35<04:25,  1.16it/s] 25%|██▍       | 102/409 [01:36<04:22,  1.17it/s] 25%|██▌       | 103/409 [01:37<04:42,  1.08it/s] 25%|██▌       | 104/409 [01:38<04:48,  1.06it/s] 26%|██▌       | 105/409 [01:39<04:42,  1.08it/s] 26%|██▌       | 106/409 [01:40<04:32,  1.11it/s] 26%|██▌       | 107/409 [01:40<03:43,  1.35it/s] 26%|██▋       | 108/409 [01:41<03:30,  1.43it/s] 27%|██▋       | 109/409 [01:41<03:32,  1.41it/s] 27%|██▋       | 110/409 [01:42<03:32,  1.40it/s] 27%|██▋       | 111/409 [01:43<04:06,  1.21it/s] 27%|██▋       | 112/409 [01:44<04:06,  1.21it/s] 28%|██▊       | 113/409 [01:45<04:38,  1.06it/s] 28%|██▊       | 114/409 [01:46<04:15,  1.16it/s] 28%|██▊       | 115/409 [01:47<04:22,  1.12it/s] 28%|██▊       | 116/409 [01:48<05:08,  1.05s/it] 29%|██▊       | 117/409 [01:49<05:19,  1.10s/it] 29%|██▉       | 118/409 [01:50<04:27,  1.09it/s] 29%|██▉       | 119/409 [01:51<04:30,  1.07it/s] 29%|██▉       | 120/409 [01:52<04:32,  1.06it/s] 30%|██▉       | 121/409 [01:53<04:34,  1.05it/s] 30%|██▉       | 122/409 [01:54<05:29,  1.15s/it] 30%|███       | 123/409 [01:55<04:51,  1.02s/it] 30%|███       | 124/409 [01:56<04:35,  1.03it/s] 31%|███       | 125/409 [01:57<04:24,  1.07it/s] 31%|███       | 126/409 [01:58<04:05,  1.15it/s] 31%|███       | 127/409 [01:58<04:01,  1.17it/s] 31%|███▏      | 128/409 [01:59<03:50,  1.22it/s] 32%|███▏      | 129/409 [02:00<04:04,  1.15it/s] 32%|███▏      | 130/409 [02:01<03:49,  1.22it/s] 32%|███▏      | 131/409 [02:01<03:30,  1.32it/s] 32%|███▏      | 132/409 [02:02<03:23,  1.36it/s] 33%|███▎      | 133/409 [02:03<03:10,  1.45it/s] 33%|███▎      | 134/409 [02:04<03:41,  1.24it/s] 33%|███▎      | 135/409 [02:05<03:43,  1.23it/s] 33%|███▎      | 136/409 [02:05<03:26,  1.32it/s] 33%|███▎      | 137/409 [02:06<03:45,  1.21it/s] 34%|███▎      | 138/409 [02:07<04:14,  1.06it/s] 34%|███▍      | 139/409 [02:09<04:45,  1.06s/it] 34%|███▍      | 140/409 [02:09<03:57,  1.13it/s] 34%|███▍      | 141/409 [02:10<03:23,  1.31it/s] 35%|███▍      | 142/409 [02:10<03:10,  1.40it/s] 35%|███▍      | 143/409 [02:12<04:14,  1.05it/s] 35%|███▌      | 144/409 [02:13<04:31,  1.03s/it] 35%|███▌      | 145/409 [02:14<04:26,  1.01s/it] 36%|███▌      | 146/409 [02:15<04:05,  1.07it/s] 36%|███▌      | 147/409 [02:16<04:05,  1.07it/s] 36%|███▌      | 148/409 [02:16<03:48,  1.14it/s] 36%|███▋      | 149/409 [02:17<03:43,  1.16it/s] 37%|███▋      | 150/409 [02:18<03:41,  1.17it/s] 37%|███▋      | 151/409 [02:19<03:29,  1.23it/s] 37%|███▋      | 152/409 [02:20<03:48,  1.13it/s] 37%|███▋      | 153/409 [02:21<03:51,  1.11it/s] 38%|███▊      | 154/409 [02:21<03:08,  1.35it/s] 38%|███▊      | 155/409 [02:22<02:49,  1.50it/s] 38%|███▊      | 156/409 [02:23<03:11,  1.32it/s] 38%|███▊      | 157/409 [02:23<03:09,  1.33it/s] 39%|███▊      | 158/409 [02:24<03:14,  1.29it/s] 39%|███▉      | 159/409 [02:25<03:39,  1.14it/s] 39%|███▉      | 160/409 [02:26<03:45,  1.10it/s] 39%|███▉      | 161/409 [02:27<04:07,  1.00it/s] 40%|███▉      | 162/409 [02:28<03:46,  1.09it/s] 40%|███▉      | 163/409 [02:30<05:25,  1.32s/it] 40%|████      | 164/409 [02:32<05:06,  1.25s/it] 40%|████      | 165/409 [02:33<05:10,  1.27s/it] 41%|████      | 166/409 [02:34<04:58,  1.23s/it] 41%|████      | 167/409 [02:35<04:38,  1.15s/it] 41%|████      | 168/409 [02:36<05:02,  1.25s/it] 41%|████▏     | 169/409 [02:38<05:07,  1.28s/it] 42%|████▏     | 170/409 [02:39<04:43,  1.18s/it] 42%|████▏     | 171/409 [02:40<04:17,  1.08s/it] 42%|████▏     | 172/409 [02:41<04:27,  1.13s/it] 42%|████▏     | 173/409 [02:42<03:57,  1.01s/it] 43%|████▎     | 174/409 [02:43<03:52,  1.01it/s] 43%|████▎     | 175/409 [02:44<04:14,  1.09s/it] 43%|████▎     | 176/409 [02:44<03:39,  1.06it/s] 43%|████▎     | 177/409 [02:46<04:04,  1.05s/it] 44%|████▎     | 178/409 [02:47<03:47,  1.02it/s] 44%|████▍     | 179/409 [02:48<04:01,  1.05s/it] 44%|████▍     | 180/409 [02:49<03:41,  1.03it/s] 44%|████▍     | 181/409 [02:49<03:16,  1.16it/s] 44%|████▍     | 182/409 [02:50<03:05,  1.22it/s] 45%|████▍     | 183/409 [02:51<02:59,  1.26it/s] 45%|████▍     | 184/409 [02:52<03:03,  1.23it/s] 45%|████▌     | 185/409 [02:53<03:19,  1.12it/s] 45%|████▌     | 186/409 [02:54<03:41,  1.00it/s] 46%|████▌     | 187/409 [02:55<03:36,  1.03it/s] 46%|████▌     | 188/409 [02:55<03:19,  1.11it/s] 46%|████▌     | 189/409 [02:56<03:05,  1.19it/s] 46%|████▋     | 190/409 [02:57<03:04,  1.19it/s] 47%|████▋     | 191/409 [02:58<03:03,  1.19it/s] 47%|████▋     | 192/409 [02:59<03:10,  1.14it/s] 47%|████▋     | 193/409 [03:00<03:13,  1.11it/s] 47%|████▋     | 194/409 [03:00<03:02,  1.18it/s] 48%|████▊     | 195/409 [03:01<03:04,  1.16it/s] 48%|████▊     | 196/409 [03:02<03:15,  1.09it/s] 48%|████▊     | 197/409 [03:04<03:38,  1.03s/it] 48%|████▊     | 198/409 [03:05<03:32,  1.01s/it] 49%|████▊     | 199/409 [03:05<03:06,  1.13it/s] 49%|████▉     | 200/409 [03:06<03:17,  1.06it/s] 49%|████▉     | 201/409 [03:07<03:05,  1.12it/s] 49%|████▉     | 202/409 [03:08<03:08,  1.10it/s] 50%|████▉     | 203/409 [03:09<02:40,  1.28it/s] 50%|████▉     | 204/409 [03:09<02:43,  1.25it/s] 50%|█████     | 205/409 [03:11<03:21,  1.01it/s] 50%|█████     | 206/409 [03:11<02:59,  1.13it/s] 51%|█████     | 207/409 [03:12<03:01,  1.11it/s] 51%|█████     | 208/409 [03:13<02:49,  1.19it/s] 51%|█████     | 209/409 [03:14<02:40,  1.24it/s] 51%|█████▏    | 210/409 [03:15<02:51,  1.16it/s] 52%|█████▏    | 211/409 [03:15<02:34,  1.28it/s] 52%|█████▏    | 212/409 [03:16<02:22,  1.38it/s] 52%|█████▏    | 213/409 [03:17<02:43,  1.20it/s] 52%|█████▏    | 214/409 [03:18<02:55,  1.11it/s] 53%|█████▎    | 215/409 [03:19<02:43,  1.18it/s] 53%|█████▎    | 216/409 [03:21<04:08,  1.29s/it] 53%|█████▎    | 217/409 [03:22<03:26,  1.08s/it] 53%|█████▎    | 218/409 [03:22<02:50,  1.12it/s] 54%|█████▎    | 219/409 [03:23<02:39,  1.19it/s] 54%|█████▍    | 220/409 [03:24<02:31,  1.24it/s] 54%|█████▍    | 221/409 [03:24<02:26,  1.28it/s] 54%|█████▍    | 222/409 [03:25<02:29,  1.25it/s] 55%|█████▍    | 223/409 [03:26<02:31,  1.23it/s] 55%|█████▍    | 224/409 [03:27<02:32,  1.22it/s] 55%|█████▌    | 225/409 [03:28<02:20,  1.31it/s] 55%|█████▌    | 226/409 [03:28<02:24,  1.26it/s] 56%|█████▌    | 227/409 [03:29<02:13,  1.36it/s] 56%|█████▌    | 228/409 [03:30<02:38,  1.14it/s] 56%|█████▌    | 229/409 [03:31<02:15,  1.33it/s] 56%|█████▌    | 230/409 [03:32<02:19,  1.28it/s] 56%|█████▋    | 231/409 [03:32<02:22,  1.25it/s] 57%|█████▋    | 232/409 [03:34<02:43,  1.08it/s] 57%|█████▋    | 233/409 [03:34<02:33,  1.15it/s] 57%|█████▋    | 234/409 [03:35<02:23,  1.22it/s] 57%|█████▋    | 235/409 [03:36<02:10,  1.34it/s] 58%|█████▊    | 236/409 [03:36<02:13,  1.30it/s] 58%|█████▊    | 237/409 [03:37<01:57,  1.47it/s] 58%|█████▊    | 238/409 [03:38<02:22,  1.20it/s] 58%|█████▊    | 239/409 [03:40<03:15,  1.15s/it] 59%|█████▊    | 240/409 [03:41<02:52,  1.02s/it] 59%|█████▉    | 241/409 [03:42<02:44,  1.02it/s] 59%|█████▉    | 242/409 [03:43<02:52,  1.03s/it] 59%|█████▉    | 243/409 [03:44<02:36,  1.06it/s] 60%|█████▉    | 244/409 [03:45<02:54,  1.06s/it] 60%|█████▉    | 245/409 [03:45<02:30,  1.09it/s] 60%|██████    | 246/409 [03:46<02:07,  1.28it/s] 60%|██████    | 247/409 [03:47<02:14,  1.21it/s] 61%|██████    | 248/409 [03:48<02:13,  1.21it/s] 61%|██████    | 249/409 [03:48<02:07,  1.26it/s] 61%|██████    | 250/409 [03:49<02:14,  1.18it/s] 61%|██████▏   | 251/409 [03:51<03:02,  1.16s/it] 62%|██████▏   | 252/409 [03:52<02:47,  1.06s/it] 62%|██████▏   | 253/409 [03:53<03:00,  1.16s/it] 62%|██████▏   | 254/409 [03:54<02:43,  1.06s/it] 62%|██████▏   | 255/409 [03:55<02:50,  1.11s/it] 63%|██████▎   | 256/409 [03:56<02:37,  1.03s/it] 63%|██████▎   | 257/409 [03:57<02:33,  1.01s/it] 63%|██████▎   | 258/409 [03:58<02:07,  1.18it/s] 63%|██████▎   | 259/409 [03:59<02:05,  1.19it/s] 64%|██████▎   | 260/409 [04:00<02:26,  1.02it/s] 64%|██████▍   | 261/409 [04:01<02:23,  1.03it/s] 64%|██████▍   | 262/409 [04:01<02:01,  1.21it/s] 64%|██████▍   | 263/409 [04:02<02:06,  1.15it/s] 65%|██████▍   | 264/409 [04:03<01:49,  1.33it/s] 65%|██████▍   | 265/409 [04:03<01:46,  1.36it/s] 65%|██████▌   | 266/409 [04:05<02:03,  1.16it/s] 65%|██████▌   | 267/409 [04:06<02:06,  1.12it/s] 66%|██████▌   | 268/409 [04:06<01:53,  1.24it/s] 66%|██████▌   | 269/409 [04:07<01:54,  1.22it/s] 66%|██████▌   | 270/409 [04:08<02:08,  1.09it/s] 66%|██████▋   | 271/409 [04:09<01:59,  1.16it/s] 67%|██████▋   | 272/409 [04:10<02:25,  1.06s/it] 67%|██████▋   | 273/409 [04:11<02:09,  1.05it/s] 67%|██████▋   | 274/409 [04:12<02:18,  1.03s/it] 67%|██████▋   | 275/409 [04:14<02:57,  1.32s/it] 67%|██████▋   | 276/409 [04:15<02:41,  1.21s/it] 68%|██████▊   | 277/409 [04:16<02:20,  1.06s/it] 68%|██████▊   | 278/409 [04:17<02:21,  1.08s/it] 68%|██████▊   | 279/409 [04:18<02:11,  1.01s/it] 68%|██████▊   | 280/409 [04:19<01:53,  1.13it/s] 69%|██████▊   | 281/409 [04:19<01:50,  1.15it/s] 69%|██████▉   | 282/409 [04:20<01:48,  1.17it/s] 69%|██████▉   | 283/409 [04:22<02:15,  1.07s/it] 69%|██████▉   | 284/409 [04:23<02:19,  1.12s/it] 70%|██████▉   | 285/409 [04:24<01:55,  1.08it/s] 70%|██████▉   | 286/409 [04:24<01:37,  1.27it/s] 70%|███████   | 287/409 [04:25<01:37,  1.25it/s] 70%|███████   | 288/409 [04:26<01:34,  1.29it/s] 71%|███████   | 289/409 [04:26<01:26,  1.38it/s] 71%|███████   | 290/409 [04:27<01:25,  1.39it/s] 71%|███████   | 291/409 [04:28<01:37,  1.21it/s] 71%|███████▏  | 292/409 [04:29<01:32,  1.26it/s] 72%|███████▏  | 293/409 [04:29<01:33,  1.25it/s] 72%|███████▏  | 294/409 [04:31<01:45,  1.09it/s] 72%|███████▏  | 295/409 [04:32<01:41,  1.12it/s] 72%|███████▏  | 296/409 [04:32<01:23,  1.36it/s] 73%|███████▎  | 297/409 [04:33<01:30,  1.24it/s] 73%|███████▎  | 298/409 [04:34<01:43,  1.08it/s] 73%|███████▎  | 299/409 [04:35<01:50,  1.00s/it] 73%|███████▎  | 300/409 [04:37<02:03,  1.13s/it] 74%|███████▎  | 301/409 [04:38<02:00,  1.11s/it] 74%|███████▍  | 302/409 [04:39<02:12,  1.24s/it] 74%|███████▍  | 303/409 [04:41<02:22,  1.35s/it] 74%|███████▍  | 304/409 [04:41<01:53,  1.08s/it] 75%|███████▍  | 305/409 [04:42<01:48,  1.05s/it] 75%|███████▍  | 306/409 [04:43<01:44,  1.01s/it] 75%|███████▌  | 307/409 [04:45<01:52,  1.10s/it] 75%|███████▌  | 308/409 [04:45<01:39,  1.01it/s] 76%|███████▌  | 309/409 [04:46<01:30,  1.10it/s] 76%|███████▌  | 310/409 [04:47<01:36,  1.02it/s] 76%|███████▌  | 311/409 [04:48<01:35,  1.03it/s] 76%|███████▋  | 312/409 [04:49<01:33,  1.04it/s] 77%|███████▋  | 313/409 [04:50<01:25,  1.12it/s] 77%|███████▋  | 314/409 [04:51<01:35,  1.00s/it] 77%|███████▋  | 315/409 [04:52<01:40,  1.07s/it] 77%|███████▋  | 316/409 [04:53<01:19,  1.17it/s] 78%|███████▊  | 317/409 [04:54<01:31,  1.00it/s] 78%|███████▊  | 318/409 [04:55<01:32,  1.02s/it] 78%|███████▊  | 319/409 [04:56<01:30,  1.01s/it] 78%|███████▊  | 320/409 [04:57<01:25,  1.04it/s] 78%|███████▊  | 321/409 [04:57<01:15,  1.16it/s] 79%|███████▊  | 322/409 [04:58<01:14,  1.17it/s] 79%|███████▉  | 323/409 [04:59<01:16,  1.13it/s] 79%|███████▉  | 324/409 [05:00<01:04,  1.31it/s] 79%|███████▉  | 325/409 [05:00<00:59,  1.40it/s] 80%|███████▉  | 326/409 [05:01<00:56,  1.46it/s] 80%|███████▉  | 327/409 [05:02<00:53,  1.52it/s] 80%|████████  | 328/409 [05:02<00:52,  1.55it/s] 80%|████████  | 329/409 [05:03<00:59,  1.35it/s] 81%|████████  | 330/409 [05:04<01:03,  1.24it/s] 81%|████████  | 331/409 [05:05<01:03,  1.23it/s] 81%|████████  | 332/409 [05:06<01:19,  1.03s/it] 81%|████████▏ | 333/409 [05:07<01:16,  1.00s/it] 82%|████████▏ | 334/409 [05:08<01:17,  1.03s/it] 82%|████████▏ | 335/409 [05:10<01:28,  1.19s/it] 82%|████████▏ | 336/409 [05:11<01:27,  1.20s/it] 82%|████████▏ | 337/409 [05:12<01:13,  1.02s/it] 83%|████████▎ | 338/409 [05:12<01:00,  1.17it/s] 83%|████████▎ | 339/409 [05:13<00:54,  1.29it/s] 83%|████████▎ | 340/409 [05:13<00:44,  1.53it/s] 83%|████████▎ | 341/409 [05:14<00:35,  1.90it/s] 84%|████████▎ | 342/409 [05:14<00:39,  1.71it/s] 84%|████████▍ | 343/409 [05:15<00:48,  1.37it/s] 84%|████████▍ | 344/409 [05:16<00:44,  1.45it/s] 84%|████████▍ | 345/409 [05:17<00:55,  1.14it/s] 85%|████████▍ | 346/409 [05:18<00:54,  1.16it/s] 85%|████████▍ | 347/409 [05:19<00:55,  1.12it/s] 85%|████████▌ | 348/409 [05:20<00:54,  1.13it/s] 85%|████████▌ | 349/409 [05:21<00:52,  1.14it/s] 86%|████████▌ | 350/409 [05:22<00:59,  1.01s/it] 86%|████████▌ | 351/409 [05:23<00:53,  1.09it/s] 86%|████████▌ | 352/409 [05:23<00:49,  1.16it/s] 86%|████████▋ | 353/409 [05:24<00:45,  1.22it/s] 87%|████████▋ | 354/409 [05:25<00:47,  1.16it/s] 87%|████████▋ | 355/409 [05:26<00:47,  1.13it/s] 87%|████████▋ | 356/409 [05:27<00:46,  1.14it/s] 87%|████████▋ | 357/409 [05:28<00:44,  1.16it/s] 88%|████████▊ | 358/409 [05:29<00:45,  1.12it/s] 88%|████████▊ | 359/409 [05:29<00:41,  1.20it/s] 88%|████████▊ | 360/409 [05:31<00:44,  1.10it/s] 88%|████████▊ | 361/409 [05:31<00:39,  1.22it/s] 89%|████████▊ | 362/409 [05:32<00:37,  1.26it/s] 89%|████████▉ | 363/409 [05:33<00:41,  1.10it/s] 89%|████████▉ | 364/409 [05:34<00:38,  1.16it/s] 89%|████████▉ | 365/409 [05:35<00:44,  1.01s/it] 89%|████████▉ | 366/409 [05:36<00:38,  1.12it/s] 90%|████████▉ | 367/409 [05:37<00:36,  1.14it/s] 90%|████████▉ | 368/409 [05:37<00:34,  1.20it/s] 90%|█████████ | 369/409 [05:38<00:35,  1.13it/s] 90%|█████████ | 370/409 [05:39<00:35,  1.10it/s] 91%|█████████ | 371/409 [05:40<00:36,  1.04it/s] 91%|█████████ | 372/409 [05:41<00:33,  1.12it/s] 91%|█████████ | 373/409 [05:42<00:31,  1.15it/s] 91%|█████████▏| 374/409 [05:43<00:30,  1.16it/s] 92%|█████████▏| 375/409 [05:44<00:30,  1.12it/s] 92%|█████████▏| 376/409 [05:45<00:32,  1.01it/s] 92%|█████████▏| 377/409 [05:46<00:30,  1.06it/s] 92%|█████████▏| 378/409 [05:47<00:28,  1.09it/s] 93%|█████████▎| 379/409 [05:48<00:28,  1.04it/s] 93%|█████████▎| 380/409 [05:49<00:27,  1.07it/s] 93%|█████████▎| 381/409 [05:50<00:25,  1.10it/s] 93%|█████████▎| 382/409 [05:51<00:27,  1.02s/it] 94%|█████████▎| 383/409 [05:51<00:23,  1.12it/s] 94%|█████████▍| 384/409 [05:53<00:25,  1.03s/it] 94%|█████████▍| 385/409 [05:53<00:19,  1.21it/s] 94%|█████████▍| 386/409 [05:53<00:14,  1.53it/s] 95%|█████████▍| 387/409 [05:54<00:12,  1.77it/s] 95%|█████████▍| 388/409 [05:54<00:12,  1.63it/s] 95%|█████████▌| 389/409 [05:55<00:12,  1.62it/s] 95%|█████████▌| 390/409 [05:56<00:13,  1.46it/s] 96%|█████████▌| 391/409 [05:56<00:11,  1.51it/s] 96%|█████████▌| 392/409 [05:57<00:10,  1.56it/s] 96%|█████████▌| 393/409 [05:58<00:13,  1.21it/s] 96%|█████████▋| 394/409 [05:59<00:12,  1.16it/s] 97%|█████████▋| 395/409 [06:00<00:13,  1.04it/s] 97%|█████████▋| 396/409 [06:01<00:11,  1.12it/s] 97%|█████████▋| 397/409 [06:02<00:11,  1.01it/s] 97%|█████████▋| 398/409 [06:03<00:10,  1.08it/s] 98%|█████████▊| 399/409 [06:04<00:08,  1.12it/s] 98%|█████████▊| 400/409 [06:05<00:07,  1.24it/s] 98%|█████████▊| 401/409 [06:06<00:07,  1.08it/s] 98%|█████████▊| 402/409 [06:07<00:06,  1.10it/s] 99%|█████████▊| 403/409 [06:08<00:05,  1.05it/s] 99%|█████████▉| 404/409 [06:09<00:05,  1.02s/it] 99%|█████████▉| 405/409 [06:10<00:04,  1.04s/it] 99%|█████████▉| 406/409 [06:11<00:03,  1.02s/it]100%|█████████▉| 407/409 [06:12<00:01,  1.07it/s]100%|█████████▉| 408/409 [06:13<00:00,  1.02it/s]100%|██████████| 409/409 [06:13<00:00,  1.19it/s]100%|██████████| 409/409 [06:13<00:00,  1.09it/s]
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:274: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
2023-11-01 13:39:43.206179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24017 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:17:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 270.81it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (2545 > 2048). Running this sequence through the model will result in indexing errors
Map:  10%|█         | 10/100 [00:00<00:00, 90.90 examples/s]Map:  28%|██▊       | 28/100 [00:00<00:00, 113.51 examples/s]Map:  44%|████▍     | 44/100 [00:00<00:00, 122.13 examples/s]Map:  69%|██████▉   | 69/100 [00:00<00:00, 152.89 examples/s]Map:  90%|█████████ | 90/100 [00:00<00:00, 134.86 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:07, 13.84it/s]  4%|▍         | 4/100 [00:00<00:06, 15.54it/s]  6%|▌         | 6/100 [00:00<00:05, 16.17it/s]  8%|▊         | 8/100 [00:00<00:05, 16.49it/s] 10%|█         | 10/100 [00:00<00:05, 16.67it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.77it/s] 14%|█▍        | 14/100 [00:00<00:05, 16.85it/s] 16%|█▌        | 16/100 [00:00<00:04, 16.91it/s] 18%|█▊        | 18/100 [00:01<00:04, 16.93it/s] 20%|██        | 20/100 [00:01<00:04, 16.96it/s] 22%|██▏       | 22/100 [00:01<00:04, 16.96it/s] 24%|██▍       | 24/100 [00:01<00:04, 16.97it/s] 26%|██▌       | 26/100 [00:01<00:04, 16.98it/s] 28%|██▊       | 28/100 [00:01<00:04, 16.98it/s] 30%|███       | 30/100 [00:01<00:04, 17.00it/s] 32%|███▏      | 32/100 [00:01<00:04, 16.99it/s] 34%|███▍      | 34/100 [00:02<00:03, 17.00it/s] 36%|███▌      | 36/100 [00:02<00:03, 17.00it/s] 38%|███▊      | 38/100 [00:02<00:03, 17.00it/s] 40%|████      | 40/100 [00:02<00:03, 16.99it/s] 42%|████▏     | 42/100 [00:02<00:03, 16.99it/s] 44%|████▍     | 44/100 [00:02<00:03, 16.99it/s] 46%|████▌     | 46/100 [00:02<00:03, 16.99it/s] 48%|████▊     | 48/100 [00:02<00:03, 17.00it/s] 50%|█████     | 50/100 [00:02<00:02, 17.01it/s] 52%|█████▏    | 52/100 [00:03<00:02, 17.01it/s] 54%|█████▍    | 54/100 [00:03<00:02, 17.00it/s] 56%|█████▌    | 56/100 [00:03<00:02, 17.00it/s] 58%|█████▊    | 58/100 [00:03<00:02, 17.00it/s] 60%|██████    | 60/100 [00:03<00:02, 16.99it/s] 62%|██████▏   | 62/100 [00:03<00:02, 16.99it/s] 64%|██████▍   | 64/100 [00:03<00:02, 16.99it/s] 66%|██████▌   | 66/100 [00:03<00:02, 16.98it/s] 68%|██████▊   | 68/100 [00:04<00:01, 16.99it/s] 70%|███████   | 70/100 [00:04<00:01, 17.00it/s] 72%|███████▏  | 72/100 [00:04<00:01, 17.02it/s] 74%|███████▍  | 74/100 [00:04<00:01, 17.02it/s] 76%|███████▌  | 76/100 [00:04<00:01, 17.02it/s] 78%|███████▊  | 78/100 [00:04<00:01, 17.02it/s] 80%|████████  | 80/100 [00:04<00:01, 17.02it/s] 82%|████████▏ | 82/100 [00:04<00:01, 17.02it/s] 84%|████████▍ | 84/100 [00:04<00:00, 17.01it/s] 86%|████████▌ | 86/100 [00:05<00:00, 17.01it/s] 88%|████████▊ | 88/100 [00:05<00:00, 17.00it/s] 90%|█████████ | 90/100 [00:05<00:00, 17.01it/s] 92%|█████████▏| 92/100 [00:05<00:00, 17.00it/s] 94%|█████████▍| 94/100 [00:05<00:00, 17.00it/s] 96%|█████████▌| 96/100 [00:05<00:00, 17.00it/s] 98%|█████████▊| 98/100 [00:05<00:00, 17.01it/s]100%|██████████| 100/100 [00:05<00:00, 17.01it/s]100%|██████████| 100/100 [00:05<00:00, 16.92it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 357.30it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  12%|█▏        | 12/100 [00:00<00:00, 106.97 examples/s]Map:  33%|███▎      | 33/100 [00:00<00:00, 110.62 examples/s]Map:  53%|█████▎    | 53/100 [00:00<00:00, 137.36 examples/s]Map:  73%|███████▎  | 73/100 [00:00<00:00, 156.84 examples/s]Map:  95%|█████████▌| 95/100 [00:00<00:00, 151.35 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.62it/s]  2%|▏         | 2/100 [00:00<00:12,  8.00it/s]  3%|▎         | 3/100 [00:00<00:11,  8.17it/s]  4%|▍         | 4/100 [00:00<00:11,  8.08it/s]  5%|▌         | 5/100 [00:00<00:11,  8.13it/s]  6%|▌         | 6/100 [00:00<00:11,  8.14it/s]  7%|▋         | 7/100 [00:00<00:11,  8.13it/s]  8%|▊         | 8/100 [00:01<00:11,  7.78it/s]  9%|▉         | 9/100 [00:01<00:11,  7.75it/s] 10%|█         | 10/100 [00:01<00:11,  7.82it/s] 11%|█         | 11/100 [00:01<00:11,  7.85it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.73it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.63it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.79it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.83it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.85it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.83it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.80it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.88it/s] 20%|██        | 20/100 [00:02<00:10,  7.76it/s] 21%|██        | 21/100 [00:02<00:10,  7.77it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.72it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.62it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.74it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.86it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.78it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.89it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.92it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.76it/s] 30%|███       | 30/100 [00:03<00:08,  7.82it/s] 31%|███       | 31/100 [00:03<00:08,  7.79it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.79it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.73it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.85it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.74it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.79it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.89it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.63it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.75it/s] 40%|████      | 40/100 [00:05<00:07,  7.86it/s] 41%|████      | 41/100 [00:05<00:07,  7.76it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.82it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.72it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.85it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.64it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.81it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.78it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.85it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.88it/s] 50%|█████     | 50/100 [00:06<00:06,  7.93it/s] 51%|█████     | 51/100 [00:06<00:06,  7.77it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.68it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.82it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.70it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.71it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.72it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.65it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.48it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.64it/s] 60%|██████    | 60/100 [00:07<00:05,  7.79it/s] 61%|██████    | 61/100 [00:07<00:05,  7.67it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.63it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.78it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.88it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.93it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.74it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.68it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.83it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.76it/s] 70%|███████   | 70/100 [00:08<00:03,  7.83it/s] 71%|███████   | 71/100 [00:09<00:03,  7.92it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.96it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.79it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.79it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.90it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.83it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.75it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.84it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.90it/s] 80%|████████  | 80/100 [00:10<00:02,  7.78it/s] 81%|████████  | 81/100 [00:10<00:02,  7.85it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.93it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.72it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.87it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.73it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.60it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.75it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.89it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.83it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.92it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.88it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.96it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.84it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.81it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.91it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.70it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.80it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.90it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.60it/s]100%|██████████| 100/100 [00:12<00:00,  7.68it/s]100%|██████████| 100/100 [00:12<00:00,  7.80it/s]
FOLD 0
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.286064  0.530286  5.812422     3.653687
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.11it/s]  6%|▋         | 2/32 [00:00<00:14,  2.14it/s]  9%|▉         | 3/32 [00:01<00:14,  2.03it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.03it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.98it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.93it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.87it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.83it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.74it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.66it/s] 34%|███▍      | 11/32 [00:06<00:13,  1.61it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.59it/s] 41%|████      | 13/32 [00:07<00:11,  1.60it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.57it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.55it/s] 50%|█████     | 16/32 [00:09<00:10,  1.53it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.52it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.51it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.44it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.42it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.45it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.43it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.43it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.46it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.51it/s] 91%|█████████ | 29/32 [00:18<00:01,  1.51it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.54it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.54it/s]100%|██████████| 32/32 [00:20<00:00,  1.41it/s]100%|██████████| 32/32 [00:20<00:00,  1.57it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.55285962 0.57365685 0.55285962 ... 0.55285962 0.55285962 0.55285962]
 [0.55285962 0.55285962 0.55285962 ... 0.60138648 0.55285962 0.55285962]
 [0.55285962 0.59965338 0.69844021 ... 0.59965338 0.55285962 0.6117851 ]
 ...
 [0.64644714 0.55632582 0.57019064 ... 0.63258232 0.55285962 0.54766031]
 [0.6932409  0.56672444 0.55632582 ... 0.56845754 0.65511265 0.55285962]
 [0.58578856 0.64298094 0.64471404 ... 0.63778163 0.63604853 0.63778163]]
Heads intervened:  [(6, 28), (7, 23), (8, 12), (9, 17), (9, 29), (10, 1), (10, 15), (10, 17), (10, 27), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 21), (11, 25), (11, 31), (12, 3), (12, 9), (12, 14), (13, 16), (13, 17), (13, 22), (14, 12), (14, 18), (14, 22), (15, 11), (15, 20), (15, 28), (16, 10), (16, 17), (16, 25), (16, 26), (17, 1), (17, 12), (17, 21), (17, 31), (18, 0), (18, 9), (18, 17), (18, 27), (19, 9), (19, 17), (20, 9), (20, 19), (20, 30), (24, 20), (31, 6)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/408 [00:00<?, ?it/s]  0%|          | 1/408 [00:01<11:23,  1.68s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 2/408 [00:02<09:30,  1.40s/it]  1%|          | 3/408 [00:03<08:24,  1.25s/it]  1%|          | 4/408 [00:05<09:51,  1.47s/it]  1%|          | 5/408 [00:06<07:46,  1.16s/it]  1%|▏         | 6/408 [00:07<07:01,  1.05s/it]  2%|▏         | 7/408 [00:07<05:20,  1.25it/s]  2%|▏         | 8/408 [00:08<05:38,  1.18it/s]  2%|▏         | 9/408 [00:08<04:53,  1.36it/s]  2%|▏         | 10/408 [00:09<04:37,  1.44it/s]  3%|▎         | 11/408 [00:10<05:58,  1.11it/s]  3%|▎         | 12/408 [00:11<05:53,  1.12it/s]  3%|▎         | 13/408 [00:12<05:34,  1.18it/s]  3%|▎         | 14/408 [00:13<05:48,  1.13it/s]  4%|▎         | 15/408 [00:14<05:34,  1.17it/s]  4%|▍         | 16/408 [00:14<05:16,  1.24it/s]  4%|▍         | 17/408 [00:15<04:51,  1.34it/s]  4%|▍         | 18/408 [00:16<05:19,  1.22it/s]  5%|▍         | 19/408 [00:17<04:42,  1.38it/s]  5%|▍         | 20/408 [00:17<04:13,  1.53it/s]  5%|▌         | 21/408 [00:18<05:27,  1.18it/s]  5%|▌         | 22/408 [00:19<05:25,  1.19it/s]  6%|▌         | 23/408 [00:21<07:30,  1.17s/it]  6%|▌         | 24/408 [00:22<07:04,  1.11s/it]  6%|▌         | 25/408 [00:23<07:14,  1.13s/it]  6%|▋         | 26/408 [00:24<07:08,  1.12s/it]  7%|▋         | 27/408 [00:25<06:38,  1.05s/it]  7%|▋         | 28/408 [00:26<05:47,  1.09it/s]  7%|▋         | 29/408 [00:27<06:50,  1.08s/it]  7%|▋         | 30/408 [00:28<06:09,  1.02it/s]  8%|▊         | 31/408 [00:30<07:06,  1.13s/it]  8%|▊         | 32/408 [00:31<06:52,  1.10s/it]  8%|▊         | 33/408 [00:31<06:20,  1.01s/it]  8%|▊         | 34/408 [00:33<06:45,  1.08s/it]  9%|▊         | 35/408 [00:34<06:21,  1.02s/it]  9%|▉         | 36/408 [00:34<04:53,  1.27it/s]  9%|▉         | 37/408 [00:34<04:45,  1.30it/s]  9%|▉         | 38/408 [00:35<04:28,  1.38it/s] 10%|▉         | 39/408 [00:36<04:13,  1.45it/s] 10%|▉         | 40/408 [00:37<05:12,  1.18it/s] 10%|█         | 41/408 [00:38<05:11,  1.18it/s] 10%|█         | 42/408 [00:39<05:08,  1.19it/s] 11%|█         | 43/408 [00:40<05:37,  1.08it/s] 11%|█         | 44/408 [00:41<05:53,  1.03it/s] 11%|█         | 45/408 [00:42<06:02,  1.00it/s] 11%|█▏        | 46/408 [00:43<06:56,  1.15s/it] 12%|█▏        | 47/408 [00:44<06:40,  1.11s/it] 12%|█▏        | 48/408 [00:45<06:33,  1.09s/it] 12%|█▏        | 49/408 [00:47<06:57,  1.16s/it] 12%|█▏        | 50/408 [00:48<06:51,  1.15s/it] 12%|█▎        | 51/408 [00:49<06:42,  1.13s/it] 13%|█▎        | 52/408 [00:50<06:11,  1.04s/it] 13%|█▎        | 53/408 [00:51<05:37,  1.05it/s] 13%|█▎        | 54/408 [00:52<06:02,  1.02s/it] 13%|█▎        | 55/408 [00:52<05:16,  1.12it/s] 14%|█▎        | 56/408 [00:53<05:12,  1.13it/s] 14%|█▍        | 57/408 [00:54<04:16,  1.37it/s] 14%|█▍        | 58/408 [00:55<05:47,  1.01it/s] 14%|█▍        | 59/408 [00:57<06:25,  1.10s/it] 15%|█▍        | 60/408 [00:58<06:49,  1.18s/it] 15%|█▍        | 61/408 [00:59<05:51,  1.01s/it] 15%|█▌        | 62/408 [00:59<05:33,  1.04it/s] 15%|█▌        | 63/408 [01:00<05:08,  1.12it/s] 16%|█▌        | 64/408 [01:01<04:50,  1.18it/s] 16%|█▌        | 65/408 [01:02<05:26,  1.05it/s] 16%|█▌        | 66/408 [01:03<04:38,  1.23it/s] 16%|█▋        | 67/408 [01:03<04:16,  1.33it/s] 17%|█▋        | 68/408 [01:04<04:11,  1.35it/s] 17%|█▋        | 69/408 [01:04<03:44,  1.51it/s] 17%|█▋        | 70/408 [01:05<04:12,  1.34it/s] 17%|█▋        | 71/408 [01:06<03:32,  1.59it/s] 18%|█▊        | 72/408 [01:07<05:29,  1.02it/s] 18%|█▊        | 73/408 [01:09<06:24,  1.15s/it] 18%|█▊        | 74/408 [01:09<05:17,  1.05it/s] 18%|█▊        | 75/408 [01:11<05:51,  1.06s/it] 19%|█▊        | 76/408 [01:11<05:18,  1.04it/s] 19%|█▉        | 77/408 [01:12<05:06,  1.08it/s] 19%|█▉        | 78/408 [01:13<05:07,  1.07it/s] 19%|█▉        | 79/408 [01:14<05:08,  1.06it/s] 20%|█▉        | 80/408 [01:15<05:30,  1.01s/it] 20%|█▉        | 81/408 [01:16<05:16,  1.03it/s] 20%|██        | 82/408 [01:17<04:51,  1.12it/s] 20%|██        | 83/408 [01:18<04:22,  1.24it/s] 21%|██        | 84/408 [01:19<05:05,  1.06it/s] 21%|██        | 85/408 [01:20<05:05,  1.06it/s] 21%|██        | 86/408 [01:21<05:52,  1.09s/it] 21%|██▏       | 87/408 [01:22<05:29,  1.03s/it] 22%|██▏       | 88/408 [01:23<05:46,  1.08s/it] 22%|██▏       | 89/408 [01:24<05:44,  1.08s/it] 22%|██▏       | 90/408 [01:25<04:48,  1.10it/s] 22%|██▏       | 91/408 [01:26<05:19,  1.01s/it] 23%|██▎       | 92/408 [01:27<05:03,  1.04it/s] 23%|██▎       | 93/408 [01:28<05:43,  1.09s/it] 23%|██▎       | 94/408 [01:29<05:43,  1.09s/it] 23%|██▎       | 95/408 [01:30<04:55,  1.06it/s] 24%|██▎       | 96/408 [01:31<04:32,  1.14it/s] 24%|██▍       | 97/408 [01:32<04:31,  1.15it/s] 24%|██▍       | 98/408 [01:33<04:49,  1.07it/s] 24%|██▍       | 99/408 [01:34<05:41,  1.11s/it] 25%|██▍       | 100/408 [01:35<05:16,  1.03s/it] 25%|██▍       | 101/408 [01:35<04:03,  1.26it/s] 25%|██▌       | 102/408 [01:36<03:50,  1.33it/s] 25%|██▌       | 103/408 [01:37<03:56,  1.29it/s] 25%|██▌       | 104/408 [01:38<04:04,  1.24it/s] 26%|██▌       | 105/408 [01:39<04:18,  1.17it/s] 26%|██▌       | 106/408 [01:40<05:26,  1.08s/it] 26%|██▌       | 107/408 [01:41<04:31,  1.11it/s] 26%|██▋       | 108/408 [01:42<04:51,  1.03it/s] 27%|██▋       | 109/408 [01:43<04:27,  1.12it/s] 27%|██▋       | 110/408 [01:43<04:01,  1.24it/s] 27%|██▋       | 111/408 [01:44<04:24,  1.12it/s] 27%|██▋       | 112/408 [01:45<03:56,  1.25it/s] 28%|██▊       | 113/408 [01:46<03:48,  1.29it/s] 28%|██▊       | 114/408 [01:47<04:35,  1.07it/s] 28%|██▊       | 115/408 [01:48<05:18,  1.09s/it] 28%|██▊       | 116/408 [01:50<05:26,  1.12s/it] 29%|██▊       | 117/408 [01:51<05:11,  1.07s/it] 29%|██▉       | 118/408 [01:52<05:10,  1.07s/it] 29%|██▉       | 119/408 [01:53<05:08,  1.07s/it] 29%|██▉       | 120/408 [01:53<04:47,  1.00it/s] 30%|██▉       | 121/408 [01:54<04:01,  1.19it/s] 30%|██▉       | 122/408 [01:55<03:39,  1.30it/s] 30%|███       | 123/408 [01:56<04:17,  1.11it/s] 30%|███       | 124/408 [01:57<04:02,  1.17it/s] 31%|███       | 125/408 [01:57<03:49,  1.23it/s] 31%|███       | 126/408 [01:58<03:42,  1.27it/s] 31%|███       | 127/408 [01:59<04:18,  1.09it/s] 31%|███▏      | 128/408 [01:59<03:21,  1.39it/s] 32%|███▏      | 129/408 [02:01<04:00,  1.16it/s] 32%|███▏      | 130/408 [02:02<04:50,  1.05s/it] 32%|███▏      | 131/408 [02:03<04:34,  1.01it/s] 32%|███▏      | 132/408 [02:04<04:20,  1.06it/s] 33%|███▎      | 133/408 [02:05<04:31,  1.01it/s] 33%|███▎      | 134/408 [02:07<05:40,  1.24s/it] 33%|███▎      | 135/408 [02:08<06:14,  1.37s/it] 33%|███▎      | 136/408 [02:09<05:50,  1.29s/it] 34%|███▎      | 137/408 [02:10<04:44,  1.05s/it] 34%|███▍      | 138/408 [02:11<04:38,  1.03s/it] 34%|███▍      | 139/408 [02:12<04:24,  1.02it/s] 34%|███▍      | 140/408 [02:13<05:12,  1.17s/it] 35%|███▍      | 141/408 [02:14<04:48,  1.08s/it] 35%|███▍      | 142/408 [02:16<05:04,  1.15s/it] 35%|███▌      | 143/408 [02:17<04:50,  1.10s/it] 35%|███▌      | 144/408 [02:17<04:31,  1.03s/it] 36%|███▌      | 145/408 [02:18<04:22,  1.00it/s] 36%|███▌      | 146/408 [02:19<04:09,  1.05it/s] 36%|███▌      | 147/408 [02:20<04:10,  1.04it/s] 36%|███▋      | 148/408 [02:21<03:50,  1.13it/s] 37%|███▋      | 149/408 [02:22<04:06,  1.05it/s] 37%|███▋      | 150/408 [02:23<04:08,  1.04it/s] 37%|███▋      | 151/408 [02:24<03:31,  1.22it/s] 37%|███▋      | 152/408 [02:25<03:49,  1.11it/s] 38%|███▊      | 153/408 [02:26<03:55,  1.08it/s] 38%|███▊      | 154/408 [02:26<03:46,  1.12it/s] 38%|███▊      | 155/408 [02:29<05:26,  1.29s/it] 38%|███▊      | 156/408 [02:30<05:00,  1.19s/it] 38%|███▊      | 157/408 [02:31<05:28,  1.31s/it] 39%|███▊      | 158/408 [02:32<05:13,  1.25s/it] 39%|███▉      | 159/408 [02:33<04:49,  1.16s/it] 39%|███▉      | 160/408 [02:34<04:06,  1.00it/s] 39%|███▉      | 161/408 [02:34<03:38,  1.13it/s] 40%|███▉      | 162/408 [02:35<03:34,  1.15it/s] 40%|███▉      | 163/408 [02:36<03:32,  1.16it/s] 40%|████      | 164/408 [02:37<03:20,  1.22it/s] 40%|████      | 165/408 [02:38<03:29,  1.16it/s] 41%|████      | 166/408 [02:39<03:29,  1.15it/s] 41%|████      | 167/408 [02:39<03:01,  1.33it/s] 41%|████      | 168/408 [02:40<02:50,  1.41it/s] 41%|████▏     | 169/408 [02:41<03:01,  1.32it/s] 42%|████▏     | 170/408 [02:42<03:16,  1.21it/s] 42%|████▏     | 171/408 [02:42<03:09,  1.25it/s] 42%|████▏     | 172/408 [02:43<02:55,  1.34it/s] 42%|████▏     | 173/408 [02:44<03:38,  1.08it/s] 43%|████▎     | 174/408 [02:46<04:03,  1.04s/it] 43%|████▎     | 175/408 [02:47<03:57,  1.02s/it] 43%|████▎     | 176/408 [02:47<03:38,  1.06it/s] 43%|████▎     | 177/408 [02:48<03:07,  1.23it/s] 44%|████▎     | 178/408 [02:49<03:41,  1.04it/s] 44%|████▍     | 179/408 [02:50<03:24,  1.12it/s] 44%|████▍     | 180/408 [02:51<03:13,  1.18it/s] 44%|████▍     | 181/408 [02:51<02:58,  1.28it/s] 45%|████▍     | 182/408 [02:52<03:02,  1.24it/s] 45%|████▍     | 183/408 [02:54<03:36,  1.04it/s] 45%|████▌     | 184/408 [02:54<03:11,  1.17it/s] 45%|████▌     | 185/408 [02:55<03:00,  1.23it/s] 46%|████▌     | 186/408 [02:56<03:09,  1.17it/s] 46%|████▌     | 187/408 [02:57<03:57,  1.08s/it] 46%|████▌     | 188/408 [02:58<03:33,  1.03it/s] 46%|████▋     | 189/408 [02:59<03:33,  1.02it/s] 47%|████▋     | 190/408 [03:00<03:32,  1.03it/s] 47%|████▋     | 191/408 [03:01<03:25,  1.06it/s] 47%|████▋     | 192/408 [03:02<03:34,  1.01it/s] 47%|████▋     | 193/408 [03:03<03:31,  1.02it/s] 48%|████▊     | 194/408 [03:04<03:13,  1.11it/s] 48%|████▊     | 195/408 [03:05<03:08,  1.13it/s] 48%|████▊     | 196/408 [03:05<02:42,  1.30it/s] 48%|████▊     | 197/408 [03:06<02:40,  1.32it/s] 49%|████▊     | 198/408 [03:06<02:29,  1.40it/s] 49%|████▉     | 199/408 [03:07<02:06,  1.65it/s] 49%|████▉     | 200/408 [03:08<02:36,  1.33it/s] 49%|████▉     | 201/408 [03:09<02:48,  1.23it/s] 50%|████▉     | 202/408 [03:10<02:42,  1.27it/s] 50%|████▉     | 203/408 [03:10<02:29,  1.37it/s] 50%|█████     | 204/408 [03:11<02:56,  1.16it/s] 50%|█████     | 205/408 [03:12<02:39,  1.27it/s] 50%|█████     | 206/408 [03:13<02:34,  1.30it/s] 51%|█████     | 207/408 [03:13<02:37,  1.28it/s] 51%|█████     | 208/408 [03:15<03:04,  1.09it/s] 51%|█████     | 209/408 [03:16<03:07,  1.06it/s] 51%|█████▏    | 210/408 [03:16<02:52,  1.15it/s] 52%|█████▏    | 211/408 [03:17<02:41,  1.22it/s] 52%|█████▏    | 212/408 [03:18<03:13,  1.01it/s] 52%|█████▏    | 213/408 [03:20<03:49,  1.18s/it] 52%|█████▏    | 214/408 [03:22<04:02,  1.25s/it] 53%|█████▎    | 215/408 [03:22<03:29,  1.09s/it] 53%|█████▎    | 216/408 [03:23<03:14,  1.01s/it] 53%|█████▎    | 217/408 [03:24<03:25,  1.07s/it] 53%|█████▎    | 218/408 [03:25<03:12,  1.01s/it] 54%|█████▎    | 219/408 [03:27<03:45,  1.19s/it] 54%|█████▍    | 220/408 [03:28<03:41,  1.18s/it] 54%|█████▍    | 221/408 [03:29<03:44,  1.20s/it] 54%|█████▍    | 222/408 [03:30<02:56,  1.06it/s] 55%|█████▍    | 223/408 [03:31<03:23,  1.10s/it] 55%|█████▍    | 224/408 [03:32<03:35,  1.17s/it] 55%|█████▌    | 225/408 [03:33<03:23,  1.11s/it] 55%|█████▌    | 226/408 [03:34<03:00,  1.01it/s] 56%|█████▌    | 227/408 [03:35<03:10,  1.05s/it] 56%|█████▌    | 228/408 [03:36<02:46,  1.08it/s] 56%|█████▌    | 229/408 [03:37<02:33,  1.16it/s] 56%|█████▋    | 230/408 [03:37<02:19,  1.28it/s] 57%|█████▋    | 231/408 [03:38<01:56,  1.52it/s] 57%|█████▋    | 232/408 [03:38<01:58,  1.48it/s] 57%|█████▋    | 233/408 [03:39<02:00,  1.46it/s] 57%|█████▋    | 234/408 [03:40<02:07,  1.37it/s] 58%|█████▊    | 235/408 [03:40<01:53,  1.52it/s] 58%|█████▊    | 236/408 [03:41<01:51,  1.54it/s] 58%|█████▊    | 237/408 [03:42<01:56,  1.46it/s] 58%|█████▊    | 238/408 [03:43<02:35,  1.09it/s] 59%|█████▊    | 239/408 [03:44<02:50,  1.01s/it] 59%|█████▉    | 240/408 [03:45<02:47,  1.00it/s] 59%|█████▉    | 241/408 [03:46<02:14,  1.24it/s] 59%|█████▉    | 242/408 [03:46<02:09,  1.29it/s] 60%|█████▉    | 243/408 [03:47<02:18,  1.19it/s] 60%|█████▉    | 244/408 [03:48<02:29,  1.10it/s] 60%|██████    | 245/408 [03:49<02:25,  1.12it/s] 60%|██████    | 246/408 [03:50<02:17,  1.18it/s] 61%|██████    | 247/408 [03:51<02:10,  1.23it/s] 61%|██████    | 248/408 [03:51<01:55,  1.38it/s] 61%|██████    | 249/408 [03:52<01:56,  1.36it/s] 61%|██████▏   | 250/408 [03:53<02:02,  1.29it/s] 62%|██████▏   | 251/408 [03:54<01:58,  1.33it/s] 62%|██████▏   | 252/408 [03:55<02:18,  1.13it/s] 62%|██████▏   | 253/408 [03:56<02:10,  1.19it/s] 62%|██████▏   | 254/408 [03:57<02:21,  1.09it/s] 62%|██████▎   | 255/408 [03:57<02:10,  1.18it/s] 63%|██████▎   | 256/408 [03:58<02:09,  1.18it/s] 63%|██████▎   | 257/408 [03:59<02:07,  1.19it/s] 63%|██████▎   | 258/408 [04:00<02:00,  1.24it/s] 63%|██████▎   | 259/408 [04:01<02:13,  1.12it/s] 64%|██████▎   | 260/408 [04:02<02:05,  1.18it/s] 64%|██████▍   | 261/408 [04:03<02:26,  1.00it/s] 64%|██████▍   | 262/408 [04:06<03:49,  1.57s/it] 64%|██████▍   | 263/408 [04:06<02:54,  1.21s/it] 65%|██████▍   | 264/408 [04:07<02:44,  1.14s/it] 65%|██████▍   | 265/408 [04:08<02:29,  1.05s/it] 65%|██████▌   | 266/408 [04:09<02:26,  1.03s/it] 65%|██████▌   | 267/408 [04:10<02:27,  1.05s/it] 66%|██████▌   | 268/408 [04:11<02:17,  1.02it/s] 66%|██████▌   | 269/408 [04:12<02:00,  1.15it/s] 66%|██████▌   | 270/408 [04:12<01:54,  1.21it/s] 66%|██████▋   | 271/408 [04:13<01:44,  1.31it/s] 67%|██████▋   | 272/408 [04:14<01:41,  1.34it/s] 67%|██████▋   | 273/408 [04:15<02:04,  1.09it/s] 67%|██████▋   | 274/408 [04:16<01:55,  1.16it/s] 67%|██████▋   | 275/408 [04:16<01:49,  1.21it/s] 68%|██████▊   | 276/408 [04:17<01:58,  1.11it/s] 68%|██████▊   | 277/408 [04:18<01:55,  1.14it/s] 68%|██████▊   | 278/408 [04:20<02:11,  1.01s/it] 68%|██████▊   | 279/408 [04:20<01:54,  1.13it/s] 69%|██████▊   | 280/408 [04:21<01:46,  1.20it/s] 69%|██████▉   | 281/408 [04:22<01:43,  1.23it/s] 69%|██████▉   | 282/408 [04:22<01:30,  1.40it/s] 69%|██████▉   | 283/408 [04:23<01:29,  1.39it/s] 70%|██████▉   | 284/408 [04:24<01:32,  1.34it/s] 70%|██████▉   | 285/408 [04:25<01:35,  1.29it/s] 70%|███████   | 286/408 [04:26<01:47,  1.14it/s] 70%|███████   | 287/408 [04:26<01:40,  1.21it/s] 71%|███████   | 288/408 [04:27<01:34,  1.27it/s] 71%|███████   | 289/408 [04:28<01:35,  1.24it/s] 71%|███████   | 290/408 [04:28<01:27,  1.35it/s] 71%|███████▏  | 291/408 [04:30<01:49,  1.07it/s] 72%|███████▏  | 292/408 [04:31<02:10,  1.12s/it] 72%|███████▏  | 293/408 [04:34<02:44,  1.43s/it] 72%|███████▏  | 294/408 [04:34<02:23,  1.26s/it] 72%|███████▏  | 295/408 [04:35<02:11,  1.16s/it] 73%|███████▎  | 296/408 [04:36<01:55,  1.03s/it] 73%|███████▎  | 297/408 [04:37<01:59,  1.08s/it] 73%|███████▎  | 298/408 [04:38<01:46,  1.03it/s] 73%|███████▎  | 299/408 [04:39<01:37,  1.11it/s] 74%|███████▎  | 300/408 [04:39<01:23,  1.29it/s] 74%|███████▍  | 301/408 [04:40<01:22,  1.30it/s] 74%|███████▍  | 302/408 [04:41<01:34,  1.12it/s] 74%|███████▍  | 303/408 [04:42<01:31,  1.15it/s] 75%|███████▍  | 304/408 [04:43<01:32,  1.12it/s] 75%|███████▍  | 305/408 [04:44<01:27,  1.18it/s] 75%|███████▌  | 306/408 [04:44<01:25,  1.19it/s] 75%|███████▌  | 307/408 [04:46<01:37,  1.03it/s] 75%|███████▌  | 308/408 [04:47<01:32,  1.08it/s] 76%|███████▌  | 309/408 [04:48<01:34,  1.05it/s] 76%|███████▌  | 310/408 [04:48<01:23,  1.17it/s] 76%|███████▌  | 311/408 [04:50<01:36,  1.00it/s] 76%|███████▋  | 312/408 [04:50<01:17,  1.24it/s] 77%|███████▋  | 313/408 [04:51<01:32,  1.03it/s] 77%|███████▋  | 314/408 [04:53<01:40,  1.07s/it] 77%|███████▋  | 315/408 [04:53<01:32,  1.01it/s] 77%|███████▋  | 316/408 [04:54<01:30,  1.02it/s] 78%|███████▊  | 317/408 [04:55<01:19,  1.14it/s] 78%|███████▊  | 318/408 [04:56<01:27,  1.03it/s] 78%|███████▊  | 319/408 [04:57<01:16,  1.17it/s] 78%|███████▊  | 320/408 [04:58<01:34,  1.07s/it] 79%|███████▊  | 321/408 [04:59<01:18,  1.11it/s] 79%|███████▉  | 322/408 [05:00<01:15,  1.13it/s] 79%|███████▉  | 323/408 [05:00<01:07,  1.25it/s] 79%|███████▉  | 324/408 [05:01<01:08,  1.22it/s] 80%|███████▉  | 325/408 [05:02<01:02,  1.33it/s] 80%|███████▉  | 326/408 [05:02<00:55,  1.47it/s] 80%|████████  | 327/408 [05:04<01:18,  1.03it/s] 80%|████████  | 328/408 [05:04<01:05,  1.22it/s] 81%|████████  | 329/408 [05:05<01:09,  1.14it/s] 81%|████████  | 330/408 [05:06<00:59,  1.32it/s] 81%|████████  | 331/408 [05:07<00:57,  1.33it/s] 81%|████████▏ | 332/408 [05:08<01:02,  1.22it/s] 82%|████████▏ | 333/408 [05:08<01:01,  1.22it/s] 82%|████████▏ | 334/408 [05:09<01:06,  1.11it/s] 82%|████████▏ | 335/408 [05:10<01:02,  1.17it/s] 82%|████████▏ | 336/408 [05:11<00:56,  1.28it/s] 83%|████████▎ | 337/408 [05:12<01:11,  1.01s/it] 83%|████████▎ | 338/408 [05:13<01:07,  1.04it/s] 83%|████████▎ | 339/408 [05:14<01:01,  1.11it/s] 83%|████████▎ | 340/408 [05:15<01:02,  1.09it/s] 84%|████████▎ | 341/408 [05:16<01:04,  1.04it/s] 84%|████████▍ | 342/408 [05:17<01:07,  1.03s/it] 84%|████████▍ | 343/408 [05:18<00:58,  1.11it/s] 84%|████████▍ | 344/408 [05:19<01:01,  1.04it/s] 85%|████████▍ | 345/408 [05:20<00:59,  1.06it/s] 85%|████████▍ | 346/408 [05:21<00:56,  1.09it/s] 85%|████████▌ | 347/408 [05:21<00:54,  1.12it/s] 85%|████████▌ | 348/408 [05:23<00:59,  1.01it/s] 86%|████████▌ | 349/408 [05:24<00:58,  1.01it/s] 86%|████████▌ | 350/408 [05:25<00:55,  1.05it/s] 86%|████████▌ | 351/408 [05:25<00:53,  1.07it/s] 86%|████████▋ | 352/408 [05:26<00:50,  1.11it/s] 87%|████████▋ | 353/408 [05:27<00:42,  1.29it/s] 87%|████████▋ | 354/408 [05:28<00:51,  1.05it/s] 87%|████████▋ | 355/408 [05:28<00:41,  1.29it/s] 87%|████████▋ | 356/408 [05:29<00:37,  1.38it/s] 88%|████████▊ | 357/408 [05:30<00:36,  1.39it/s] 88%|████████▊ | 358/408 [05:31<00:48,  1.03it/s] 88%|████████▊ | 359/408 [05:32<00:45,  1.07it/s] 88%|████████▊ | 360/408 [05:33<00:38,  1.25it/s] 88%|████████▊ | 361/408 [05:34<00:45,  1.03it/s] 89%|████████▊ | 362/408 [05:35<00:43,  1.06it/s] 89%|████████▉ | 363/408 [05:36<00:42,  1.06it/s] 89%|████████▉ | 364/408 [05:36<00:37,  1.19it/s] 89%|████████▉ | 365/408 [05:37<00:34,  1.24it/s] 90%|████████▉ | 366/408 [05:38<00:29,  1.41it/s] 90%|████████▉ | 367/408 [05:38<00:27,  1.48it/s] 90%|█████████ | 368/408 [05:39<00:27,  1.44it/s] 90%|█████████ | 369/408 [05:40<00:30,  1.28it/s] 91%|█████████ | 370/408 [05:41<00:32,  1.15it/s] 91%|█████████ | 371/408 [05:42<00:28,  1.28it/s] 91%|█████████ | 372/408 [05:43<00:32,  1.10it/s] 91%|█████████▏| 373/408 [05:44<00:33,  1.04it/s] 92%|█████████▏| 374/408 [05:46<00:41,  1.22s/it] 92%|█████████▏| 375/408 [05:46<00:35,  1.07s/it] 92%|█████████▏| 376/408 [05:47<00:33,  1.05s/it] 92%|█████████▏| 377/408 [05:48<00:31,  1.02s/it] 93%|█████████▎| 378/408 [05:49<00:30,  1.00s/it] 93%|█████████▎| 379/408 [05:50<00:28,  1.01it/s] 93%|█████████▎| 380/408 [05:51<00:28,  1.01s/it] 93%|█████████▎| 381/408 [05:52<00:26,  1.00it/s] 94%|█████████▎| 382/408 [05:54<00:27,  1.06s/it] 94%|█████████▍| 383/408 [05:55<00:25,  1.03s/it] 94%|█████████▍| 384/408 [05:56<00:26,  1.08s/it] 94%|█████████▍| 385/408 [05:57<00:25,  1.11s/it] 95%|█████████▍| 386/408 [05:58<00:25,  1.14s/it] 95%|█████████▍| 387/408 [05:59<00:21,  1.02s/it] 95%|█████████▌| 388/408 [06:00<00:18,  1.08it/s] 95%|█████████▌| 389/408 [06:00<00:17,  1.10it/s] 96%|█████████▌| 390/408 [06:01<00:15,  1.18it/s] 96%|█████████▌| 391/408 [06:02<00:15,  1.07it/s] 96%|█████████▌| 392/408 [06:04<00:18,  1.13s/it] 96%|█████████▋| 393/408 [06:05<00:14,  1.02it/s] 97%|█████████▋| 394/408 [06:05<00:13,  1.03it/s] 97%|█████████▋| 395/408 [06:06<00:11,  1.15it/s] 97%|█████████▋| 396/408 [06:07<00:10,  1.20it/s] 97%|█████████▋| 397/408 [06:08<00:09,  1.20it/s] 98%|█████████▊| 398/408 [06:09<00:08,  1.14it/s] 98%|█████████▊| 399/408 [06:10<00:08,  1.09it/s] 98%|█████████▊| 400/408 [06:11<00:07,  1.07it/s] 98%|█████████▊| 401/408 [06:11<00:06,  1.10it/s] 99%|█████████▊| 402/408 [06:13<00:05,  1.05it/s] 99%|█████████▉| 403/408 [06:13<00:03,  1.28it/s] 99%|█████████▉| 404/408 [06:14<00:03,  1.20it/s] 99%|█████████▉| 405/408 [06:15<00:02,  1.01it/s]100%|█████████▉| 406/408 [06:16<00:01,  1.01it/s]100%|█████████▉| 407/408 [06:17<00:00,  1.09it/s]100%|██████████| 408/408 [06:18<00:00,  1.16it/s]100%|██████████| 408/408 [06:18<00:00,  1.08it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 265.63it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (2090 > 2048). Running this sequence through the model will result in indexing errors
Map:  15%|█▌        | 15/100 [00:00<00:00, 134.64 examples/s]Map:  35%|███▌      | 35/100 [00:00<00:00, 166.55 examples/s]Map:  57%|█████▋    | 57/100 [00:00<00:00, 125.42 examples/s]Map:  77%|███████▋  | 77/100 [00:00<00:00, 121.65 examples/s]Map:  90%|█████████ | 90/100 [00:00<00:00, 118.59 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:05, 16.74it/s]  4%|▍         | 4/100 [00:00<00:05, 16.82it/s]  6%|▌         | 6/100 [00:00<00:05, 16.84it/s]  8%|▊         | 8/100 [00:00<00:05, 16.87it/s] 10%|█         | 10/100 [00:00<00:05, 16.89it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.87it/s] 14%|█▍        | 14/100 [00:00<00:05, 16.86it/s] 16%|█▌        | 16/100 [00:00<00:04, 16.86it/s] 18%|█▊        | 18/100 [00:01<00:04, 16.87it/s] 20%|██        | 20/100 [00:01<00:04, 16.87it/s] 22%|██▏       | 22/100 [00:01<00:04, 16.87it/s] 24%|██▍       | 24/100 [00:01<00:04, 16.87it/s] 26%|██▌       | 26/100 [00:01<00:04, 16.86it/s] 28%|██▊       | 28/100 [00:01<00:04, 16.86it/s] 30%|███       | 30/100 [00:01<00:04, 16.86it/s] 32%|███▏      | 32/100 [00:01<00:04, 16.84it/s] 34%|███▍      | 34/100 [00:02<00:03, 16.86it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.87it/s] 38%|███▊      | 38/100 [00:02<00:03, 16.88it/s] 40%|████      | 40/100 [00:02<00:03, 16.90it/s] 42%|████▏     | 42/100 [00:02<00:03, 16.90it/s] 44%|████▍     | 44/100 [00:02<00:03, 16.91it/s] 46%|████▌     | 46/100 [00:02<00:03, 16.92it/s] 48%|████▊     | 48/100 [00:02<00:03, 16.91it/s] 50%|█████     | 50/100 [00:02<00:02, 16.92it/s] 52%|█████▏    | 52/100 [00:03<00:02, 16.94it/s] 54%|█████▍    | 54/100 [00:03<00:02, 16.96it/s] 56%|█████▌    | 56/100 [00:03<00:02, 16.95it/s] 58%|█████▊    | 58/100 [00:03<00:02, 16.96it/s] 60%|██████    | 60/100 [00:03<00:02, 16.97it/s] 62%|██████▏   | 62/100 [00:03<00:02, 16.99it/s] 64%|██████▍   | 64/100 [00:03<00:02, 16.98it/s] 66%|██████▌   | 66/100 [00:03<00:02, 16.98it/s] 68%|██████▊   | 68/100 [00:04<00:01, 16.98it/s] 70%|███████   | 70/100 [00:04<00:01, 16.98it/s] 72%|███████▏  | 72/100 [00:04<00:01, 16.97it/s] 74%|███████▍  | 74/100 [00:04<00:01, 16.97it/s] 76%|███████▌  | 76/100 [00:04<00:01, 16.98it/s] 78%|███████▊  | 78/100 [00:04<00:01, 16.97it/s] 80%|████████  | 80/100 [00:04<00:01, 16.96it/s] 82%|████████▏ | 82/100 [00:04<00:01, 16.96it/s] 84%|████████▍ | 84/100 [00:04<00:00, 16.97it/s] 86%|████████▌ | 86/100 [00:05<00:00, 16.96it/s] 88%|████████▊ | 88/100 [00:05<00:00, 16.96it/s] 90%|█████████ | 90/100 [00:05<00:00, 16.95it/s] 92%|█████████▏| 92/100 [00:05<00:00, 16.95it/s] 94%|█████████▍| 94/100 [00:05<00:00, 16.92it/s] 96%|█████████▌| 96/100 [00:05<00:00, 16.92it/s] 98%|█████████▊| 98/100 [00:05<00:00, 16.93it/s]100%|██████████| 100/100 [00:05<00:00, 16.94it/s]100%|██████████| 100/100 [00:05<00:00, 16.92it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 353.53it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  20%|██        | 20/100 [00:00<00:00, 158.03 examples/s]Map:  40%|████      | 40/100 [00:00<00:00, 177.75 examples/s]Map:  60%|██████    | 60/100 [00:00<00:00, 148.40 examples/s]Map:  77%|███████▋  | 77/100 [00:00<00:00, 149.73 examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 170.50 examples/s]                                                                0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.82it/s]  2%|▏         | 2/100 [00:00<00:11,  8.19it/s]  3%|▎         | 3/100 [00:00<00:11,  8.21it/s]  4%|▍         | 4/100 [00:00<00:11,  8.24it/s]  5%|▌         | 5/100 [00:00<00:11,  8.22it/s]  6%|▌         | 6/100 [00:00<00:11,  8.19it/s]  7%|▋         | 7/100 [00:00<00:11,  8.15it/s]  8%|▊         | 8/100 [00:00<00:11,  8.10it/s]  9%|▉         | 9/100 [00:01<00:11,  8.06it/s] 10%|█         | 10/100 [00:01<00:11,  8.04it/s] 11%|█         | 11/100 [00:01<00:11,  8.02it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.01it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.00it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.00it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.98it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.98it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.00it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.02it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.02it/s] 20%|██        | 20/100 [00:02<00:09,  8.02it/s] 21%|██        | 21/100 [00:02<00:09,  8.01it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.02it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.03it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.04it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.03it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.02it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.03it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.04it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.04it/s] 30%|███       | 30/100 [00:03<00:08,  8.04it/s] 31%|███       | 31/100 [00:03<00:08,  8.04it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.05it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.05it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.05it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.05it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.04it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.04it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.04it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.05it/s] 40%|████      | 40/100 [00:04<00:07,  8.04it/s] 41%|████      | 41/100 [00:05<00:07,  8.04it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.04it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.04it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.04it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.03it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.02it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.03it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.03it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.03it/s] 50%|█████     | 50/100 [00:06<00:06,  8.03it/s] 51%|█████     | 51/100 [00:06<00:06,  8.03it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.04it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.04it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.05it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.04it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.04it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.04it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.05it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.05it/s] 60%|██████    | 60/100 [00:07<00:04,  8.03it/s] 61%|██████    | 61/100 [00:07<00:04,  8.03it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.03it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.05it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.06it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.05it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.05it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.05it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.06it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.06it/s] 70%|███████   | 70/100 [00:08<00:03,  8.06it/s] 71%|███████   | 71/100 [00:08<00:03,  8.05it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.05it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.05it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.04it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.82it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.87it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.93it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.97it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.99it/s] 80%|████████  | 80/100 [00:09<00:02,  8.00it/s] 81%|████████  | 81/100 [00:10<00:02,  8.01it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.03it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.02it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.04it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.04it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.04it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.04it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.05it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.06it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.05it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.05it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.05it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.05it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.05it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.05it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.04it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.05it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.05it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.04it/s]100%|██████████| 100/100 [00:12<00:00,  8.03it/s]100%|██████████| 100/100 [00:12<00:00,  8.04it/s]
FOLD 1
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.291667  0.592325  5.307852     3.226773
[0.28886512 0.5613056  5.56013672 3.44022993]
MC1 Score: 0.28886511817440913, MC2 Score: 0.5613056003192336, CE Loss: 5.56013671875, KL wrt Original: 3.4402299308776856
2023-11-01 13:47:22.673508: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 13:47:22.724443: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 13:47:23.504090: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 375.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.97it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.72it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.59it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 461.12it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.08it/s]  6%|▋         | 2/32 [00:00<00:14,  2.11it/s]  9%|▉         | 3/32 [00:01<00:14,  2.05it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.02it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.94it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.91it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.88it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.86it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.75it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.64it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.62it/s] 41%|████      | 13/32 [00:07<00:11,  1.61it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.58it/s] 47%|████▋     | 15/32 [00:08<00:10,  1.55it/s] 50%|█████     | 16/32 [00:09<00:10,  1.54it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.52it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.50it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.43it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.42it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.45it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.45it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.43it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.45it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.47it/s] 84%|████████▍ | 27/32 [00:16<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.49it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.49it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.53it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.56it/s]100%|██████████| 32/32 [00:20<00:00,  1.42it/s]100%|██████████| 32/32 [00:20<00:00,  1.57it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.58359621 0.59148265 0.58044164 ... 0.58044164 0.58044164 0.58044164]
 [0.58044164 0.58044164 0.58044164 ... 0.60567823 0.58044164 0.58044164]
 [0.58044164 0.58832808 0.71766562 ... 0.59621451 0.58044164 0.63249211]
 ...
 [0.70347003 0.58990536 0.59148265 ... 0.61671924 0.58044164 0.58201893]
 [0.73343849 0.60252366 0.61356467 ... 0.60567823 0.69400631 0.58044164]
 [0.62776025 0.64826498 0.70662461 ... 0.63564669 0.670347   0.67192429]]
Heads intervened:  [(7, 14), (7, 23), (8, 5), (8, 12), (9, 20), (9, 29), (10, 1), (10, 17), (10, 22), (10, 27), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 21), (11, 28), (11, 29), (11, 31), (12, 3), (12, 12), (12, 14), (12, 21), (12, 25), (13, 11), (13, 22), (14, 12), (14, 14), (14, 18), (14, 22), (15, 20), (15, 21), (15, 24), (16, 2), (16, 10), (16, 11), (16, 17), (16, 26), (17, 1), (17, 31), (18, 0), (18, 9), (18, 10), (18, 17), (20, 9), (22, 4), (24, 20)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/409 [00:00<?, ?it/s]  0%|          | 1/409 [00:01<09:22,  1.38s/it]  0%|          | 2/409 [00:02<07:37,  1.12s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  1%|          | 3/409 [00:03<06:21,  1.06it/s]  1%|          | 4/409 [00:03<06:07,  1.10it/s]  1%|          | 5/409 [00:04<06:31,  1.03it/s]  1%|▏         | 6/409 [00:06<06:47,  1.01s/it]  2%|▏         | 7/409 [00:06<05:49,  1.15it/s]  2%|▏         | 8/409 [00:08<07:13,  1.08s/it]  2%|▏         | 9/409 [00:09<08:39,  1.30s/it]  2%|▏         | 10/409 [00:10<07:52,  1.19s/it]  3%|▎         | 11/409 [00:11<07:08,  1.08s/it]  3%|▎         | 12/409 [00:12<06:08,  1.08it/s]  3%|▎         | 13/409 [00:12<05:28,  1.21it/s]  3%|▎         | 14/409 [00:13<05:01,  1.31it/s]  4%|▎         | 15/409 [00:14<05:22,  1.22it/s]  4%|▍         | 16/409 [00:15<05:21,  1.22it/s]  4%|▍         | 17/409 [00:16<06:01,  1.09it/s]  4%|▍         | 18/409 [00:17<06:48,  1.04s/it]  5%|▍         | 19/409 [00:18<06:13,  1.05it/s]  5%|▍         | 20/409 [00:19<06:27,  1.00it/s]  5%|▌         | 21/409 [00:20<05:56,  1.09it/s]  5%|▌         | 22/409 [00:21<06:38,  1.03s/it]  6%|▌         | 23/409 [00:22<06:52,  1.07s/it]  6%|▌         | 24/409 [00:23<06:38,  1.04s/it]  6%|▌         | 25/409 [00:25<07:00,  1.09s/it]  6%|▋         | 26/409 [00:26<07:09,  1.12s/it]  7%|▋         | 27/409 [00:27<06:40,  1.05s/it]  7%|▋         | 28/409 [00:28<07:36,  1.20s/it]  7%|▋         | 29/409 [00:29<07:36,  1.20s/it]  7%|▋         | 30/409 [00:30<06:38,  1.05s/it]  8%|▊         | 31/409 [00:31<06:25,  1.02s/it]  8%|▊         | 32/409 [00:32<06:17,  1.00s/it]  8%|▊         | 33/409 [00:33<06:41,  1.07s/it]  8%|▊         | 34/409 [00:34<05:46,  1.08it/s]  9%|▊         | 35/409 [00:35<06:03,  1.03it/s]  9%|▉         | 36/409 [00:36<06:04,  1.02it/s]  9%|▉         | 37/409 [00:36<05:19,  1.16it/s]  9%|▉         | 38/409 [00:37<05:02,  1.23it/s] 10%|▉         | 39/409 [00:38<05:07,  1.20it/s] 10%|▉         | 40/409 [00:39<04:52,  1.26it/s] 10%|█         | 41/409 [00:40<05:36,  1.09it/s] 10%|█         | 42/409 [00:41<05:26,  1.13it/s] 11%|█         | 43/409 [00:42<05:22,  1.13it/s] 11%|█         | 44/409 [00:43<05:41,  1.07it/s] 11%|█         | 45/409 [00:44<05:53,  1.03it/s] 11%|█         | 46/409 [00:45<06:04,  1.00s/it] 11%|█▏        | 47/409 [00:45<05:18,  1.14it/s] 12%|█▏        | 48/409 [00:46<05:26,  1.11it/s] 12%|█▏        | 49/409 [00:48<06:10,  1.03s/it] 12%|█▏        | 50/409 [00:48<05:49,  1.03it/s] 12%|█▏        | 51/409 [00:50<06:24,  1.07s/it] 13%|█▎        | 52/409 [00:51<06:25,  1.08s/it] 13%|█▎        | 53/409 [00:51<05:18,  1.12it/s] 13%|█▎        | 54/409 [00:52<05:22,  1.10it/s] 13%|█▎        | 55/409 [00:53<04:49,  1.22it/s] 14%|█▎        | 56/409 [00:54<04:37,  1.27it/s] 14%|█▍        | 57/409 [00:55<04:54,  1.20it/s] 14%|█▍        | 58/409 [00:56<05:53,  1.01s/it] 14%|█▍        | 59/409 [00:57<05:09,  1.13it/s] 15%|█▍        | 60/409 [00:58<05:28,  1.06it/s] 15%|█▍        | 61/409 [00:58<04:25,  1.31it/s] 15%|█▌        | 62/409 [00:59<04:06,  1.41it/s] 15%|█▌        | 63/409 [01:00<05:23,  1.07it/s] 16%|█▌        | 64/409 [01:00<04:11,  1.37it/s] 16%|█▌        | 65/409 [01:01<03:43,  1.54it/s] 16%|█▌        | 66/409 [01:02<05:03,  1.13it/s] 16%|█▋        | 67/409 [01:04<05:56,  1.04s/it] 17%|█▋        | 68/409 [01:04<04:58,  1.14it/s] 17%|█▋        | 69/409 [01:05<04:53,  1.16it/s] 17%|█▋        | 70/409 [01:06<05:01,  1.12it/s] 17%|█▋        | 71/409 [01:07<04:43,  1.19it/s] 18%|█▊        | 72/409 [01:08<05:32,  1.01it/s] 18%|█▊        | 73/409 [01:09<05:28,  1.02it/s] 18%|█▊        | 74/409 [01:10<05:01,  1.11it/s] 18%|█▊        | 75/409 [01:11<05:53,  1.06s/it] 19%|█▊        | 76/409 [01:12<05:56,  1.07s/it] 19%|█▉        | 77/409 [01:13<05:44,  1.04s/it] 19%|█▉        | 78/409 [01:14<05:23,  1.02it/s] 19%|█▉        | 79/409 [01:15<05:46,  1.05s/it] 20%|█▉        | 80/409 [01:16<05:12,  1.05it/s] 20%|█▉        | 81/409 [01:17<05:10,  1.06it/s] 20%|██        | 82/409 [01:18<04:59,  1.09it/s] 20%|██        | 83/409 [01:18<04:41,  1.16it/s] 21%|██        | 84/409 [01:19<04:39,  1.16it/s] 21%|██        | 85/409 [01:20<04:57,  1.09it/s] 21%|██        | 86/409 [01:21<04:49,  1.12it/s] 21%|██▏       | 87/409 [01:22<05:08,  1.04it/s] 22%|██▏       | 88/409 [01:24<05:42,  1.07s/it] 22%|██▏       | 89/409 [01:24<04:57,  1.07it/s] 22%|██▏       | 90/409 [01:25<04:35,  1.16it/s] 22%|██▏       | 91/409 [01:26<05:07,  1.03it/s] 22%|██▏       | 92/409 [01:27<04:31,  1.17it/s] 23%|██▎       | 93/409 [01:27<04:16,  1.23it/s] 23%|██▎       | 94/409 [01:28<03:44,  1.40it/s] 23%|██▎       | 95/409 [01:29<04:06,  1.27it/s] 23%|██▎       | 96/409 [01:30<04:22,  1.19it/s] 24%|██▎       | 97/409 [01:31<04:19,  1.20it/s] 24%|██▍       | 98/409 [01:31<04:07,  1.26it/s] 24%|██▍       | 99/409 [01:32<03:58,  1.30it/s] 24%|██▍       | 100/409 [01:33<03:53,  1.33it/s] 25%|██▍       | 101/409 [01:34<04:23,  1.17it/s] 25%|██▍       | 102/409 [01:35<04:21,  1.17it/s] 25%|██▌       | 103/409 [01:36<04:40,  1.09it/s] 25%|██▌       | 104/409 [01:37<04:42,  1.08it/s] 26%|██▌       | 105/409 [01:38<04:32,  1.11it/s] 26%|██▌       | 106/409 [01:38<04:25,  1.14it/s] 26%|██▌       | 107/409 [01:39<03:37,  1.39it/s] 26%|██▋       | 108/409 [01:39<03:27,  1.45it/s] 27%|██▋       | 109/409 [01:40<03:30,  1.43it/s] 27%|██▋       | 110/409 [01:41<03:30,  1.42it/s] 27%|██▋       | 111/409 [01:42<04:01,  1.23it/s] 27%|██▋       | 112/409 [01:43<04:05,  1.21it/s] 28%|██▊       | 113/409 [01:44<04:38,  1.06it/s] 28%|██▊       | 114/409 [01:45<04:17,  1.14it/s] 28%|██▊       | 115/409 [01:46<04:24,  1.11it/s] 28%|██▊       | 116/409 [01:47<05:13,  1.07s/it] 29%|██▊       | 117/409 [01:48<05:20,  1.10s/it] 29%|██▉       | 118/409 [01:49<04:26,  1.09it/s] 29%|██▉       | 119/409 [01:50<04:29,  1.08it/s] 29%|██▉       | 120/409 [01:51<04:28,  1.08it/s] 30%|██▉       | 121/409 [01:51<04:27,  1.08it/s] 30%|██▉       | 122/409 [01:53<05:22,  1.12s/it] 30%|███       | 123/409 [01:54<04:44,  1.00it/s] 30%|███       | 124/409 [01:55<04:29,  1.06it/s] 31%|███       | 125/409 [01:55<04:18,  1.10it/s] 31%|███       | 126/409 [01:56<04:01,  1.17it/s] 31%|███       | 127/409 [01:57<03:58,  1.18it/s] 31%|███▏      | 128/409 [01:58<03:48,  1.23it/s] 32%|███▏      | 129/409 [01:59<03:59,  1.17it/s] 32%|███▏      | 130/409 [01:59<03:47,  1.23it/s] 32%|███▏      | 131/409 [02:00<03:27,  1.34it/s] 32%|███▏      | 132/409 [02:01<03:24,  1.36it/s] 33%|███▎      | 133/409 [02:01<03:07,  1.47it/s] 33%|███▎      | 134/409 [02:02<03:39,  1.25it/s] 33%|███▎      | 135/409 [02:03<03:42,  1.23it/s] 33%|███▎      | 136/409 [02:04<03:24,  1.33it/s] 33%|███▎      | 137/409 [02:05<03:40,  1.23it/s] 34%|███▎      | 138/409 [02:06<04:08,  1.09it/s] 34%|███▍      | 139/409 [02:07<04:37,  1.03s/it] 34%|███▍      | 140/409 [02:08<03:51,  1.16it/s] 34%|███▍      | 141/409 [02:08<03:19,  1.35it/s] 35%|███▍      | 142/409 [02:09<03:08,  1.42it/s] 35%|███▍      | 143/409 [02:10<04:19,  1.02it/s] 35%|███▌      | 144/409 [02:12<04:39,  1.06s/it] 35%|███▌      | 145/409 [02:12<04:29,  1.02s/it] 36%|███▌      | 146/409 [02:13<04:02,  1.08it/s] 36%|███▌      | 147/409 [02:14<04:03,  1.08it/s] 36%|███▌      | 148/409 [02:15<03:48,  1.14it/s] 36%|███▋      | 149/409 [02:16<03:44,  1.16it/s] 37%|███▋      | 150/409 [02:17<03:42,  1.16it/s] 37%|███▋      | 151/409 [02:17<03:29,  1.23it/s] 37%|███▋      | 152/409 [02:18<03:50,  1.11it/s] 37%|███▋      | 153/409 [02:19<03:53,  1.10it/s] 38%|███▊      | 154/409 [02:20<03:11,  1.33it/s] 38%|███▊      | 155/409 [02:20<02:49,  1.49it/s] 38%|███▊      | 156/409 [02:21<03:10,  1.33it/s] 38%|███▊      | 157/409 [02:22<03:10,  1.32it/s] 39%|███▊      | 158/409 [02:23<03:15,  1.28it/s] 39%|███▉      | 159/409 [02:24<03:37,  1.15it/s] 39%|███▉      | 160/409 [02:25<03:42,  1.12it/s] 39%|███▉      | 161/409 [02:26<04:05,  1.01it/s] 40%|███▉      | 162/409 [02:27<03:44,  1.10it/s] 40%|███▉      | 163/409 [02:29<05:20,  1.30s/it] 40%|████      | 164/409 [02:30<05:02,  1.23s/it] 40%|████      | 165/409 [02:31<05:07,  1.26s/it] 41%|████      | 166/409 [02:32<04:52,  1.21s/it] 41%|████      | 167/409 [02:33<04:34,  1.13s/it] 41%|████      | 168/409 [02:35<04:57,  1.24s/it] 41%|████▏     | 169/409 [02:36<05:01,  1.26s/it] 42%|████▏     | 170/409 [02:37<04:39,  1.17s/it] 42%|████▏     | 171/409 [02:38<04:14,  1.07s/it] 42%|████▏     | 172/409 [02:39<04:23,  1.11s/it] 42%|████▏     | 173/409 [02:40<03:54,  1.01it/s] 43%|████▎     | 174/409 [02:41<03:49,  1.02it/s] 43%|████▎     | 175/409 [02:42<04:08,  1.06s/it] 43%|████▎     | 176/409 [02:43<03:34,  1.08it/s] 43%|████▎     | 177/409 [02:44<03:59,  1.03s/it] 44%|████▎     | 178/409 [02:45<03:44,  1.03it/s] 44%|████▍     | 179/409 [02:46<03:58,  1.04s/it] 44%|████▍     | 180/409 [02:47<03:37,  1.05it/s] 44%|████▍     | 181/409 [02:47<03:11,  1.19it/s] 44%|████▍     | 182/409 [02:48<03:02,  1.25it/s] 45%|████▍     | 183/409 [02:49<02:56,  1.28it/s] 45%|████▍     | 184/409 [02:50<03:01,  1.24it/s] 45%|████▌     | 185/409 [02:51<03:18,  1.13it/s] 45%|████▌     | 186/409 [02:52<03:39,  1.01it/s] 46%|████▌     | 187/409 [02:53<03:35,  1.03it/s] 46%|████▌     | 188/409 [02:54<03:16,  1.12it/s] 46%|████▌     | 189/409 [02:54<03:03,  1.20it/s] 46%|████▋     | 190/409 [02:55<03:04,  1.19it/s] 47%|████▋     | 191/409 [02:56<03:01,  1.20it/s] 47%|████▋     | 192/409 [02:57<03:09,  1.15it/s] 47%|████▋     | 193/409 [02:58<03:11,  1.13it/s] 47%|████▋     | 194/409 [02:59<03:02,  1.18it/s] 48%|████▊     | 195/409 [03:00<03:09,  1.13it/s] 48%|████▊     | 196/409 [03:01<03:20,  1.06it/s] 48%|████▊     | 197/409 [03:02<03:43,  1.05s/it] 48%|████▊     | 198/409 [03:03<03:35,  1.02s/it] 49%|████▊     | 199/409 [03:03<03:07,  1.12it/s] 49%|████▉     | 200/409 [03:05<03:20,  1.04it/s] 49%|████▉     | 201/409 [03:05<03:04,  1.13it/s] 49%|████▉     | 202/409 [03:06<03:06,  1.11it/s] 50%|████▉     | 203/409 [03:07<02:40,  1.28it/s] 50%|████▉     | 204/409 [03:08<02:45,  1.24it/s] 50%|█████     | 205/409 [03:09<03:24,  1.00s/it] 50%|█████     | 206/409 [03:10<02:59,  1.13it/s] 51%|█████     | 207/409 [03:11<03:01,  1.11it/s] 51%|█████     | 208/409 [03:11<02:51,  1.17it/s] 51%|█████     | 209/409 [03:12<02:41,  1.24it/s] 51%|█████▏    | 210/409 [03:13<02:49,  1.17it/s] 52%|█████▏    | 211/409 [03:14<02:35,  1.28it/s] 52%|█████▏    | 212/409 [03:14<02:22,  1.38it/s] 52%|█████▏    | 213/409 [03:15<02:42,  1.21it/s] 52%|█████▏    | 214/409 [03:16<02:57,  1.10it/s] 53%|█████▎    | 215/409 [03:17<02:44,  1.18it/s] 53%|█████▎    | 216/409 [03:19<04:08,  1.29s/it] 53%|█████▎    | 217/409 [03:20<03:27,  1.08s/it] 53%|█████▎    | 218/409 [03:20<02:51,  1.11it/s] 54%|█████▎    | 219/409 [03:21<02:39,  1.19it/s] 54%|█████▍    | 220/409 [03:22<02:33,  1.23it/s] 54%|█████▍    | 221/409 [03:23<02:26,  1.28it/s] 54%|█████▍    | 222/409 [03:23<02:29,  1.25it/s] 55%|█████▍    | 223/409 [03:24<02:30,  1.23it/s] 55%|█████▍    | 224/409 [03:25<02:33,  1.21it/s] 55%|█████▌    | 225/409 [03:26<02:20,  1.31it/s] 55%|█████▌    | 226/409 [03:27<02:25,  1.26it/s] 56%|█████▌    | 227/409 [03:27<02:14,  1.35it/s] 56%|█████▌    | 228/409 [03:28<02:39,  1.14it/s] 56%|█████▌    | 229/409 [03:29<02:16,  1.32it/s] 56%|█████▌    | 230/409 [03:30<02:22,  1.26it/s] 56%|█████▋    | 231/409 [03:31<02:23,  1.24it/s] 57%|█████▋    | 232/409 [03:32<02:43,  1.09it/s] 57%|█████▋    | 233/409 [03:33<02:31,  1.16it/s] 57%|█████▋    | 234/409 [03:33<02:23,  1.22it/s] 57%|█████▋    | 235/409 [03:34<02:10,  1.33it/s] 58%|█████▊    | 236/409 [03:35<02:13,  1.30it/s] 58%|█████▊    | 237/409 [03:35<01:58,  1.46it/s] 58%|█████▊    | 238/409 [03:36<02:22,  1.20it/s] 58%|█████▊    | 239/409 [03:38<03:17,  1.16s/it] 59%|█████▊    | 240/409 [03:39<02:53,  1.03s/it] 59%|█████▉    | 241/409 [03:40<02:41,  1.04it/s] 59%|█████▉    | 242/409 [03:41<02:52,  1.03s/it] 59%|█████▉    | 243/409 [03:42<02:37,  1.06it/s] 60%|█████▉    | 244/409 [03:43<02:56,  1.07s/it] 60%|█████▉    | 245/409 [03:44<02:33,  1.07it/s] 60%|██████    | 246/409 [03:44<02:09,  1.25it/s] 60%|██████    | 247/409 [03:45<02:18,  1.17it/s] 61%|██████    | 248/409 [03:46<02:16,  1.18it/s] 61%|██████    | 249/409 [03:47<02:09,  1.24it/s] 61%|██████    | 250/409 [03:48<02:14,  1.18it/s] 61%|██████▏   | 251/409 [03:50<03:05,  1.17s/it] 62%|██████▏   | 252/409 [03:50<02:49,  1.08s/it] 62%|██████▏   | 253/409 [03:52<02:59,  1.15s/it] 62%|██████▏   | 254/409 [03:53<02:44,  1.06s/it] 62%|██████▏   | 255/409 [03:54<02:49,  1.10s/it] 63%|██████▎   | 256/409 [03:55<02:37,  1.03s/it] 63%|██████▎   | 257/409 [03:56<02:34,  1.02s/it] 63%|██████▎   | 258/409 [03:56<02:08,  1.17it/s] 63%|██████▎   | 259/409 [03:57<02:06,  1.18it/s] 64%|██████▎   | 260/409 [03:58<02:27,  1.01it/s] 64%|██████▍   | 261/409 [03:59<02:25,  1.02it/s] 64%|██████▍   | 262/409 [04:00<02:01,  1.21it/s] 64%|██████▍   | 263/409 [04:01<02:07,  1.14it/s] 65%|██████▍   | 264/409 [04:01<01:48,  1.33it/s] 65%|██████▍   | 265/409 [04:02<01:47,  1.34it/s] 65%|██████▌   | 266/409 [04:03<02:06,  1.13it/s] 65%|██████▌   | 267/409 [04:04<02:08,  1.11it/s] 66%|██████▌   | 268/409 [04:05<01:54,  1.24it/s] 66%|██████▌   | 269/409 [04:06<01:54,  1.22it/s] 66%|██████▌   | 270/409 [04:07<02:10,  1.07it/s] 66%|██████▋   | 271/409 [04:07<02:00,  1.14it/s] 67%|██████▋   | 272/409 [04:09<02:28,  1.08s/it] 67%|██████▋   | 273/409 [04:10<02:12,  1.02it/s] 67%|██████▋   | 274/409 [04:11<02:20,  1.04s/it] 67%|██████▋   | 275/409 [04:13<02:57,  1.33s/it] 67%|██████▋   | 276/409 [04:14<02:41,  1.21s/it] 68%|██████▊   | 277/409 [04:15<02:21,  1.07s/it] 68%|██████▊   | 278/409 [04:16<02:21,  1.08s/it] 68%|██████▊   | 279/409 [04:17<02:12,  1.02s/it] 68%|██████▊   | 280/409 [04:17<01:55,  1.12it/s] 69%|██████▊   | 281/409 [04:18<01:52,  1.13it/s] 69%|██████▉   | 282/409 [04:19<01:49,  1.16it/s] 69%|██████▉   | 283/409 [04:20<02:13,  1.06s/it] 69%|██████▉   | 284/409 [04:22<02:18,  1.11s/it] 70%|██████▉   | 285/409 [04:22<01:54,  1.08it/s] 70%|██████▉   | 286/409 [04:23<01:36,  1.27it/s] 70%|███████   | 287/409 [04:23<01:38,  1.24it/s] 70%|███████   | 288/409 [04:24<01:34,  1.28it/s] 71%|███████   | 289/409 [04:25<01:26,  1.38it/s] 71%|███████   | 290/409 [04:25<01:25,  1.39it/s] 71%|███████   | 291/409 [04:27<01:37,  1.21it/s] 71%|███████▏  | 292/409 [04:27<01:33,  1.26it/s] 72%|███████▏  | 293/409 [04:28<01:32,  1.25it/s] 72%|███████▏  | 294/409 [04:29<01:45,  1.09it/s] 72%|███████▏  | 295/409 [04:30<01:41,  1.12it/s] 72%|███████▏  | 296/409 [04:30<01:22,  1.37it/s] 73%|███████▎  | 297/409 [04:31<01:28,  1.27it/s] 73%|███████▎  | 298/409 [04:33<01:40,  1.10it/s] 73%|███████▎  | 299/409 [04:34<01:48,  1.01it/s] 73%|███████▎  | 300/409 [04:35<02:00,  1.11s/it] 74%|███████▎  | 301/409 [04:36<01:58,  1.10s/it] 74%|███████▍  | 302/409 [04:38<02:13,  1.25s/it] 74%|███████▍  | 303/409 [04:39<02:20,  1.33s/it] 74%|███████▍  | 304/409 [04:40<01:52,  1.07s/it] 75%|███████▍  | 305/409 [04:41<01:48,  1.04s/it] 75%|███████▍  | 306/409 [04:42<01:44,  1.01s/it] 75%|███████▌  | 307/409 [04:43<01:52,  1.10s/it] 75%|███████▌  | 308/409 [04:44<01:39,  1.01it/s] 76%|███████▌  | 309/409 [04:44<01:30,  1.11it/s] 76%|███████▌  | 310/409 [04:45<01:33,  1.05it/s] 76%|███████▌  | 311/409 [04:46<01:33,  1.05it/s] 76%|███████▋  | 312/409 [04:47<01:31,  1.06it/s] 77%|███████▋  | 313/409 [04:48<01:24,  1.14it/s] 77%|███████▋  | 314/409 [04:49<01:31,  1.04it/s] 77%|███████▋  | 315/409 [04:50<01:37,  1.03s/it] 77%|███████▋  | 316/409 [04:51<01:17,  1.20it/s] 78%|███████▊  | 317/409 [04:52<01:29,  1.03it/s] 78%|███████▊  | 318/409 [04:53<01:31,  1.00s/it] 78%|███████▊  | 319/409 [04:54<01:28,  1.01it/s] 78%|███████▊  | 320/409 [04:55<01:23,  1.06it/s] 78%|███████▊  | 321/409 [04:56<01:14,  1.19it/s] 79%|███████▊  | 322/409 [04:56<01:13,  1.19it/s] 79%|███████▉  | 323/409 [04:57<01:15,  1.14it/s] 79%|███████▉  | 324/409 [04:58<01:04,  1.32it/s] 79%|███████▉  | 325/409 [04:58<00:59,  1.42it/s] 80%|███████▉  | 326/409 [04:59<00:55,  1.48it/s] 80%|███████▉  | 327/409 [05:00<00:53,  1.54it/s] 80%|████████  | 328/409 [05:00<00:51,  1.57it/s] 80%|████████  | 329/409 [05:01<00:58,  1.37it/s] 81%|████████  | 330/409 [05:02<01:02,  1.26it/s] 81%|████████  | 331/409 [05:03<01:02,  1.24it/s] 81%|████████  | 332/409 [05:05<01:19,  1.03s/it] 81%|████████▏ | 333/409 [05:05<01:16,  1.00s/it] 82%|████████▏ | 334/409 [05:07<01:16,  1.02s/it] 82%|████████▏ | 335/409 [05:08<01:26,  1.17s/it] 82%|████████▏ | 336/409 [05:09<01:25,  1.17s/it] 82%|████████▏ | 337/409 [05:10<01:11,  1.00it/s] 83%|████████▎ | 338/409 [05:10<01:00,  1.18it/s] 83%|████████▎ | 339/409 [05:11<00:53,  1.31it/s] 83%|████████▎ | 340/409 [05:11<00:44,  1.56it/s] 83%|████████▎ | 341/409 [05:11<00:35,  1.92it/s] 84%|████████▎ | 342/409 [05:12<00:38,  1.73it/s] 84%|████████▍ | 343/409 [05:13<00:48,  1.36it/s] 84%|████████▍ | 344/409 [05:14<00:44,  1.45it/s] 84%|████████▍ | 345/409 [05:15<00:56,  1.14it/s] 85%|████████▍ | 346/409 [05:16<00:53,  1.17it/s] 85%|████████▍ | 347/409 [05:17<00:54,  1.13it/s] 85%|████████▌ | 348/409 [05:18<00:53,  1.14it/s] 85%|████████▌ | 349/409 [05:19<00:52,  1.15it/s] 86%|████████▌ | 350/409 [05:20<00:58,  1.00it/s] 86%|████████▌ | 351/409 [05:21<00:52,  1.10it/s] 86%|████████▌ | 352/409 [05:21<00:49,  1.16it/s] 86%|████████▋ | 353/409 [05:22<00:45,  1.23it/s] 87%|████████▋ | 354/409 [05:23<00:46,  1.17it/s] 87%|████████▋ | 355/409 [05:24<00:47,  1.13it/s] 87%|████████▋ | 356/409 [05:25<00:45,  1.16it/s] 87%|████████▋ | 357/409 [05:26<00:44,  1.17it/s] 88%|████████▊ | 358/409 [05:27<00:45,  1.13it/s] 88%|████████▊ | 359/409 [05:27<00:41,  1.20it/s] 88%|████████▊ | 360/409 [05:28<00:44,  1.10it/s] 88%|████████▊ | 361/409 [05:29<00:39,  1.23it/s] 89%|████████▊ | 362/409 [05:30<00:36,  1.27it/s] 89%|████████▉ | 363/409 [05:31<00:41,  1.11it/s] 89%|████████▉ | 364/409 [05:32<00:37,  1.19it/s] 89%|████████▉ | 365/409 [05:33<00:43,  1.01it/s] 89%|████████▉ | 366/409 [05:34<00:37,  1.14it/s] 90%|████████▉ | 367/409 [05:34<00:36,  1.15it/s] 90%|████████▉ | 368/409 [05:35<00:33,  1.22it/s] 90%|█████████ | 369/409 [05:36<00:34,  1.17it/s] 90%|█████████ | 370/409 [05:37<00:34,  1.12it/s] 91%|█████████ | 371/409 [05:38<00:36,  1.05it/s] 91%|█████████ | 372/409 [05:39<00:32,  1.14it/s] 91%|█████████ | 373/409 [05:40<00:30,  1.17it/s] 91%|█████████▏| 374/409 [05:40<00:29,  1.18it/s] 92%|█████████▏| 375/409 [05:41<00:29,  1.14it/s] 92%|█████████▏| 376/409 [05:43<00:32,  1.02it/s] 92%|█████████▏| 377/409 [05:43<00:29,  1.08it/s] 92%|█████████▏| 378/409 [05:44<00:27,  1.11it/s] 93%|█████████▎| 379/409 [05:45<00:28,  1.06it/s] 93%|█████████▎| 380/409 [05:46<00:26,  1.09it/s] 93%|█████████▎| 381/409 [05:47<00:25,  1.11it/s] 93%|█████████▎| 382/409 [05:48<00:27,  1.02s/it] 94%|█████████▎| 383/409 [05:49<00:23,  1.12it/s] 94%|█████████▍| 384/409 [05:50<00:25,  1.03s/it] 94%|█████████▍| 385/409 [05:51<00:19,  1.20it/s] 94%|█████████▍| 386/409 [05:51<00:15,  1.53it/s] 95%|█████████▍| 387/409 [05:51<00:12,  1.77it/s] 95%|█████████▍| 388/409 [05:52<00:12,  1.66it/s] 95%|█████████▌| 389/409 [05:53<00:12,  1.66it/s] 95%|█████████▌| 390/409 [05:53<00:12,  1.48it/s] 96%|█████████▌| 391/409 [05:54<00:11,  1.54it/s] 96%|█████████▌| 392/409 [05:55<00:10,  1.59it/s] 96%|█████████▌| 393/409 [05:56<00:12,  1.24it/s] 96%|█████████▋| 394/409 [05:57<00:12,  1.19it/s] 97%|█████████▋| 395/409 [05:58<00:13,  1.05it/s] 97%|█████████▋| 396/409 [05:59<00:11,  1.13it/s] 97%|█████████▋| 397/409 [06:00<00:11,  1.02it/s] 97%|█████████▋| 398/409 [06:01<00:09,  1.11it/s] 98%|█████████▊| 399/409 [06:01<00:08,  1.14it/s] 98%|█████████▊| 400/409 [06:02<00:07,  1.26it/s] 98%|█████████▊| 401/409 [06:03<00:07,  1.11it/s] 98%|█████████▊| 402/409 [06:04<00:06,  1.14it/s] 99%|█████████▊| 403/409 [06:05<00:05,  1.06it/s] 99%|█████████▉| 404/409 [06:06<00:05,  1.01s/it] 99%|█████████▉| 405/409 [06:07<00:04,  1.02s/it] 99%|█████████▉| 406/409 [06:08<00:02,  1.00it/s]100%|█████████▉| 407/409 [06:09<00:01,  1.10it/s]100%|█████████▉| 408/409 [06:10<00:00,  1.04it/s]100%|██████████| 409/409 [06:10<00:00,  1.21it/s]100%|██████████| 409/409 [06:10<00:00,  1.10it/s]
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:274: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
2023-11-01 13:54:12.382209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24015 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:17:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 268.62it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (22649 > 2048). Running this sequence through the model will result in indexing errors
/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:   1%|          | 1/100 [00:00<00:13,  7.27 examples/s]Map:  24%|██▍       | 24/100 [00:00<00:00, 116.65 examples/s]Map:  45%|████▌     | 45/100 [00:00<00:00, 108.07 examples/s]Map:  58%|█████▊    | 58/100 [00:00<00:00, 112.28 examples/s]Map:  80%|████████  | 80/100 [00:00<00:00, 136.49 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:07, 13.96it/s]  4%|▍         | 4/100 [00:00<00:06, 15.70it/s]  6%|▌         | 6/100 [00:00<00:05, 16.37it/s]  8%|▊         | 8/100 [00:00<00:05, 16.69it/s] 10%|█         | 10/100 [00:00<00:05, 16.86it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.98it/s] 14%|█▍        | 14/100 [00:00<00:05, 17.05it/s] 16%|█▌        | 16/100 [00:00<00:04, 17.11it/s] 18%|█▊        | 18/100 [00:01<00:04, 17.14it/s] 20%|██        | 20/100 [00:01<00:04, 17.15it/s] 22%|██▏       | 22/100 [00:01<00:04, 17.15it/s] 24%|██▍       | 24/100 [00:01<00:04, 17.16it/s] 26%|██▌       | 26/100 [00:01<00:04, 17.17it/s] 28%|██▊       | 28/100 [00:01<00:04, 17.16it/s] 30%|███       | 30/100 [00:01<00:04, 17.17it/s] 32%|███▏      | 32/100 [00:01<00:03, 17.17it/s] 34%|███▍      | 34/100 [00:02<00:03, 17.17it/s] 36%|███▌      | 36/100 [00:02<00:03, 17.16it/s] 38%|███▊      | 38/100 [00:02<00:03, 17.16it/s] 40%|████      | 40/100 [00:02<00:03, 17.15it/s] 42%|████▏     | 42/100 [00:02<00:03, 17.14it/s] 44%|████▍     | 44/100 [00:02<00:03, 17.15it/s] 46%|████▌     | 46/100 [00:02<00:03, 17.16it/s] 48%|████▊     | 48/100 [00:02<00:03, 17.15it/s] 50%|█████     | 50/100 [00:02<00:02, 17.16it/s] 52%|█████▏    | 52/100 [00:03<00:02, 17.16it/s] 54%|█████▍    | 54/100 [00:03<00:02, 17.17it/s] 56%|█████▌    | 56/100 [00:03<00:02, 17.16it/s] 58%|█████▊    | 58/100 [00:03<00:02, 17.16it/s] 60%|██████    | 60/100 [00:03<00:02, 17.17it/s] 62%|██████▏   | 62/100 [00:03<00:02, 17.17it/s] 64%|██████▍   | 64/100 [00:03<00:02, 17.16it/s] 66%|██████▌   | 66/100 [00:03<00:01, 17.17it/s] 68%|██████▊   | 68/100 [00:03<00:01, 17.17it/s] 70%|███████   | 70/100 [00:04<00:01, 17.17it/s] 72%|███████▏  | 72/100 [00:04<00:01, 17.16it/s] 74%|███████▍  | 74/100 [00:04<00:01, 17.17it/s] 76%|███████▌  | 76/100 [00:04<00:01, 17.18it/s] 78%|███████▊  | 78/100 [00:04<00:01, 17.18it/s] 80%|████████  | 80/100 [00:04<00:01, 17.18it/s] 82%|████████▏ | 82/100 [00:04<00:01, 17.17it/s] 84%|████████▍ | 84/100 [00:04<00:00, 17.17it/s] 86%|████████▌ | 86/100 [00:05<00:00, 17.18it/s] 88%|████████▊ | 88/100 [00:05<00:00, 17.18it/s] 90%|█████████ | 90/100 [00:05<00:00, 17.18it/s] 92%|█████████▏| 92/100 [00:05<00:00, 17.18it/s] 94%|█████████▍| 94/100 [00:05<00:00, 17.18it/s] 96%|█████████▌| 96/100 [00:05<00:00, 17.18it/s] 98%|█████████▊| 98/100 [00:05<00:00, 17.19it/s]100%|██████████| 100/100 [00:05<00:00, 17.20it/s]100%|██████████| 100/100 [00:05<00:00, 17.10it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 359.66it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:   9%|▉         | 9/100 [00:00<00:01, 74.67 examples/s]Map:  29%|██▉       | 29/100 [00:00<00:00, 131.80 examples/s]Map:  47%|████▋     | 47/100 [00:00<00:00, 149.13 examples/s]Map:  63%|██████▎   | 63/100 [00:00<00:00, 146.59 examples/s]Map:  87%|████████▋ | 87/100 [00:00<00:00, 175.70 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  7.05it/s]  2%|▏         | 2/100 [00:00<00:12,  7.62it/s]  3%|▎         | 3/100 [00:00<00:12,  7.94it/s]  4%|▍         | 4/100 [00:00<00:12,  7.93it/s]  5%|▌         | 5/100 [00:00<00:12,  7.92it/s]  6%|▌         | 6/100 [00:00<00:11,  8.00it/s]  7%|▋         | 7/100 [00:00<00:11,  7.91it/s]  8%|▊         | 8/100 [00:01<00:11,  7.98it/s]  9%|▉         | 9/100 [00:01<00:11,  7.87it/s] 10%|█         | 10/100 [00:01<00:11,  7.80it/s] 11%|█         | 11/100 [00:01<00:11,  7.78it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.88it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.85it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.93it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.97it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.99it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.83it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.82it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.79it/s] 20%|██        | 20/100 [00:02<00:10,  7.81it/s] 21%|██        | 21/100 [00:02<00:10,  7.86it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.75it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.88it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.57it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.65it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.50it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.71it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.65it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.69it/s] 30%|███       | 30/100 [00:03<00:08,  7.81it/s] 31%|███       | 31/100 [00:03<00:08,  7.68it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.83it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.91it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.97it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.84it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.89it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.85it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.81it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.91it/s] 40%|████      | 40/100 [00:05<00:07,  7.91it/s] 41%|████      | 41/100 [00:05<00:07,  7.91it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.95it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.79it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.90it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.98it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.68it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.78it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.78it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.60it/s] 50%|█████     | 50/100 [00:06<00:06,  7.78it/s] 51%|█████     | 51/100 [00:06<00:06,  7.65it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.64it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.79it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.89it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.95it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.98it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.96it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.73it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.76it/s] 60%|██████    | 60/100 [00:07<00:05,  7.70it/s] 61%|██████    | 61/100 [00:07<00:04,  7.82it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.83it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.77it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.88it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.77it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.80it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.88it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.83it/s] 70%|███████   | 70/100 [00:08<00:03,  7.92it/s] 71%|███████   | 71/100 [00:09<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.84it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.93it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.82it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.92it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.82it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.91it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.96it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.87it/s] 80%|████████  | 80/100 [00:10<00:02,  7.92it/s] 81%|████████  | 81/100 [00:10<00:02,  7.87it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.95it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.84it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.88it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.94it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.98it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.74it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.64it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.80it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.80it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.84it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.86it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.93it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.97it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.00it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.97it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.01it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.02it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.73it/s]100%|██████████| 100/100 [00:12<00:00,  7.88it/s]100%|██████████| 100/100 [00:12<00:00,  7.84it/s]
FOLD 0
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.261614  0.538189  5.588164     3.533264
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.15it/s]  6%|▋         | 2/32 [00:00<00:13,  2.15it/s]  9%|▉         | 3/32 [00:01<00:14,  2.06it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.05it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.96it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.92it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.85it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.82it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.72it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.65it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.62it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.59it/s] 41%|████      | 13/32 [00:07<00:12,  1.58it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.57it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.54it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.53it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.51it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.43it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.42it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.41it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.43it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.42it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.46it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.46it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.50it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.54it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.55it/s]100%|██████████| 32/32 [00:20<00:00,  1.41it/s]100%|██████████| 32/32 [00:20<00:00,  1.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.57191781 0.6010274  0.57191781 ... 0.57191781 0.57191781 0.57191781]
 [0.57363014 0.57191781 0.57191781 ... 0.60616438 0.57191781 0.57191781]
 [0.57191781 0.61472603 0.70376712 ... 0.60273973 0.57191781 0.62328767]
 ...
 [0.65924658 0.59760274 0.59760274 ... 0.63184932 0.57191781 0.57363014]
 [0.67123288 0.57363014 0.56506849 ... 0.6010274  0.65582192 0.57191781]
 [0.60787671 0.6130137  0.65068493 ... 0.63184932 0.64554795 0.65410959]]
Heads intervened:  [(5, 14), (5, 31), (6, 28), (8, 5), (8, 12), (8, 15), (9, 1), (9, 20), (9, 29), (10, 1), (10, 2), (10, 17), (10, 22), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 21), (11, 29), (11, 31), (12, 2), (12, 3), (12, 14), (13, 16), (13, 22), (13, 23), (13, 30), (14, 18), (14, 22), (15, 20), (15, 28), (16, 7), (16, 10), (16, 17), (17, 1), (17, 21), (17, 31), (18, 0), (18, 10), (20, 19), (20, 30), (22, 4), (22, 13), (22, 18), (30, 8), (31, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/408 [00:00<?, ?it/s]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 1/408 [00:01<12:01,  1.77s/it]  0%|          | 2/408 [00:02<09:41,  1.43s/it]  1%|          | 3/408 [00:04<08:40,  1.29s/it]  1%|          | 4/408 [00:05<10:08,  1.51s/it]  1%|          | 5/408 [00:06<07:56,  1.18s/it]  1%|▏         | 6/408 [00:07<07:08,  1.07s/it]  2%|▏         | 7/408 [00:07<05:19,  1.25it/s]  2%|▏         | 8/408 [00:08<05:39,  1.18it/s]  2%|▏         | 9/408 [00:09<04:53,  1.36it/s]  2%|▏         | 10/408 [00:09<04:38,  1.43it/s]  3%|▎         | 11/408 [00:11<05:53,  1.12it/s]  3%|▎         | 12/408 [00:11<05:49,  1.13it/s]  3%|▎         | 13/408 [00:12<05:29,  1.20it/s]  3%|▎         | 14/408 [00:13<05:47,  1.13it/s]  4%|▎         | 15/408 [00:14<05:32,  1.18it/s]  4%|▍         | 16/408 [00:15<05:17,  1.24it/s]  4%|▍         | 17/408 [00:15<04:53,  1.33it/s]  4%|▍         | 18/408 [00:16<05:17,  1.23it/s]  5%|▍         | 19/408 [00:17<04:37,  1.40it/s]  5%|▍         | 20/408 [00:17<04:10,  1.55it/s]  5%|▌         | 21/408 [00:18<05:27,  1.18it/s]  5%|▌         | 22/408 [00:19<05:26,  1.18it/s]  6%|▌         | 23/408 [00:21<07:36,  1.19s/it]  6%|▌         | 24/408 [00:22<07:09,  1.12s/it]  6%|▌         | 25/408 [00:23<07:18,  1.14s/it]  6%|▋         | 26/408 [00:24<07:08,  1.12s/it]  7%|▋         | 27/408 [00:25<06:37,  1.04s/it]  7%|▋         | 28/408 [00:26<05:47,  1.09it/s]  7%|▋         | 29/408 [00:27<06:56,  1.10s/it]  7%|▋         | 30/408 [00:28<06:15,  1.01it/s]  8%|▊         | 31/408 [00:30<07:18,  1.16s/it]  8%|▊         | 32/408 [00:31<06:53,  1.10s/it]  8%|▊         | 33/408 [00:32<06:21,  1.02s/it]  8%|▊         | 34/408 [00:33<06:42,  1.08s/it]  9%|▊         | 35/408 [00:34<06:16,  1.01s/it]  9%|▉         | 36/408 [00:34<04:49,  1.28it/s]  9%|▉         | 37/408 [00:35<04:46,  1.30it/s]  9%|▉         | 38/408 [00:35<04:28,  1.38it/s] 10%|▉         | 39/408 [00:36<04:13,  1.46it/s] 10%|▉         | 40/408 [00:37<05:09,  1.19it/s] 10%|█         | 41/408 [00:38<05:06,  1.20it/s] 10%|█         | 42/408 [00:39<05:05,  1.20it/s] 11%|█         | 43/408 [00:40<05:37,  1.08it/s] 11%|█         | 44/408 [00:41<05:54,  1.03it/s] 11%|█         | 45/408 [00:42<06:05,  1.01s/it] 11%|█▏        | 46/408 [00:43<06:52,  1.14s/it] 12%|█▏        | 47/408 [00:44<06:31,  1.08s/it] 12%|█▏        | 48/408 [00:45<06:12,  1.03s/it] 12%|█▏        | 49/408 [00:46<06:21,  1.06s/it] 12%|█▏        | 50/408 [00:48<06:20,  1.06s/it] 12%|█▎        | 51/408 [00:49<06:21,  1.07s/it] 13%|█▎        | 52/408 [00:49<05:56,  1.00s/it] 13%|█▎        | 53/408 [00:50<05:27,  1.08it/s] 13%|█▎        | 54/408 [00:51<05:58,  1.01s/it] 13%|█▎        | 55/408 [00:52<05:16,  1.12it/s] 14%|█▎        | 56/408 [00:53<05:10,  1.13it/s] 14%|█▍        | 57/408 [00:53<04:15,  1.37it/s] 14%|█▍        | 58/408 [00:55<05:48,  1.00it/s] 14%|█▍        | 59/408 [00:56<06:28,  1.11s/it] 15%|█▍        | 60/408 [00:58<06:52,  1.19s/it] 15%|█▍        | 61/408 [00:58<05:51,  1.01s/it] 15%|█▌        | 62/408 [00:59<05:35,  1.03it/s] 15%|█▌        | 63/408 [01:00<05:07,  1.12it/s] 16%|█▌        | 64/408 [01:01<04:48,  1.19it/s] 16%|█▌        | 65/408 [01:02<05:28,  1.04it/s] 16%|█▌        | 66/408 [01:02<04:38,  1.23it/s] 16%|█▋        | 67/408 [01:03<04:14,  1.34it/s] 17%|█▋        | 68/408 [01:04<04:12,  1.35it/s] 17%|█▋        | 69/408 [01:04<03:45,  1.50it/s] 17%|█▋        | 70/408 [01:05<04:12,  1.34it/s] 17%|█▋        | 71/408 [01:05<03:32,  1.59it/s] 18%|█▊        | 72/408 [01:07<05:31,  1.01it/s] 18%|█▊        | 73/408 [01:09<06:29,  1.16s/it] 18%|█▊        | 74/408 [01:09<05:22,  1.04it/s] 18%|█▊        | 75/408 [01:10<05:47,  1.04s/it] 19%|█▊        | 76/408 [01:11<05:16,  1.05it/s] 19%|█▉        | 77/408 [01:12<05:07,  1.08it/s] 19%|█▉        | 78/408 [01:13<05:10,  1.06it/s] 19%|█▉        | 79/408 [01:14<05:12,  1.05it/s] 20%|█▉        | 80/408 [01:15<05:40,  1.04s/it] 20%|█▉        | 81/408 [01:16<05:20,  1.02it/s] 20%|██        | 82/408 [01:17<04:56,  1.10it/s] 20%|██        | 83/408 [01:17<04:26,  1.22it/s] 21%|██        | 84/408 [01:19<05:07,  1.05it/s] 21%|██        | 85/408 [01:20<05:06,  1.05it/s] 21%|██        | 86/408 [01:21<05:58,  1.11s/it] 21%|██▏       | 87/408 [01:22<05:31,  1.03s/it] 22%|██▏       | 88/408 [01:23<05:45,  1.08s/it] 22%|██▏       | 89/408 [01:24<05:31,  1.04s/it] 22%|██▏       | 90/408 [01:25<04:37,  1.15it/s] 22%|██▏       | 91/408 [01:26<05:08,  1.03it/s] 23%|██▎       | 92/408 [01:27<04:58,  1.06it/s] 23%|██▎       | 93/408 [01:28<05:43,  1.09s/it] 23%|██▎       | 94/408 [01:29<05:44,  1.10s/it] 23%|██▎       | 95/408 [01:30<04:55,  1.06it/s] 24%|██▎       | 96/408 [01:31<04:35,  1.13it/s] 24%|██▍       | 97/408 [01:31<04:34,  1.13it/s] 24%|██▍       | 98/408 [01:33<04:55,  1.05it/s] 24%|██▍       | 99/408 [01:34<05:37,  1.09s/it] 25%|██▍       | 100/408 [01:35<05:14,  1.02s/it] 25%|██▍       | 101/408 [01:35<04:00,  1.27it/s] 25%|██▌       | 102/408 [01:36<03:53,  1.31it/s] 25%|██▌       | 103/408 [01:37<04:00,  1.27it/s] 25%|██▌       | 104/408 [01:37<04:05,  1.24it/s] 26%|██▌       | 105/408 [01:38<04:18,  1.17it/s] 26%|██▌       | 106/408 [01:40<05:09,  1.03s/it] 26%|██▌       | 107/408 [01:40<04:21,  1.15it/s] 26%|██▋       | 108/408 [01:41<04:42,  1.06it/s] 27%|██▋       | 109/408 [01:42<04:21,  1.14it/s] 27%|██▋       | 110/408 [01:43<03:55,  1.26it/s] 27%|██▋       | 111/408 [01:44<04:21,  1.14it/s] 27%|██▋       | 112/408 [01:45<03:56,  1.25it/s] 28%|██▊       | 113/408 [01:45<03:51,  1.28it/s] 28%|██▊       | 114/408 [01:47<04:41,  1.04it/s] 28%|██▊       | 115/408 [01:48<05:21,  1.10s/it] 28%|██▊       | 116/408 [01:49<05:30,  1.13s/it] 29%|██▊       | 117/408 [01:50<05:17,  1.09s/it] 29%|██▉       | 118/408 [01:51<05:15,  1.09s/it] 29%|██▉       | 119/408 [01:52<05:15,  1.09s/it] 29%|██▉       | 120/408 [01:53<04:53,  1.02s/it] 30%|██▉       | 121/408 [01:54<04:05,  1.17it/s] 30%|██▉       | 122/408 [01:54<03:42,  1.28it/s] 30%|███       | 123/408 [01:56<04:18,  1.10it/s] 30%|███       | 124/408 [01:56<04:01,  1.18it/s] 31%|███       | 125/408 [01:57<03:49,  1.23it/s] 31%|███       | 126/408 [01:58<03:40,  1.28it/s] 31%|███       | 127/408 [01:59<04:15,  1.10it/s] 31%|███▏      | 128/408 [01:59<03:18,  1.41it/s] 32%|███▏      | 129/408 [02:00<04:01,  1.15it/s] 32%|███▏      | 130/408 [02:02<04:52,  1.05s/it] 32%|███▏      | 131/408 [02:03<04:38,  1.01s/it] 32%|███▏      | 132/408 [02:04<04:23,  1.05it/s] 33%|███▎      | 133/408 [02:05<04:31,  1.01it/s] 33%|███▎      | 134/408 [02:06<05:36,  1.23s/it] 33%|███▎      | 135/408 [02:08<06:13,  1.37s/it] 33%|███▎      | 136/408 [02:09<05:52,  1.29s/it] 34%|███▎      | 137/408 [02:10<04:44,  1.05s/it] 34%|███▍      | 138/408 [02:11<04:38,  1.03s/it] 34%|███▍      | 139/408 [02:12<04:22,  1.02it/s] 34%|███▍      | 140/408 [02:13<05:11,  1.16s/it] 35%|███▍      | 141/408 [02:14<04:48,  1.08s/it] 35%|███▍      | 142/408 [02:15<05:05,  1.15s/it] 35%|███▌      | 143/408 [02:16<04:52,  1.10s/it] 35%|███▌      | 144/408 [02:17<04:30,  1.02s/it] 36%|███▌      | 145/408 [02:18<04:25,  1.01s/it] 36%|███▌      | 146/408 [02:19<04:12,  1.04it/s] 36%|███▌      | 147/408 [02:20<04:12,  1.03it/s] 36%|███▋      | 148/408 [02:21<03:53,  1.11it/s] 37%|███▋      | 149/408 [02:22<04:06,  1.05it/s] 37%|███▋      | 150/408 [02:23<04:09,  1.04it/s] 37%|███▋      | 151/408 [02:23<03:32,  1.21it/s] 37%|███▋      | 152/408 [02:24<03:49,  1.12it/s] 38%|███▊      | 153/408 [02:25<03:53,  1.09it/s] 38%|███▊      | 154/408 [02:26<03:48,  1.11it/s] 38%|███▊      | 155/408 [02:29<05:35,  1.33s/it] 38%|███▊      | 156/408 [02:29<05:04,  1.21s/it] 38%|███▊      | 157/408 [02:31<05:32,  1.33s/it] 39%|███▊      | 158/408 [02:32<05:14,  1.26s/it] 39%|███▉      | 159/408 [02:33<04:54,  1.18s/it] 39%|███▉      | 160/408 [02:34<04:12,  1.02s/it] 39%|███▉      | 161/408 [02:34<03:42,  1.11it/s] 40%|███▉      | 162/408 [02:35<03:36,  1.13it/s] 40%|███▉      | 163/408 [02:36<03:34,  1.14it/s] 40%|████      | 164/408 [02:37<03:22,  1.21it/s] 40%|████      | 165/408 [02:38<03:34,  1.13it/s] 41%|████      | 166/408 [02:39<03:30,  1.15it/s] 41%|████      | 167/408 [02:39<03:01,  1.33it/s] 41%|████      | 168/408 [02:40<02:51,  1.40it/s] 41%|████▏     | 169/408 [02:41<03:01,  1.32it/s] 42%|████▏     | 170/408 [02:42<03:14,  1.22it/s] 42%|████▏     | 171/408 [02:42<03:09,  1.25it/s] 42%|████▏     | 172/408 [02:43<02:55,  1.34it/s] 42%|████▏     | 173/408 [02:44<03:38,  1.08it/s] 43%|████▎     | 174/408 [02:46<04:03,  1.04s/it] 43%|████▎     | 175/408 [02:47<04:00,  1.03s/it] 43%|████▎     | 176/408 [02:47<03:40,  1.05it/s] 43%|████▎     | 177/408 [02:48<03:08,  1.22it/s] 44%|████▎     | 178/408 [02:49<03:42,  1.03it/s] 44%|████▍     | 179/408 [02:50<03:25,  1.12it/s] 44%|████▍     | 180/408 [02:51<03:13,  1.18it/s] 44%|████▍     | 181/408 [02:51<02:58,  1.27it/s] 45%|████▍     | 182/408 [02:52<03:03,  1.23it/s] 45%|████▍     | 183/408 [02:54<03:39,  1.02it/s] 45%|████▌     | 184/408 [02:54<03:13,  1.16it/s] 45%|████▌     | 185/408 [02:55<03:05,  1.20it/s] 46%|████▌     | 186/408 [02:56<03:13,  1.15it/s] 46%|████▌     | 187/408 [02:57<03:58,  1.08s/it] 46%|████▌     | 188/408 [02:58<03:35,  1.02it/s] 46%|████▋     | 189/408 [02:59<03:33,  1.03it/s] 47%|████▋     | 190/408 [03:00<03:32,  1.03it/s] 47%|████▋     | 191/408 [03:01<03:23,  1.06it/s] 47%|████▋     | 192/408 [03:02<03:33,  1.01it/s] 47%|████▋     | 193/408 [03:03<03:31,  1.02it/s] 48%|████▊     | 194/408 [03:04<03:15,  1.09it/s] 48%|████▊     | 195/408 [03:05<03:11,  1.11it/s] 48%|████▊     | 196/408 [03:05<02:45,  1.28it/s] 48%|████▊     | 197/408 [03:06<02:40,  1.31it/s] 49%|████▊     | 198/408 [03:07<02:29,  1.40it/s] 49%|████▉     | 199/408 [03:07<02:07,  1.64it/s] 49%|████▉     | 200/408 [03:08<02:38,  1.31it/s] 49%|████▉     | 201/408 [03:09<02:49,  1.22it/s] 50%|████▉     | 202/408 [03:10<02:44,  1.26it/s] 50%|████▉     | 203/408 [03:10<02:31,  1.35it/s] 50%|█████     | 204/408 [03:12<03:01,  1.13it/s] 50%|█████     | 205/408 [03:12<02:44,  1.23it/s] 50%|█████     | 206/408 [03:13<02:39,  1.27it/s] 51%|█████     | 207/408 [03:14<02:42,  1.24it/s] 51%|█████     | 208/408 [03:15<03:05,  1.08it/s] 51%|█████     | 209/408 [03:16<03:05,  1.07it/s] 51%|█████▏    | 210/408 [03:17<02:52,  1.14it/s] 52%|█████▏    | 211/408 [03:17<02:36,  1.26it/s] 52%|█████▏    | 212/408 [03:19<03:07,  1.05it/s] 52%|█████▏    | 213/408 [03:20<03:46,  1.16s/it] 52%|█████▏    | 214/408 [03:22<04:03,  1.26s/it] 53%|█████▎    | 215/408 [03:22<03:31,  1.10s/it] 53%|█████▎    | 216/408 [03:23<03:19,  1.04s/it] 53%|█████▎    | 217/408 [03:25<03:28,  1.09s/it] 53%|█████▎    | 218/408 [03:25<03:14,  1.03s/it] 54%|█████▎    | 219/408 [03:27<03:46,  1.20s/it] 54%|█████▍    | 220/408 [03:28<03:39,  1.17s/it] 54%|█████▍    | 221/408 [03:29<03:43,  1.19s/it] 54%|█████▍    | 222/408 [03:30<02:55,  1.06it/s] 55%|█████▍    | 223/408 [03:31<03:21,  1.09s/it] 55%|█████▍    | 224/408 [03:33<03:33,  1.16s/it] 55%|█████▌    | 225/408 [03:34<03:23,  1.11s/it] 55%|█████▌    | 226/408 [03:34<03:01,  1.00it/s] 56%|█████▌    | 227/408 [03:35<03:10,  1.05s/it] 56%|█████▌    | 228/408 [03:36<02:46,  1.08it/s] 56%|█████▌    | 229/408 [03:37<02:34,  1.16it/s] 56%|█████▋    | 230/408 [03:37<02:20,  1.27it/s] 57%|█████▋    | 231/408 [03:38<01:56,  1.53it/s] 57%|█████▋    | 232/408 [03:38<02:00,  1.46it/s] 57%|█████▋    | 233/408 [03:39<02:02,  1.43it/s] 57%|█████▋    | 234/408 [03:40<02:09,  1.34it/s] 58%|█████▊    | 235/408 [03:41<01:54,  1.51it/s] 58%|█████▊    | 236/408 [03:41<01:51,  1.54it/s] 58%|█████▊    | 237/408 [03:42<01:53,  1.50it/s] 58%|█████▊    | 238/408 [03:43<02:32,  1.11it/s] 59%|█████▊    | 239/408 [03:45<02:47,  1.01it/s] 59%|█████▉    | 240/408 [03:45<02:46,  1.01it/s] 59%|█████▉    | 241/408 [03:46<02:13,  1.25it/s] 59%|█████▉    | 242/408 [03:47<02:10,  1.27it/s] 60%|█████▉    | 243/408 [03:48<02:19,  1.18it/s] 60%|█████▉    | 244/408 [03:49<02:31,  1.08it/s] 60%|██████    | 245/408 [03:50<02:27,  1.11it/s] 60%|██████    | 246/408 [03:50<02:18,  1.17it/s] 61%|██████    | 247/408 [03:51<02:11,  1.23it/s] 61%|██████    | 248/408 [03:51<01:54,  1.40it/s] 61%|██████    | 249/408 [03:52<01:55,  1.38it/s] 61%|██████▏   | 250/408 [03:53<02:00,  1.31it/s] 62%|██████▏   | 251/408 [03:54<01:58,  1.33it/s] 62%|██████▏   | 252/408 [03:55<02:19,  1.12it/s] 62%|██████▏   | 253/408 [03:56<02:11,  1.18it/s] 62%|██████▏   | 254/408 [03:57<02:23,  1.07it/s] 62%|██████▎   | 255/408 [03:58<02:12,  1.16it/s] 63%|██████▎   | 256/408 [03:58<02:11,  1.16it/s] 63%|██████▎   | 257/408 [03:59<02:09,  1.16it/s] 63%|██████▎   | 258/408 [04:00<02:03,  1.22it/s] 63%|██████▎   | 259/408 [04:01<02:14,  1.11it/s] 64%|██████▎   | 260/408 [04:02<02:07,  1.16it/s] 64%|██████▍   | 261/408 [04:03<02:28,  1.01s/it] 64%|██████▍   | 262/408 [04:06<03:50,  1.58s/it] 64%|██████▍   | 263/408 [04:07<02:55,  1.21s/it] 65%|██████▍   | 264/408 [04:08<02:44,  1.14s/it] 65%|██████▍   | 265/408 [04:08<02:30,  1.05s/it] 65%|██████▌   | 266/408 [04:09<02:26,  1.03s/it] 65%|██████▌   | 267/408 [04:10<02:28,  1.05s/it] 66%|██████▌   | 268/408 [04:11<02:19,  1.00it/s] 66%|██████▌   | 269/408 [04:12<02:01,  1.14it/s] 66%|██████▌   | 270/408 [04:13<01:55,  1.20it/s] 66%|██████▋   | 271/408 [04:13<01:45,  1.30it/s] 67%|██████▋   | 272/408 [04:14<01:42,  1.32it/s] 67%|██████▋   | 273/408 [04:15<02:05,  1.08it/s] 67%|██████▋   | 274/408 [04:16<01:57,  1.14it/s] 67%|██████▋   | 275/408 [04:17<01:51,  1.19it/s] 68%|██████▊   | 276/408 [04:18<02:01,  1.09it/s] 68%|██████▊   | 277/408 [04:19<01:57,  1.12it/s] 68%|██████▊   | 278/408 [04:20<02:13,  1.03s/it] 68%|██████▊   | 279/408 [04:21<01:56,  1.11it/s] 69%|██████▊   | 280/408 [04:21<01:49,  1.17it/s] 69%|██████▉   | 281/408 [04:22<01:43,  1.23it/s] 69%|██████▉   | 282/408 [04:23<01:30,  1.39it/s] 69%|██████▉   | 283/408 [04:23<01:30,  1.39it/s] 70%|██████▉   | 284/408 [04:24<01:33,  1.32it/s] 70%|██████▉   | 285/408 [04:25<01:36,  1.27it/s] 70%|███████   | 286/408 [04:26<01:48,  1.13it/s] 70%|███████   | 287/408 [04:27<01:41,  1.19it/s] 71%|███████   | 288/408 [04:28<01:37,  1.23it/s] 71%|███████   | 289/408 [04:29<01:37,  1.23it/s] 71%|███████   | 290/408 [04:29<01:28,  1.34it/s] 71%|███████▏  | 291/408 [04:30<01:47,  1.09it/s] 72%|███████▏  | 292/408 [04:32<02:11,  1.13s/it] 72%|███████▏  | 293/408 [04:34<02:48,  1.46s/it] 72%|███████▏  | 294/408 [04:35<02:25,  1.28s/it] 72%|███████▏  | 295/408 [04:36<02:15,  1.20s/it] 73%|███████▎  | 296/408 [04:37<01:57,  1.05s/it] 73%|███████▎  | 297/408 [04:38<02:01,  1.09s/it] 73%|███████▎  | 298/408 [04:39<01:47,  1.02it/s] 73%|███████▎  | 299/408 [04:39<01:38,  1.11it/s] 74%|███████▎  | 300/408 [04:40<01:23,  1.29it/s] 74%|███████▍  | 301/408 [04:41<01:21,  1.31it/s] 74%|███████▍  | 302/408 [04:42<01:36,  1.10it/s] 74%|███████▍  | 303/408 [04:43<01:32,  1.13it/s] 75%|███████▍  | 304/408 [04:44<01:35,  1.08it/s] 75%|███████▍  | 305/408 [04:45<01:30,  1.14it/s] 75%|███████▌  | 306/408 [04:45<01:29,  1.15it/s] 75%|███████▌  | 307/408 [04:47<01:38,  1.02it/s] 75%|███████▌  | 308/408 [04:47<01:33,  1.07it/s] 76%|███████▌  | 309/408 [04:49<01:35,  1.04it/s] 76%|███████▌  | 310/408 [04:49<01:24,  1.16it/s] 76%|███████▌  | 311/408 [04:50<01:36,  1.00it/s] 76%|███████▋  | 312/408 [04:51<01:17,  1.24it/s] 77%|███████▋  | 313/408 [04:52<01:30,  1.05it/s] 77%|███████▋  | 314/408 [04:53<01:39,  1.06s/it] 77%|███████▋  | 315/408 [04:54<01:32,  1.00it/s] 77%|███████▋  | 316/408 [04:55<01:30,  1.01it/s] 78%|███████▊  | 317/408 [04:56<01:19,  1.14it/s] 78%|███████▊  | 318/408 [04:57<01:29,  1.01it/s] 78%|███████▊  | 319/408 [04:58<01:17,  1.14it/s] 78%|███████▊  | 320/408 [04:59<01:35,  1.09s/it] 79%|███████▊  | 321/408 [05:00<01:19,  1.10it/s] 79%|███████▉  | 322/408 [05:01<01:16,  1.12it/s] 79%|███████▉  | 323/408 [05:01<01:08,  1.23it/s] 79%|███████▉  | 324/408 [05:02<01:09,  1.21it/s] 80%|███████▉  | 325/408 [05:03<01:02,  1.32it/s] 80%|███████▉  | 326/408 [05:03<00:55,  1.47it/s] 80%|████████  | 327/408 [05:05<01:20,  1.01it/s] 80%|████████  | 328/408 [05:05<01:06,  1.20it/s] 81%|████████  | 329/408 [05:06<01:09,  1.14it/s] 81%|████████  | 330/408 [05:07<00:59,  1.32it/s] 81%|████████  | 331/408 [05:08<00:57,  1.34it/s] 81%|████████▏ | 332/408 [05:09<01:02,  1.22it/s] 82%|████████▏ | 333/408 [05:09<01:02,  1.21it/s] 82%|████████▏ | 334/408 [05:11<01:07,  1.10it/s] 82%|████████▏ | 335/408 [05:11<01:02,  1.17it/s] 82%|████████▏ | 336/408 [05:12<00:56,  1.28it/s] 83%|████████▎ | 337/408 [05:13<01:12,  1.03s/it] 83%|████████▎ | 338/408 [05:14<01:07,  1.03it/s] 83%|████████▎ | 339/408 [05:15<01:02,  1.10it/s] 83%|████████▎ | 340/408 [05:16<01:03,  1.07it/s] 84%|████████▎ | 341/408 [05:17<01:05,  1.02it/s] 84%|████████▍ | 342/408 [05:18<01:09,  1.05s/it] 84%|████████▍ | 343/408 [05:19<00:58,  1.12it/s] 84%|████████▍ | 344/408 [05:20<01:01,  1.03it/s] 85%|████████▍ | 345/408 [05:21<00:59,  1.06it/s] 85%|████████▍ | 346/408 [05:22<00:56,  1.09it/s] 85%|████████▌ | 347/408 [05:23<00:55,  1.11it/s] 85%|████████▌ | 348/408 [05:24<01:00,  1.00s/it] 86%|████████▌ | 349/408 [05:25<00:58,  1.01it/s] 86%|████████▌ | 350/408 [05:26<00:55,  1.05it/s] 86%|████████▌ | 351/408 [05:27<00:52,  1.09it/s] 86%|████████▋ | 352/408 [05:27<00:50,  1.11it/s] 87%|████████▋ | 353/408 [05:28<00:42,  1.29it/s] 87%|████████▋ | 354/408 [05:30<00:55,  1.03s/it] 87%|████████▋ | 355/408 [05:30<00:43,  1.21it/s] 87%|████████▋ | 356/408 [05:30<00:39,  1.32it/s] 88%|████████▊ | 357/408 [05:31<00:38,  1.34it/s] 88%|████████▊ | 358/408 [05:33<00:49,  1.00it/s] 88%|████████▊ | 359/408 [05:34<00:46,  1.05it/s] 88%|████████▊ | 360/408 [05:34<00:38,  1.23it/s] 88%|████████▊ | 361/408 [05:35<00:45,  1.03it/s] 89%|████████▊ | 362/408 [05:36<00:43,  1.06it/s] 89%|████████▉ | 363/408 [05:37<00:42,  1.06it/s] 89%|████████▉ | 364/408 [05:38<00:37,  1.18it/s] 89%|████████▉ | 365/408 [05:39<00:35,  1.21it/s] 90%|████████▉ | 366/408 [05:39<00:29,  1.41it/s] 90%|████████▉ | 367/408 [05:40<00:27,  1.50it/s] 90%|█████████ | 368/408 [05:40<00:27,  1.46it/s] 90%|█████████ | 369/408 [05:41<00:30,  1.28it/s] 91%|█████████ | 370/408 [05:43<00:33,  1.13it/s] 91%|█████████ | 371/408 [05:43<00:29,  1.24it/s] 91%|█████████ | 372/408 [05:44<00:33,  1.07it/s] 91%|█████████▏| 373/408 [05:45<00:34,  1.02it/s] 92%|█████████▏| 374/408 [05:47<00:41,  1.23s/it] 92%|█████████▏| 375/408 [05:48<00:35,  1.08s/it] 92%|█████████▏| 376/408 [05:49<00:33,  1.06s/it] 92%|█████████▏| 377/408 [05:50<00:32,  1.04s/it] 93%|█████████▎| 378/408 [05:51<00:30,  1.02s/it] 93%|█████████▎| 379/408 [05:52<00:29,  1.01s/it] 93%|█████████▎| 380/408 [05:53<00:29,  1.04s/it] 93%|█████████▎| 381/408 [05:54<00:27,  1.02s/it] 94%|█████████▎| 382/408 [05:55<00:27,  1.07s/it] 94%|█████████▍| 383/408 [05:56<00:26,  1.04s/it] 94%|█████████▍| 384/408 [05:57<00:26,  1.09s/it] 94%|█████████▍| 385/408 [05:59<00:26,  1.13s/it] 95%|█████████▍| 386/408 [06:00<00:25,  1.16s/it] 95%|█████████▍| 387/408 [06:01<00:21,  1.03s/it] 95%|█████████▌| 388/408 [06:01<00:18,  1.07it/s] 95%|█████████▌| 389/408 [06:02<00:17,  1.10it/s] 96%|█████████▌| 390/408 [06:03<00:15,  1.17it/s] 96%|█████████▌| 391/408 [06:04<00:15,  1.06it/s] 96%|█████████▌| 392/408 [06:06<00:18,  1.15s/it] 96%|█████████▋| 393/408 [06:06<00:14,  1.01it/s] 97%|█████████▋| 394/408 [06:07<00:13,  1.02it/s] 97%|█████████▋| 395/408 [06:08<00:11,  1.15it/s] 97%|█████████▋| 396/408 [06:09<00:09,  1.20it/s] 97%|█████████▋| 397/408 [06:09<00:09,  1.18it/s] 98%|█████████▊| 398/408 [06:10<00:08,  1.13it/s] 98%|█████████▊| 399/408 [06:11<00:08,  1.09it/s] 98%|█████████▊| 400/408 [06:12<00:07,  1.06it/s] 98%|█████████▊| 401/408 [06:13<00:06,  1.10it/s] 99%|█████████▊| 402/408 [06:14<00:05,  1.03it/s] 99%|█████████▉| 403/408 [06:15<00:03,  1.26it/s] 99%|█████████▉| 404/408 [06:16<00:03,  1.18it/s] 99%|█████████▉| 405/408 [06:17<00:03,  1.01s/it]100%|█████████▉| 406/408 [06:18<00:02,  1.01s/it]100%|█████████▉| 407/408 [06:19<00:00,  1.08it/s]100%|██████████| 408/408 [06:20<00:00,  1.16it/s]100%|██████████| 408/408 [06:20<00:00,  1.07it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 266.09it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (7029 > 2048). Running this sequence through the model will result in indexing errors
Map:  22%|██▏       | 22/100 [00:00<00:00, 157.28 examples/s]Map:  45%|████▌     | 45/100 [00:00<00:00, 118.40 examples/s]Map:  70%|███████   | 70/100 [00:00<00:00, 132.52 examples/s]Map:  92%|█████████▏| 92/100 [00:00<00:00, 154.45 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:05, 16.36it/s]  4%|▍         | 4/100 [00:00<00:05, 16.65it/s]  6%|▌         | 6/100 [00:00<00:05, 16.79it/s]  8%|▊         | 8/100 [00:00<00:05, 16.85it/s] 10%|█         | 10/100 [00:00<00:05, 16.88it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.89it/s] 14%|█▍        | 14/100 [00:00<00:05, 16.91it/s] 16%|█▌        | 16/100 [00:00<00:04, 16.91it/s] 18%|█▊        | 18/100 [00:01<00:04, 16.92it/s] 20%|██        | 20/100 [00:01<00:04, 16.93it/s] 22%|██▏       | 22/100 [00:01<00:04, 16.92it/s] 24%|██▍       | 24/100 [00:01<00:04, 16.92it/s] 26%|██▌       | 26/100 [00:01<00:04, 16.92it/s] 28%|██▊       | 28/100 [00:01<00:04, 16.93it/s] 30%|███       | 30/100 [00:01<00:04, 16.93it/s] 32%|███▏      | 32/100 [00:01<00:04, 16.93it/s] 34%|███▍      | 34/100 [00:02<00:03, 16.93it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.93it/s] 38%|███▊      | 38/100 [00:02<00:03, 16.92it/s] 40%|████      | 40/100 [00:02<00:03, 16.92it/s] 42%|████▏     | 42/100 [00:02<00:03, 16.94it/s] 44%|████▍     | 44/100 [00:02<00:03, 16.95it/s] 46%|████▌     | 46/100 [00:02<00:03, 16.94it/s] 48%|████▊     | 48/100 [00:02<00:03, 16.94it/s] 50%|█████     | 50/100 [00:02<00:02, 16.93it/s] 52%|█████▏    | 52/100 [00:03<00:02, 16.93it/s] 54%|█████▍    | 54/100 [00:03<00:02, 16.94it/s] 56%|█████▌    | 56/100 [00:03<00:02, 16.94it/s] 58%|█████▊    | 58/100 [00:03<00:02, 16.93it/s] 60%|██████    | 60/100 [00:03<00:02, 16.93it/s] 62%|██████▏   | 62/100 [00:03<00:02, 16.92it/s] 64%|██████▍   | 64/100 [00:03<00:02, 16.93it/s] 66%|██████▌   | 66/100 [00:03<00:02, 16.94it/s] 68%|██████▊   | 68/100 [00:04<00:01, 16.94it/s] 70%|███████   | 70/100 [00:04<00:01, 16.95it/s] 72%|███████▏  | 72/100 [00:04<00:01, 16.95it/s] 74%|███████▍  | 74/100 [00:04<00:01, 16.92it/s] 76%|███████▌  | 76/100 [00:04<00:01, 16.92it/s] 78%|███████▊  | 78/100 [00:04<00:01, 16.92it/s] 80%|████████  | 80/100 [00:04<00:01, 16.93it/s] 82%|████████▏ | 82/100 [00:04<00:01, 16.93it/s] 84%|████████▍ | 84/100 [00:04<00:00, 16.93it/s] 86%|████████▌ | 86/100 [00:05<00:00, 16.87it/s] 88%|████████▊ | 88/100 [00:05<00:00, 16.87it/s] 90%|█████████ | 90/100 [00:05<00:00, 16.89it/s] 92%|█████████▏| 92/100 [00:05<00:00, 16.90it/s] 94%|█████████▍| 94/100 [00:05<00:00, 16.92it/s] 96%|█████████▌| 96/100 [00:05<00:00, 16.93it/s] 98%|█████████▊| 98/100 [00:05<00:00, 16.93it/s]100%|██████████| 100/100 [00:05<00:00, 16.94it/s]100%|██████████| 100/100 [00:05<00:00, 16.91it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 356.17it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  18%|█▊        | 18/100 [00:00<00:00, 120.02 examples/s]Map:  33%|███▎      | 33/100 [00:00<00:00, 123.02 examples/s]Map:  55%|█████▌    | 55/100 [00:00<00:00, 157.90 examples/s]Map:  81%|████████  | 81/100 [00:00<00:00, 148.62 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.42it/s]  2%|▏         | 2/100 [00:00<00:12,  7.61it/s]  3%|▎         | 3/100 [00:00<00:12,  7.85it/s]  4%|▍         | 4/100 [00:00<00:12,  7.84it/s]  5%|▌         | 5/100 [00:00<00:12,  7.88it/s]  6%|▌         | 6/100 [00:00<00:12,  7.71it/s]  7%|▋         | 7/100 [00:00<00:12,  7.57it/s]  8%|▊         | 8/100 [00:01<00:12,  7.52it/s]  9%|▉         | 9/100 [00:01<00:12,  7.49it/s] 10%|█         | 10/100 [00:01<00:11,  7.66it/s] 11%|█         | 11/100 [00:01<00:11,  7.76it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.65it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.58it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.68it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.55it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.47it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.50it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.47it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.64it/s] 20%|██        | 20/100 [00:02<00:10,  7.75it/s] 21%|██        | 21/100 [00:02<00:10,  7.82it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.65it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.58it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.69it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.75it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.60it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.46it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.53it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.60it/s] 30%|███       | 30/100 [00:03<00:09,  7.57it/s] 31%|███       | 31/100 [00:04<00:09,  7.61it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.72it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.78it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.57it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.50it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.53it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.45it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.42it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.53it/s] 40%|████      | 40/100 [00:05<00:07,  7.66it/s] 41%|████      | 41/100 [00:05<00:07,  7.76it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.73it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.66it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.69it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.63it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.53it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.58it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.56it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.45it/s] 50%|█████     | 50/100 [00:06<00:06,  7.44it/s] 51%|█████     | 51/100 [00:06<00:06,  7.62it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.73it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.59it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.53it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.54it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.57it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.56it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.55it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.45it/s] 60%|██████    | 60/100 [00:07<00:05,  7.45it/s] 61%|██████    | 61/100 [00:08<00:05,  7.44it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.47it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.39it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.44it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.59it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.62it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.55it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.67it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.47it/s] 70%|███████   | 70/100 [00:09<00:04,  7.47it/s] 71%|███████   | 71/100 [00:09<00:03,  7.51it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.43it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.48it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.61it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.58it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.45it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.43it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.52it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.59it/s] 80%|████████  | 80/100 [00:10<00:02,  7.57it/s] 81%|████████  | 81/100 [00:10<00:02,  7.40it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.41it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.60it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.72it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.78it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.62it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.75it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.83it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.60it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.49it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.62it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.54it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.57it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.45it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.61it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.73it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.79it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.57it/s]100%|██████████| 100/100 [00:13<00:00,  7.49it/s]100%|██████████| 100/100 [00:13<00:00,  7.58it/s]
FOLD 1
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.306373  0.582102  5.389062     3.292552
[0.28399312 0.56014552 5.48861328 3.41290823]
MC1 Score: 0.2839931204755741, MC2 Score: 0.5601455165121818, CE Loss: 5.48861328125, KL wrt Original: 3.4129082316160204
2023-11-01 14:01:53.434586: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:01:53.483384: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:01:54.232430: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 365.17it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.80it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.15it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.09it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 452.85it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.09it/s]  6%|▋         | 2/32 [00:00<00:14,  2.14it/s]  9%|▉         | 3/32 [00:01<00:14,  2.03it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.05it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.99it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.92it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.88it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.86it/s] 28%|██▊       | 9/32 [00:04<00:12,  1.79it/s] 31%|███▏      | 10/32 [00:05<00:12,  1.71it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.66it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.64it/s] 41%|████      | 13/32 [00:07<00:11,  1.63it/s] 44%|████▍     | 14/32 [00:07<00:11,  1.60it/s] 47%|████▋     | 15/32 [00:08<00:10,  1.55it/s] 50%|█████     | 16/32 [00:09<00:10,  1.55it/s] 53%|█████▎    | 17/32 [00:09<00:09,  1.54it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.50it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.42it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:06,  1.43it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.45it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.43it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.44it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.47it/s] 84%|████████▍ | 27/32 [00:16<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.49it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.48it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.50it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.53it/s]100%|██████████| 32/32 [00:20<00:00,  1.40it/s]100%|██████████| 32/32 [00:20<00:00,  1.57it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.59003215 0.60610932 0.58681672 ... 0.58681672 0.58681672 0.58681672]
 [0.58681672 0.58681672 0.58681672 ... 0.63344051 0.58681672 0.58681672]
 [0.58681672 0.60128617 0.75723473 ... 0.62540193 0.58681672 0.62540193]
 ...
 [0.74758842 0.60128617 0.61093248 ... 0.64630225 0.59324759 0.58681672]
 [0.73794212 0.61736334 0.61093248 ... 0.63504823 0.71221865 0.58681672]
 [0.62540193 0.70900322 0.77170418 ... 0.68167203 0.67524116 0.72990354]]
Heads intervened:  [(7, 14), (7, 23), (7, 27), (8, 5), (8, 12), (9, 20), (9, 29), (10, 1), (10, 2), (10, 12), (10, 17), (10, 22), (10, 28), (11, 0), (11, 6), (11, 8), (11, 21), (11, 29), (11, 31), (12, 12), (12, 25), (13, 16), (13, 22), (14, 0), (14, 12), (14, 14), (14, 18), (14, 22), (15, 1), (15, 20), (15, 28), (16, 11), (16, 13), (16, 26), (17, 1), (17, 12), (17, 31), (18, 0), (18, 9), (18, 17), (19, 6), (19, 19), (20, 30), (21, 22), (22, 4), (25, 13), (30, 22), (31, 19)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/409 [00:00<?, ?it/s]  0%|          | 1/409 [00:01<09:21,  1.38s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 2/409 [00:02<07:42,  1.14s/it]  1%|          | 3/409 [00:03<06:31,  1.04it/s]  1%|          | 4/409 [00:03<06:14,  1.08it/s]  1%|          | 5/409 [00:05<06:38,  1.01it/s]  1%|▏         | 6/409 [00:06<06:54,  1.03s/it]  2%|▏         | 7/409 [00:06<05:58,  1.12it/s]  2%|▏         | 8/409 [00:08<07:20,  1.10s/it]  2%|▏         | 9/409 [00:10<08:53,  1.33s/it]  2%|▏         | 10/409 [00:11<08:05,  1.22s/it]  3%|▎         | 11/409 [00:11<07:19,  1.10s/it]  3%|▎         | 12/409 [00:12<06:19,  1.05it/s]  3%|▎         | 13/409 [00:13<05:37,  1.17it/s]  3%|▎         | 14/409 [00:13<05:07,  1.28it/s]  4%|▎         | 15/409 [00:14<05:29,  1.20it/s]  4%|▍         | 16/409 [00:15<05:33,  1.18it/s]  4%|▍         | 17/409 [00:16<06:15,  1.04it/s]  4%|▍         | 18/409 [00:18<06:59,  1.07s/it]  5%|▍         | 19/409 [00:18<06:16,  1.04it/s]  5%|▍         | 20/409 [00:20<06:27,  1.01it/s]  5%|▌         | 21/409 [00:20<05:54,  1.09it/s]  5%|▌         | 22/409 [00:22<06:41,  1.04s/it]  6%|▌         | 23/409 [00:23<07:01,  1.09s/it]  6%|▌         | 24/409 [00:24<06:36,  1.03s/it]  6%|▌         | 25/409 [00:25<06:57,  1.09s/it]  6%|▋         | 26/409 [00:26<07:06,  1.11s/it]  7%|▋         | 27/409 [00:27<06:36,  1.04s/it]  7%|▋         | 28/409 [00:28<07:33,  1.19s/it]  7%|▋         | 29/409 [00:30<07:31,  1.19s/it]  7%|▋         | 30/409 [00:30<06:37,  1.05s/it]  8%|▊         | 31/409 [00:31<06:31,  1.04s/it]  8%|▊         | 32/409 [00:32<06:27,  1.03s/it]  8%|▊         | 33/409 [00:34<06:47,  1.08s/it]  8%|▊         | 34/409 [00:34<05:52,  1.06it/s]  9%|▊         | 35/409 [00:35<06:05,  1.02it/s]  9%|▉         | 36/409 [00:36<06:00,  1.03it/s]  9%|▉         | 37/409 [00:37<05:21,  1.16it/s]  9%|▉         | 38/409 [00:38<05:08,  1.20it/s] 10%|▉         | 39/409 [00:38<05:09,  1.20it/s] 10%|▉         | 40/409 [00:39<04:55,  1.25it/s] 10%|█         | 41/409 [00:41<06:03,  1.01it/s] 10%|█         | 42/409 [00:41<05:51,  1.04it/s] 11%|█         | 43/409 [00:42<05:37,  1.08it/s] 11%|█         | 44/409 [00:43<05:58,  1.02it/s] 11%|█         | 45/409 [00:45<06:10,  1.02s/it] 11%|█         | 46/409 [00:46<06:17,  1.04s/it] 11%|█▏        | 47/409 [00:46<05:29,  1.10it/s] 12%|█▏        | 48/409 [00:47<05:33,  1.08it/s] 12%|█▏        | 49/409 [00:49<06:18,  1.05s/it] 12%|█▏        | 50/409 [00:49<05:56,  1.01it/s] 12%|█▏        | 51/409 [00:51<06:29,  1.09s/it] 13%|█▎        | 52/409 [00:52<06:30,  1.09s/it] 13%|█▎        | 53/409 [00:52<05:24,  1.10it/s] 13%|█▎        | 54/409 [00:53<05:26,  1.09it/s] 13%|█▎        | 55/409 [00:54<04:52,  1.21it/s] 14%|█▎        | 56/409 [00:55<04:40,  1.26it/s] 14%|█▍        | 57/409 [00:56<04:59,  1.17it/s] 14%|█▍        | 58/409 [00:57<06:01,  1.03s/it] 14%|█▍        | 59/409 [00:58<05:19,  1.09it/s] 15%|█▍        | 60/409 [00:59<05:37,  1.04it/s] 15%|█▍        | 61/409 [00:59<04:33,  1.27it/s] 15%|█▌        | 62/409 [01:00<04:11,  1.38it/s] 15%|█▌        | 63/409 [01:01<05:26,  1.06it/s] 16%|█▌        | 64/409 [01:01<04:12,  1.37it/s] 16%|█▌        | 65/409 [01:02<03:47,  1.51it/s] 16%|█▌        | 66/409 [01:03<05:05,  1.12it/s] 16%|█▋        | 67/409 [01:05<06:04,  1.07s/it] 17%|█▋        | 68/409 [01:05<05:05,  1.12it/s] 17%|█▋        | 69/409 [01:06<05:00,  1.13it/s] 17%|█▋        | 70/409 [01:07<05:06,  1.11it/s] 17%|█▋        | 71/409 [01:08<04:46,  1.18it/s] 18%|█▊        | 72/409 [01:09<05:35,  1.00it/s] 18%|█▊        | 73/409 [01:10<05:32,  1.01it/s] 18%|█▊        | 74/409 [01:11<05:06,  1.09it/s] 18%|█▊        | 75/409 [01:12<05:56,  1.07s/it] 19%|█▊        | 76/409 [01:13<05:58,  1.08s/it] 19%|█▉        | 77/409 [01:14<05:47,  1.05s/it] 19%|█▉        | 78/409 [01:15<05:24,  1.02it/s] 19%|█▉        | 79/409 [01:16<05:46,  1.05s/it] 20%|█▉        | 80/409 [01:17<05:12,  1.05it/s] 20%|█▉        | 81/409 [01:18<05:14,  1.04it/s] 20%|██        | 82/409 [01:19<05:04,  1.07it/s] 20%|██        | 83/409 [01:20<04:43,  1.15it/s] 21%|██        | 84/409 [01:21<04:42,  1.15it/s] 21%|██        | 85/409 [01:22<05:01,  1.07it/s] 21%|██        | 86/409 [01:22<04:52,  1.10it/s] 21%|██▏       | 87/409 [01:24<05:10,  1.04it/s] 22%|██▏       | 88/409 [01:25<05:47,  1.08s/it] 22%|██▏       | 89/409 [01:26<05:00,  1.07it/s] 22%|██▏       | 90/409 [01:26<04:39,  1.14it/s] 22%|██▏       | 91/409 [01:28<05:16,  1.01it/s] 22%|██▏       | 92/409 [01:28<04:36,  1.15it/s] 23%|██▎       | 93/409 [01:29<04:22,  1.21it/s] 23%|██▎       | 94/409 [01:29<03:48,  1.38it/s] 23%|██▎       | 95/409 [01:30<04:09,  1.26it/s] 23%|██▎       | 96/409 [01:31<04:24,  1.18it/s] 24%|██▎       | 97/409 [01:32<04:22,  1.19it/s] 24%|██▍       | 98/409 [01:33<04:10,  1.24it/s] 24%|██▍       | 99/409 [01:34<04:05,  1.27it/s] 24%|██▍       | 100/409 [01:34<03:56,  1.31it/s] 25%|██▍       | 101/409 [01:35<04:26,  1.16it/s] 25%|██▍       | 102/409 [01:36<04:22,  1.17it/s] 25%|██▌       | 103/409 [01:37<04:42,  1.08it/s] 25%|██▌       | 104/409 [01:38<04:46,  1.06it/s] 26%|██▌       | 105/409 [01:39<04:38,  1.09it/s] 26%|██▌       | 106/409 [01:40<04:30,  1.12it/s] 26%|██▌       | 107/409 [01:40<03:42,  1.36it/s] 26%|██▋       | 108/409 [01:41<03:30,  1.43it/s] 27%|██▋       | 109/409 [01:42<03:32,  1.41it/s] 27%|██▋       | 110/409 [01:42<03:33,  1.40it/s] 27%|██▋       | 111/409 [01:43<04:04,  1.22it/s] 27%|██▋       | 112/409 [01:44<04:05,  1.21it/s] 28%|██▊       | 113/409 [01:45<04:38,  1.06it/s] 28%|██▊       | 114/409 [01:46<04:18,  1.14it/s] 28%|██▊       | 115/409 [01:47<04:24,  1.11it/s] 28%|██▊       | 116/409 [01:49<05:10,  1.06s/it] 29%|██▊       | 117/409 [01:50<05:20,  1.10s/it] 29%|██▉       | 118/409 [01:50<04:26,  1.09it/s] 29%|██▉       | 119/409 [01:51<04:31,  1.07it/s] 29%|██▉       | 120/409 [01:52<04:34,  1.05it/s] 30%|██▉       | 121/409 [01:53<04:32,  1.06it/s] 30%|██▉       | 122/409 [01:55<05:26,  1.14s/it] 30%|███       | 123/409 [01:55<04:49,  1.01s/it] 30%|███       | 124/409 [01:56<04:33,  1.04it/s] 31%|███       | 125/409 [01:57<04:22,  1.08it/s] 31%|███       | 126/409 [01:58<04:04,  1.16it/s] 31%|███       | 127/409 [01:59<04:04,  1.15it/s] 31%|███▏      | 128/409 [02:00<03:53,  1.20it/s] 32%|███▏      | 129/409 [02:00<04:03,  1.15it/s] 32%|███▏      | 130/409 [02:01<03:52,  1.20it/s] 32%|███▏      | 131/409 [02:02<03:32,  1.31it/s] 32%|███▏      | 132/409 [02:03<03:27,  1.33it/s] 33%|███▎      | 133/409 [02:03<03:14,  1.42it/s] 33%|███▎      | 134/409 [02:04<03:44,  1.22it/s] 33%|███▎      | 135/409 [02:05<03:46,  1.21it/s] 33%|███▎      | 136/409 [02:06<03:27,  1.32it/s] 33%|███▎      | 137/409 [02:07<03:42,  1.22it/s] 34%|███▎      | 138/409 [02:08<04:13,  1.07it/s] 34%|███▍      | 139/409 [02:09<04:41,  1.04s/it] 34%|███▍      | 140/409 [02:10<03:54,  1.15it/s] 34%|███▍      | 141/409 [02:10<03:22,  1.32it/s] 35%|███▍      | 142/409 [02:11<03:08,  1.41it/s] 35%|███▍      | 143/409 [02:12<04:20,  1.02it/s] 35%|███▌      | 144/409 [02:13<04:36,  1.04s/it] 35%|███▌      | 145/409 [02:14<04:30,  1.03s/it] 36%|███▌      | 146/409 [02:15<04:08,  1.06it/s] 36%|███▌      | 147/409 [02:16<03:59,  1.09it/s] 36%|███▌      | 148/409 [02:17<03:46,  1.15it/s] 36%|███▋      | 149/409 [02:18<03:43,  1.16it/s] 37%|███▋      | 150/409 [02:18<03:30,  1.23it/s] 37%|███▋      | 151/409 [02:19<03:22,  1.27it/s] 37%|███▋      | 152/409 [02:20<03:47,  1.13it/s] 37%|███▋      | 153/409 [02:21<03:47,  1.13it/s] 38%|███▊      | 154/409 [02:21<03:06,  1.37it/s] 38%|███▊      | 155/409 [02:22<02:47,  1.52it/s] 38%|███▊      | 156/409 [02:23<03:11,  1.32it/s] 38%|███▊      | 157/409 [02:24<03:08,  1.34it/s] 39%|███▊      | 158/409 [02:25<03:15,  1.28it/s] 39%|███▉      | 159/409 [02:26<03:38,  1.14it/s] 39%|███▉      | 160/409 [02:27<03:46,  1.10it/s] 39%|███▉      | 161/409 [02:28<04:06,  1.01it/s] 40%|███▉      | 162/409 [02:29<03:45,  1.10it/s] 40%|███▉      | 163/409 [02:31<05:24,  1.32s/it] 40%|████      | 164/409 [02:32<05:03,  1.24s/it] 40%|████      | 165/409 [02:33<05:10,  1.27s/it] 41%|████      | 166/409 [02:34<04:58,  1.23s/it] 41%|████      | 167/409 [02:35<04:37,  1.15s/it] 41%|████      | 168/409 [02:37<04:59,  1.24s/it] 41%|████▏     | 169/409 [02:38<05:04,  1.27s/it] 42%|████▏     | 170/409 [02:39<04:39,  1.17s/it] 42%|████▏     | 171/409 [02:40<04:15,  1.07s/it] 42%|████▏     | 172/409 [02:41<04:09,  1.05s/it] 42%|████▏     | 173/409 [02:42<03:43,  1.05it/s] 43%|████▎     | 174/409 [02:43<03:44,  1.05it/s] 43%|████▎     | 175/409 [02:44<04:07,  1.06s/it] 43%|████▎     | 176/409 [02:44<03:34,  1.09it/s] 43%|████▎     | 177/409 [02:46<04:02,  1.05s/it] 44%|████▎     | 178/409 [02:47<03:47,  1.02it/s] 44%|████▍     | 179/409 [02:48<04:03,  1.06s/it] 44%|████▍     | 180/409 [02:49<03:40,  1.04it/s] 44%|████▍     | 181/409 [02:49<03:15,  1.17it/s] 44%|████▍     | 182/409 [02:50<03:07,  1.21it/s] 45%|████▍     | 183/409 [02:51<02:59,  1.26it/s] 45%|████▍     | 184/409 [02:52<03:03,  1.23it/s] 45%|████▌     | 185/409 [02:53<03:20,  1.12it/s] 45%|████▌     | 186/409 [02:54<03:41,  1.01it/s] 46%|████▌     | 187/409 [02:55<03:36,  1.03it/s] 46%|████▌     | 188/409 [02:56<03:20,  1.10it/s] 46%|████▌     | 189/409 [02:56<03:08,  1.17it/s] 46%|████▋     | 190/409 [02:57<03:08,  1.16it/s] 47%|████▋     | 191/409 [02:58<03:06,  1.17it/s] 47%|████▋     | 192/409 [02:59<03:11,  1.13it/s] 47%|████▋     | 193/409 [03:00<03:16,  1.10it/s] 47%|████▋     | 194/409 [03:01<03:04,  1.16it/s] 48%|████▊     | 195/409 [03:02<03:10,  1.13it/s] 48%|████▊     | 196/409 [03:03<03:22,  1.05it/s] 48%|████▊     | 197/409 [03:04<03:46,  1.07s/it] 48%|████▊     | 198/409 [03:05<03:39,  1.04s/it] 49%|████▊     | 199/409 [03:06<03:10,  1.10it/s] 49%|████▉     | 200/409 [03:07<03:23,  1.03it/s] 49%|████▉     | 201/409 [03:07<03:06,  1.11it/s] 49%|████▉     | 202/409 [03:08<03:12,  1.07it/s] 50%|████▉     | 203/409 [03:09<02:43,  1.26it/s] 50%|████▉     | 204/409 [03:10<02:45,  1.24it/s] 50%|█████     | 205/409 [03:11<03:25,  1.01s/it] 50%|█████     | 206/409 [03:12<02:58,  1.14it/s] 51%|█████     | 207/409 [03:13<03:04,  1.09it/s] 51%|█████     | 208/409 [03:14<02:52,  1.16it/s] 51%|█████     | 209/409 [03:14<02:43,  1.22it/s] 51%|█████▏    | 210/409 [03:15<02:52,  1.15it/s] 52%|█████▏    | 211/409 [03:16<02:36,  1.27it/s] 52%|█████▏    | 212/409 [03:16<02:23,  1.37it/s] 52%|█████▏    | 213/409 [03:18<02:44,  1.19it/s] 52%|█████▏    | 214/409 [03:19<02:56,  1.11it/s] 53%|█████▎    | 215/409 [03:19<02:45,  1.17it/s] 53%|█████▎    | 216/409 [03:22<04:13,  1.31s/it] 53%|█████▎    | 217/409 [03:22<03:31,  1.10s/it] 53%|█████▎    | 218/409 [03:23<02:54,  1.09it/s] 54%|█████▎    | 219/409 [03:24<02:42,  1.17it/s] 54%|█████▍    | 220/409 [03:24<02:35,  1.21it/s] 54%|█████▍    | 221/409 [03:25<02:29,  1.26it/s] 54%|█████▍    | 222/409 [03:26<02:31,  1.23it/s] 55%|█████▍    | 223/409 [03:27<02:35,  1.20it/s] 55%|█████▍    | 224/409 [03:28<02:34,  1.19it/s] 55%|█████▌    | 225/409 [03:28<02:22,  1.29it/s] 55%|█████▌    | 226/409 [03:29<02:27,  1.24it/s] 56%|█████▌    | 227/409 [03:30<02:16,  1.34it/s] 56%|█████▌    | 228/409 [03:31<02:41,  1.12it/s] 56%|█████▌    | 229/409 [03:31<02:18,  1.30it/s] 56%|█████▌    | 230/409 [03:32<02:22,  1.26it/s] 56%|█████▋    | 231/409 [03:33<02:23,  1.24it/s] 57%|█████▋    | 232/409 [03:34<02:43,  1.08it/s] 57%|█████▋    | 233/409 [03:35<02:32,  1.15it/s] 57%|█████▋    | 234/409 [03:36<02:24,  1.21it/s] 57%|█████▋    | 235/409 [03:36<02:11,  1.32it/s] 58%|█████▊    | 236/409 [03:37<02:16,  1.27it/s] 58%|█████▊    | 237/409 [03:38<01:59,  1.43it/s] 58%|█████▊    | 238/409 [03:39<02:25,  1.17it/s] 58%|█████▊    | 239/409 [03:41<03:20,  1.18s/it] 59%|█████▊    | 240/409 [03:42<02:56,  1.04s/it] 59%|█████▉    | 241/409 [03:42<02:44,  1.02it/s] 59%|█████▉    | 242/409 [03:44<02:54,  1.05s/it] 59%|█████▉    | 243/409 [03:44<02:37,  1.05it/s] 60%|█████▉    | 244/409 [03:46<02:56,  1.07s/it] 60%|█████▉    | 245/409 [03:46<02:32,  1.07it/s] 60%|██████    | 246/409 [03:47<02:09,  1.25it/s] 60%|██████    | 247/409 [03:48<02:17,  1.18it/s] 61%|██████    | 248/409 [03:49<02:14,  1.20it/s] 61%|██████    | 249/409 [03:49<02:08,  1.24it/s] 61%|██████    | 250/409 [03:50<02:15,  1.17it/s] 61%|██████▏   | 251/409 [03:52<03:04,  1.17s/it] 62%|██████▏   | 252/409 [03:53<02:47,  1.07s/it] 62%|██████▏   | 253/409 [03:54<02:58,  1.15s/it] 62%|██████▏   | 254/409 [03:55<02:44,  1.06s/it] 62%|██████▏   | 255/409 [03:56<02:51,  1.11s/it] 63%|██████▎   | 256/409 [03:57<02:36,  1.03s/it] 63%|██████▎   | 257/409 [03:58<02:33,  1.01s/it] 63%|██████▎   | 258/409 [03:59<02:08,  1.18it/s] 63%|██████▎   | 259/409 [04:00<02:07,  1.18it/s] 64%|██████▎   | 260/409 [04:01<02:28,  1.01it/s] 64%|██████▍   | 261/409 [04:02<02:26,  1.01it/s] 64%|██████▍   | 262/409 [04:02<02:03,  1.19it/s] 64%|██████▍   | 263/409 [04:03<02:08,  1.14it/s] 65%|██████▍   | 264/409 [04:04<01:50,  1.31it/s] 65%|██████▍   | 265/409 [04:05<01:47,  1.34it/s] 65%|██████▌   | 266/409 [04:06<02:06,  1.13it/s] 65%|██████▌   | 267/409 [04:07<02:07,  1.11it/s] 66%|██████▌   | 268/409 [04:07<01:54,  1.23it/s] 66%|██████▌   | 269/409 [04:08<01:55,  1.21it/s] 66%|██████▌   | 270/409 [04:09<02:11,  1.05it/s] 66%|██████▋   | 271/409 [04:10<02:01,  1.14it/s] 67%|██████▋   | 272/409 [04:12<02:28,  1.08s/it] 67%|██████▋   | 273/409 [04:12<02:12,  1.02it/s] 67%|██████▋   | 274/409 [04:14<02:20,  1.04s/it] 67%|██████▋   | 275/409 [04:16<03:00,  1.35s/it] 67%|██████▋   | 276/409 [04:17<02:43,  1.23s/it] 68%|██████▊   | 277/409 [04:17<02:22,  1.08s/it] 68%|██████▊   | 278/409 [04:18<02:23,  1.09s/it] 68%|██████▊   | 279/409 [04:19<02:11,  1.01s/it] 68%|██████▊   | 280/409 [04:20<01:54,  1.12it/s] 69%|██████▊   | 281/409 [04:21<01:52,  1.14it/s] 69%|██████▉   | 282/409 [04:22<01:51,  1.14it/s] 69%|██████▉   | 283/409 [04:23<02:16,  1.08s/it] 69%|██████▉   | 284/409 [04:24<02:22,  1.14s/it] 70%|██████▉   | 285/409 [04:25<01:57,  1.06it/s] 70%|██████▉   | 286/409 [04:25<01:38,  1.24it/s] 70%|███████   | 287/409 [04:26<01:40,  1.21it/s] 70%|███████   | 288/409 [04:27<01:36,  1.25it/s] 71%|███████   | 289/409 [04:28<01:28,  1.35it/s] 71%|███████   | 290/409 [04:28<01:26,  1.37it/s] 71%|███████   | 291/409 [04:29<01:39,  1.19it/s] 71%|███████▏  | 292/409 [04:30<01:35,  1.23it/s] 72%|███████▏  | 293/409 [04:31<01:35,  1.21it/s] 72%|███████▏  | 294/409 [04:32<01:48,  1.06it/s] 72%|███████▏  | 295/409 [04:33<01:44,  1.09it/s] 72%|███████▏  | 296/409 [04:33<01:24,  1.34it/s] 73%|███████▎  | 297/409 [04:34<01:31,  1.23it/s] 73%|███████▎  | 298/409 [04:36<01:44,  1.06it/s] 73%|███████▎  | 299/409 [04:37<01:52,  1.02s/it] 73%|███████▎  | 300/409 [04:38<02:05,  1.15s/it] 74%|███████▎  | 301/409 [04:39<02:02,  1.14s/it] 74%|███████▍  | 302/409 [04:41<02:15,  1.27s/it] 74%|███████▍  | 303/409 [04:43<02:24,  1.36s/it] 74%|███████▍  | 304/409 [04:43<01:55,  1.10s/it] 75%|███████▍  | 305/409 [04:44<01:50,  1.07s/it] 75%|███████▍  | 306/409 [04:45<01:47,  1.04s/it] 75%|███████▌  | 307/409 [04:46<01:54,  1.13s/it] 75%|███████▌  | 308/409 [04:47<01:41,  1.01s/it] 76%|███████▌  | 309/409 [04:48<01:32,  1.08it/s] 76%|███████▌  | 310/409 [04:49<01:36,  1.02it/s] 76%|███████▌  | 311/409 [04:50<01:35,  1.02it/s] 76%|███████▋  | 312/409 [04:51<01:35,  1.02it/s] 77%|███████▋  | 313/409 [04:52<01:27,  1.10it/s] 77%|███████▋  | 314/409 [04:53<01:34,  1.00it/s] 77%|███████▋  | 315/409 [04:54<01:40,  1.06s/it] 77%|███████▋  | 316/409 [04:54<01:19,  1.17it/s] 78%|███████▊  | 317/409 [04:56<01:32,  1.00s/it] 78%|███████▊  | 318/409 [04:57<01:33,  1.03s/it] 78%|███████▊  | 319/409 [04:58<01:31,  1.02s/it] 78%|███████▊  | 320/409 [04:59<01:26,  1.02it/s] 78%|███████▊  | 321/409 [04:59<01:16,  1.15it/s] 79%|███████▊  | 322/409 [05:00<01:15,  1.15it/s] 79%|███████▉  | 323/409 [05:01<01:17,  1.10it/s] 79%|███████▉  | 324/409 [05:02<01:06,  1.29it/s] 79%|███████▉  | 325/409 [05:02<01:00,  1.39it/s] 80%|███████▉  | 326/409 [05:03<00:56,  1.46it/s] 80%|███████▉  | 327/409 [05:03<00:55,  1.49it/s] 80%|████████  | 328/409 [05:04<00:53,  1.53it/s] 80%|████████  | 329/409 [05:05<01:00,  1.32it/s] 81%|████████  | 330/409 [05:06<01:04,  1.23it/s] 81%|████████  | 331/409 [05:07<01:04,  1.22it/s] 81%|████████  | 332/409 [05:08<01:20,  1.04s/it] 81%|████████▏ | 333/409 [05:09<01:17,  1.01s/it] 82%|████████▏ | 334/409 [05:10<01:17,  1.04s/it] 82%|████████▏ | 335/409 [05:12<01:28,  1.20s/it] 82%|████████▏ | 336/409 [05:13<01:27,  1.20s/it] 82%|████████▏ | 337/409 [05:14<01:13,  1.02s/it] 83%|████████▎ | 338/409 [05:14<01:01,  1.16it/s] 83%|████████▎ | 339/409 [05:15<00:54,  1.27it/s] 83%|████████▎ | 340/409 [05:15<00:45,  1.52it/s] 83%|████████▎ | 341/409 [05:16<00:36,  1.88it/s] 84%|████████▎ | 342/409 [05:16<00:39,  1.69it/s] 84%|████████▍ | 343/409 [05:17<00:49,  1.34it/s] 84%|████████▍ | 344/409 [05:18<00:45,  1.43it/s] 84%|████████▍ | 345/409 [05:19<00:57,  1.11it/s] 85%|████████▍ | 346/409 [05:20<00:55,  1.13it/s] 85%|████████▍ | 347/409 [05:21<00:56,  1.10it/s] 85%|████████▌ | 348/409 [05:22<00:54,  1.13it/s] 85%|████████▌ | 349/409 [05:23<00:52,  1.14it/s] 86%|████████▌ | 350/409 [05:24<01:00,  1.02s/it] 86%|████████▌ | 351/409 [05:25<00:54,  1.07it/s] 86%|████████▌ | 352/409 [05:26<00:49,  1.15it/s] 86%|████████▋ | 353/409 [05:26<00:46,  1.20it/s] 87%|████████▋ | 354/409 [05:27<00:48,  1.13it/s] 87%|████████▋ | 355/409 [05:28<00:49,  1.10it/s] 87%|████████▋ | 356/409 [05:29<00:46,  1.13it/s] 87%|████████▋ | 357/409 [05:30<00:45,  1.15it/s] 88%|████████▊ | 358/409 [05:31<00:45,  1.11it/s] 88%|████████▊ | 359/409 [05:32<00:42,  1.18it/s] 88%|████████▊ | 360/409 [05:33<00:45,  1.08it/s] 88%|████████▊ | 361/409 [05:33<00:39,  1.21it/s] 89%|████████▊ | 362/409 [05:34<00:37,  1.26it/s] 89%|████████▉ | 363/409 [05:35<00:42,  1.09it/s] 89%|████████▉ | 364/409 [05:36<00:39,  1.15it/s] 89%|████████▉ | 365/409 [05:37<00:44,  1.00s/it] 89%|████████▉ | 366/409 [05:38<00:38,  1.13it/s] 90%|████████▉ | 367/409 [05:39<00:36,  1.14it/s] 90%|████████▉ | 368/409 [05:40<00:34,  1.20it/s] 90%|█████████ | 369/409 [05:41<00:35,  1.13it/s] 90%|█████████ | 370/409 [05:42<00:35,  1.10it/s] 91%|█████████ | 371/409 [05:43<00:37,  1.02it/s] 91%|█████████ | 372/409 [05:43<00:33,  1.11it/s] 91%|█████████ | 373/409 [05:44<00:31,  1.13it/s] 91%|█████████▏| 374/409 [05:45<00:30,  1.15it/s] 92%|█████████▏| 375/409 [05:46<00:30,  1.11it/s] 92%|█████████▏| 376/409 [05:47<00:32,  1.00it/s] 92%|█████████▏| 377/409 [05:48<00:30,  1.05it/s] 92%|█████████▏| 378/409 [05:49<00:28,  1.09it/s] 93%|█████████▎| 379/409 [05:50<00:28,  1.04it/s] 93%|█████████▎| 380/409 [05:51<00:26,  1.08it/s] 93%|█████████▎| 381/409 [05:52<00:25,  1.11it/s] 93%|█████████▎| 382/409 [05:53<00:28,  1.04s/it] 94%|█████████▎| 383/409 [05:54<00:23,  1.10it/s] 94%|█████████▍| 384/409 [05:55<00:26,  1.04s/it] 94%|█████████▍| 385/409 [05:55<00:20,  1.20it/s] 94%|█████████▍| 386/409 [05:56<00:15,  1.52it/s] 95%|█████████▍| 387/409 [05:56<00:12,  1.76it/s] 95%|█████████▍| 388/409 [05:57<00:12,  1.63it/s] 95%|█████████▌| 389/409 [05:57<00:12,  1.63it/s] 95%|█████████▌| 390/409 [05:58<00:12,  1.47it/s] 96%|█████████▌| 391/409 [05:59<00:11,  1.53it/s] 96%|█████████▌| 392/409 [05:59<00:10,  1.56it/s] 96%|█████████▌| 393/409 [06:01<00:12,  1.24it/s] 96%|█████████▋| 394/409 [06:02<00:12,  1.17it/s] 97%|█████████▋| 395/409 [06:03<00:13,  1.05it/s] 97%|█████████▋| 396/409 [06:04<00:11,  1.12it/s] 97%|█████████▋| 397/409 [06:05<00:12,  1.01s/it] 97%|█████████▋| 398/409 [06:06<00:10,  1.07it/s] 98%|█████████▊| 399/409 [06:06<00:09,  1.10it/s] 98%|█████████▊| 400/409 [06:07<00:07,  1.23it/s] 98%|█████████▊| 401/409 [06:08<00:07,  1.08it/s] 98%|█████████▊| 402/409 [06:09<00:06,  1.11it/s] 99%|█████████▊| 403/409 [06:10<00:05,  1.03it/s] 99%|█████████▉| 404/409 [06:11<00:05,  1.05s/it] 99%|█████████▉| 405/409 [06:13<00:04,  1.06s/it] 99%|█████████▉| 406/409 [06:13<00:03,  1.04s/it]100%|█████████▉| 407/409 [06:14<00:01,  1.05it/s]100%|█████████▉| 408/409 [06:15<00:00,  1.00it/s]100%|██████████| 409/409 [06:16<00:00,  1.18it/s]100%|██████████| 409/409 [06:16<00:00,  1.09it/s]
/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/metrics.py:274: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  bleurt = load_metric("bleurt", cache_dir=cache_dir)
2023-11-01 14:08:48.302575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 24013 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 3g.40gb, pci bus id: 0000:17:00.0, compute capability: 8.0
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 272.22it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (3771 > 2048). Running this sequence through the model will result in indexing errors
Map:  13%|█▎        | 13/100 [00:00<00:00, 120.39 examples/s]Map:  36%|███▌      | 36/100 [00:00<00:00, 174.44 examples/s]Map:  62%|██████▏   | 62/100 [00:00<00:00, 169.99 examples/s]Map:  83%|████████▎ | 83/100 [00:00<00:00, 147.26 examples/s]Map:  99%|█████████▉| 99/100 [00:00<00:00, 148.77 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:07, 13.42it/s]  4%|▍         | 4/100 [00:00<00:06, 15.08it/s]  6%|▌         | 6/100 [00:00<00:05, 15.69it/s]  8%|▊         | 8/100 [00:00<00:05, 16.01it/s] 10%|█         | 10/100 [00:00<00:05, 16.18it/s] 12%|█▏        | 12/100 [00:00<00:05, 16.29it/s] 14%|█▍        | 14/100 [00:00<00:05, 16.36it/s] 16%|█▌        | 16/100 [00:00<00:05, 16.40it/s] 18%|█▊        | 18/100 [00:01<00:04, 16.43it/s] 20%|██        | 20/100 [00:01<00:04, 16.45it/s] 22%|██▏       | 22/100 [00:01<00:04, 16.46it/s] 24%|██▍       | 24/100 [00:01<00:04, 16.47it/s] 26%|██▌       | 26/100 [00:01<00:04, 16.48it/s] 28%|██▊       | 28/100 [00:01<00:04, 16.48it/s] 30%|███       | 30/100 [00:01<00:04, 16.48it/s] 32%|███▏      | 32/100 [00:01<00:04, 16.48it/s] 34%|███▍      | 34/100 [00:02<00:04, 16.49it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.49it/s] 38%|███▊      | 38/100 [00:02<00:03, 16.49it/s] 40%|████      | 40/100 [00:02<00:03, 16.50it/s] 42%|████▏     | 42/100 [00:02<00:03, 16.50it/s] 44%|████▍     | 44/100 [00:02<00:03, 16.39it/s] 46%|████▌     | 46/100 [00:02<00:03, 16.42it/s] 48%|████▊     | 48/100 [00:02<00:03, 16.44it/s] 50%|█████     | 50/100 [00:03<00:03, 16.46it/s] 52%|█████▏    | 52/100 [00:03<00:02, 16.47it/s] 54%|█████▍    | 54/100 [00:03<00:02, 16.49it/s] 56%|█████▌    | 56/100 [00:03<00:02, 16.49it/s] 58%|█████▊    | 58/100 [00:03<00:02, 16.49it/s] 60%|██████    | 60/100 [00:03<00:02, 16.49it/s] 62%|██████▏   | 62/100 [00:03<00:02, 16.47it/s] 64%|██████▍   | 64/100 [00:03<00:02, 16.45it/s] 66%|██████▌   | 66/100 [00:04<00:02, 16.44it/s] 68%|██████▊   | 68/100 [00:04<00:01, 16.45it/s] 70%|███████   | 70/100 [00:04<00:01, 16.47it/s] 72%|███████▏  | 72/100 [00:04<00:01, 16.48it/s] 74%|███████▍  | 74/100 [00:04<00:01, 16.50it/s] 76%|███████▌  | 76/100 [00:04<00:01, 16.51it/s] 78%|███████▊  | 78/100 [00:04<00:01, 16.53it/s] 80%|████████  | 80/100 [00:04<00:01, 16.44it/s] 82%|████████▏ | 82/100 [00:05<00:01, 16.45it/s] 84%|████████▍ | 84/100 [00:05<00:00, 16.49it/s] 86%|████████▌ | 86/100 [00:05<00:00, 16.51it/s] 88%|████████▊ | 88/100 [00:05<00:00, 16.52it/s] 90%|█████████ | 90/100 [00:05<00:00, 16.52it/s] 92%|█████████▏| 92/100 [00:05<00:00, 16.52it/s] 94%|█████████▍| 94/100 [00:05<00:00, 16.51it/s] 96%|█████████▌| 96/100 [00:05<00:00, 16.51it/s] 98%|█████████▊| 98/100 [00:05<00:00, 16.50it/s]100%|██████████| 100/100 [00:06<00:00, 16.51it/s]100%|██████████| 100/100 [00:06<00:00, 16.41it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 363.46it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  17%|█▋        | 17/100 [00:00<00:00, 158.84 examples/s]Map:  43%|████▎     | 43/100 [00:00<00:00, 210.95 examples/s]Map:  65%|██████▌   | 65/100 [00:00<00:00, 208.40 examples/s]Map:  91%|█████████ | 91/100 [00:00<00:00, 150.21 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.48it/s]  2%|▏         | 2/100 [00:00<00:13,  7.46it/s]  3%|▎         | 3/100 [00:00<00:12,  7.80it/s]  4%|▍         | 4/100 [00:00<00:12,  7.92it/s]  5%|▌         | 5/100 [00:00<00:12,  7.78it/s]  6%|▌         | 6/100 [00:00<00:11,  7.85it/s]  7%|▋         | 7/100 [00:00<00:12,  7.56it/s]  8%|▊         | 8/100 [00:01<00:11,  7.70it/s]  9%|▉         | 9/100 [00:01<00:11,  7.78it/s] 10%|█         | 10/100 [00:01<00:11,  7.61it/s] 11%|█         | 11/100 [00:01<00:11,  7.66it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.70it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.78it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.55it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.60it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.71it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.77it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.81it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.62it/s] 20%|██        | 20/100 [00:02<00:10,  7.56it/s] 21%|██        | 21/100 [00:02<00:10,  7.68it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.66it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.51it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.61it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.51it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.62it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.55it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.68it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.71it/s] 30%|███       | 30/100 [00:03<00:09,  7.51it/s] 31%|███       | 31/100 [00:04<00:09,  7.57it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.69it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.75it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.65it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.71it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.71it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.76it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.66it/s] 39%|███▉      | 39/100 [00:05<00:07,  7.75it/s] 40%|████      | 40/100 [00:05<00:07,  7.78it/s] 41%|████      | 41/100 [00:05<00:07,  7.82it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.66it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.72it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.79it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.58it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.72it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.59it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.71it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.55it/s] 50%|█████     | 50/100 [00:06<00:06,  7.69it/s] 51%|█████     | 51/100 [00:06<00:06,  7.66it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.47it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.60it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.61it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.54it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.66it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.51it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.45it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.55it/s] 60%|██████    | 60/100 [00:07<00:05,  7.68it/s] 61%|██████    | 61/100 [00:07<00:05,  7.76it/s] 62%|██████▏   | 62/100 [00:08<00:04,  7.80it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.71it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.76it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.68it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.75it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.69it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.76it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.67it/s] 70%|███████   | 70/100 [00:09<00:03,  7.65it/s] 71%|███████   | 71/100 [00:09<00:03,  7.71it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.53it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.55it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.64it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.73it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.70it/s] 77%|███████▋  | 77/100 [00:10<00:02,  7.67it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.75it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.80it/s] 80%|████████  | 80/100 [00:10<00:02,  7.78it/s] 81%|████████  | 81/100 [00:10<00:02,  7.82it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.72it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.66it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.71it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.66it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.64it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.55it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.65it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.60it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.70it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.49it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.64it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.59it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.62it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.72it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.72it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.77it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.64it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.74it/s]100%|██████████| 100/100 [00:13<00:00,  7.79it/s]100%|██████████| 100/100 [00:13<00:00,  7.67it/s]
FOLD 0
Metric         MC1       MC2   CE Loss  KL wrt Orig
Model                                              
llama_7B  0.246944  0.500171  5.919766     3.813912
Running fold 1
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.12it/s]  6%|▋         | 2/32 [00:00<00:13,  2.15it/s]  9%|▉         | 3/32 [00:01<00:13,  2.08it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.05it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.99it/s] 19%|█▉        | 6/32 [00:02<00:13,  1.94it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.88it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.85it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.75it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.68it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.64it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.60it/s] 41%|████      | 13/32 [00:07<00:11,  1.60it/s] 44%|████▍     | 14/32 [00:07<00:11,  1.58it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.55it/s] 53%|█████▎    | 17/32 [00:09<00:09,  1.55it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.53it/s] 59%|█████▉    | 19/32 [00:11<00:08,  1.46it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.45it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.46it/s] 69%|██████▉   | 22/32 [00:13<00:06,  1.43it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.44it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.42it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.47it/s] 84%|████████▍ | 27/32 [00:16<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.53it/s] 91%|█████████ | 29/32 [00:18<00:01,  1.52it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.55it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.56it/s]100%|██████████| 32/32 [00:20<00:00,  1.43it/s]100%|██████████| 32/32 [00:20<00:00,  1.58it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.56597222 0.58854167 0.56597222 ... 0.56597222 0.56597222 0.56597222]
 [0.56597222 0.56597222 0.56597222 ... 0.60243056 0.56597222 0.56597222]
 [0.56597222 0.59201389 0.64583333 ... 0.59548611 0.56597222 0.60243056]
 ...
 [0.63715278 0.56597222 0.58680556 ... 0.64236111 0.56597222 0.5625    ]
 [0.68055556 0.56770833 0.58854167 ... 0.59201389 0.62326389 0.56597222]
 [0.56076389 0.63020833 0.63194444 ... 0.61979167 0.63541667 0.62152778]]
Heads intervened:  [(8, 3), (9, 5), (9, 20), (9, 29), (10, 1), (10, 2), (10, 9), (10, 12), (10, 17), (10, 22), (10, 27), (10, 29), (11, 0), (11, 3), (11, 6), (11, 8), (11, 21), (11, 31), (12, 3), (12, 9), (12, 12), (12, 14), (12, 25), (13, 1), (13, 6), (13, 16), (13, 17), (13, 22), (14, 4), (14, 12), (14, 14), (14, 18), (14, 22), (15, 8), (15, 20), (15, 28), (16, 1), (16, 7), (16, 13), (16, 25), (16, 26), (18, 0), (18, 27), (20, 19), (20, 21), (22, 11), (24, 20), (26, 14)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
  0%|          | 0/408 [00:00<?, ?it/s]  0%|          | 1/408 [00:01<11:12,  1.65s/it]/home/elicer/honest_llama/validation/../TruthfulQA/truthfulqa/models.py:574: RuntimeWarning: invalid value encountered in divide
  probs_true = probs_true / (sum(probs_true) + sum(probs_false))
  0%|          | 2/408 [00:02<09:31,  1.41s/it]  1%|          | 3/408 [00:03<08:31,  1.26s/it]  1%|          | 4/408 [00:05<09:54,  1.47s/it]  1%|          | 5/408 [00:06<07:43,  1.15s/it]  1%|▏         | 6/408 [00:07<06:57,  1.04s/it]  2%|▏         | 7/408 [00:07<05:11,  1.29it/s]  2%|▏         | 8/408 [00:08<05:38,  1.18it/s]  2%|▏         | 9/408 [00:08<04:52,  1.37it/s]  2%|▏         | 10/408 [00:09<04:34,  1.45it/s]  3%|▎         | 11/408 [00:10<05:47,  1.14it/s]  3%|▎         | 12/408 [00:11<05:48,  1.14it/s]  3%|▎         | 13/408 [00:12<05:30,  1.19it/s]  3%|▎         | 14/408 [00:13<05:44,  1.14it/s]  4%|▎         | 15/408 [00:14<05:25,  1.21it/s]  4%|▍         | 16/408 [00:14<05:10,  1.26it/s]  4%|▍         | 17/408 [00:15<04:48,  1.36it/s]  4%|▍         | 18/408 [00:16<05:14,  1.24it/s]  5%|▍         | 19/408 [00:16<04:36,  1.41it/s]  5%|▍         | 20/408 [00:17<04:09,  1.55it/s]  5%|▌         | 21/408 [00:18<05:23,  1.20it/s]  5%|▌         | 22/408 [00:19<05:23,  1.19it/s]  6%|▌         | 23/408 [00:21<07:23,  1.15s/it]  6%|▌         | 24/408 [00:22<06:58,  1.09s/it]  6%|▌         | 25/408 [00:23<07:09,  1.12s/it]  6%|▋         | 26/408 [00:24<07:03,  1.11s/it]  7%|▋         | 27/408 [00:25<06:32,  1.03s/it]  7%|▋         | 28/408 [00:26<05:42,  1.11it/s]  7%|▋         | 29/408 [00:27<06:58,  1.10s/it]  7%|▋         | 30/408 [00:28<06:18,  1.00s/it]  8%|▊         | 31/408 [00:29<07:11,  1.14s/it]  8%|▊         | 32/408 [00:30<06:51,  1.09s/it]  8%|▊         | 33/408 [00:31<06:20,  1.02s/it]  8%|▊         | 34/408 [00:32<06:39,  1.07s/it]  9%|▊         | 35/408 [00:33<06:13,  1.00s/it]  9%|▉         | 36/408 [00:33<04:48,  1.29it/s]  9%|▉         | 37/408 [00:34<04:40,  1.32it/s]  9%|▉         | 38/408 [00:35<04:22,  1.41it/s] 10%|▉         | 39/408 [00:35<04:11,  1.47it/s] 10%|▉         | 40/408 [00:37<05:05,  1.20it/s] 10%|█         | 41/408 [00:37<05:06,  1.20it/s] 10%|█         | 42/408 [00:38<05:08,  1.18it/s] 11%|█         | 43/408 [00:39<05:36,  1.08it/s] 11%|█         | 44/408 [00:40<05:51,  1.04it/s] 11%|█         | 45/408 [00:41<06:01,  1.01it/s] 11%|█▏        | 46/408 [00:43<06:46,  1.12s/it] 12%|█▏        | 47/408 [00:44<06:27,  1.07s/it] 12%|█▏        | 48/408 [00:45<06:25,  1.07s/it] 12%|█▏        | 49/408 [00:46<06:24,  1.07s/it] 12%|█▏        | 50/408 [00:47<06:22,  1.07s/it] 12%|█▎        | 51/408 [00:48<06:22,  1.07s/it] 13%|█▎        | 52/408 [00:49<05:58,  1.01s/it] 13%|█▎        | 53/408 [00:50<05:28,  1.08it/s] 13%|█▎        | 54/408 [00:51<05:57,  1.01s/it] 13%|█▎        | 55/408 [00:52<05:15,  1.12it/s] 14%|█▎        | 56/408 [00:52<05:13,  1.12it/s] 14%|█▍        | 57/408 [00:53<04:16,  1.37it/s] 14%|█▍        | 58/408 [00:54<05:49,  1.00it/s] 14%|█▍        | 59/408 [00:56<06:28,  1.11s/it] 15%|█▍        | 60/408 [00:57<06:45,  1.16s/it] 15%|█▍        | 61/408 [00:58<05:49,  1.01s/it] 15%|█▌        | 62/408 [00:59<05:30,  1.05it/s] 15%|█▌        | 63/408 [00:59<05:04,  1.13it/s] 16%|█▌        | 64/408 [01:00<04:48,  1.19it/s] 16%|█▌        | 65/408 [01:01<05:23,  1.06it/s] 16%|█▌        | 66/408 [01:02<04:37,  1.23it/s] 16%|█▋        | 67/408 [01:02<04:14,  1.34it/s] 17%|█▋        | 68/408 [01:03<04:14,  1.34it/s] 17%|█▋        | 69/408 [01:04<03:48,  1.49it/s] 17%|█▋        | 70/408 [01:05<04:16,  1.32it/s] 17%|█▋        | 71/408 [01:05<03:34,  1.57it/s] 18%|█▊        | 72/408 [01:07<05:31,  1.01it/s] 18%|█▊        | 73/408 [01:08<06:25,  1.15s/it] 18%|█▊        | 74/408 [01:09<05:19,  1.05it/s] 18%|█▊        | 75/408 [01:10<05:43,  1.03s/it] 19%|█▊        | 76/408 [01:11<05:11,  1.06it/s] 19%|█▉        | 77/408 [01:11<05:01,  1.10it/s] 19%|█▉        | 78/408 [01:12<05:04,  1.08it/s] 19%|█▉        | 79/408 [01:13<05:08,  1.07it/s] 20%|█▉        | 80/408 [01:15<05:30,  1.01s/it] 20%|█▉        | 81/408 [01:15<05:13,  1.04it/s] 20%|██        | 82/408 [01:16<04:50,  1.12it/s] 20%|██        | 83/408 [01:17<04:19,  1.25it/s] 21%|██        | 84/408 [01:18<04:58,  1.08it/s] 21%|██        | 85/408 [01:19<05:04,  1.06it/s] 21%|██        | 86/408 [01:20<05:57,  1.11s/it] 21%|██▏       | 87/408 [01:21<05:29,  1.02s/it] 22%|██▏       | 88/408 [01:23<05:49,  1.09s/it] 22%|██▏       | 89/408 [01:23<05:36,  1.05s/it] 22%|██▏       | 90/408 [01:24<04:40,  1.13it/s] 22%|██▏       | 91/408 [01:25<05:08,  1.03it/s] 23%|██▎       | 92/408 [01:26<04:55,  1.07it/s] 23%|██▎       | 93/408 [01:27<05:44,  1.09s/it] 23%|██▎       | 94/408 [01:29<05:40,  1.08s/it] 23%|██▎       | 95/408 [01:29<04:54,  1.06it/s] 24%|██▎       | 96/408 [01:30<04:33,  1.14it/s] 24%|██▍       | 97/408 [01:31<04:30,  1.15it/s] 24%|██▍       | 98/408 [01:32<04:50,  1.07it/s] 24%|██▍       | 99/408 [01:33<05:34,  1.08s/it] 25%|██▍       | 100/408 [01:34<05:11,  1.01s/it] 25%|██▍       | 101/408 [01:34<04:00,  1.28it/s] 25%|██▌       | 102/408 [01:35<03:52,  1.31it/s] 25%|██▌       | 103/408 [01:36<03:58,  1.28it/s] 25%|██▌       | 104/408 [01:37<04:02,  1.25it/s] 26%|██▌       | 105/408 [01:38<04:18,  1.17it/s] 26%|██▌       | 106/408 [01:39<05:05,  1.01s/it] 26%|██▌       | 107/408 [01:40<04:16,  1.17it/s] 26%|██▋       | 108/408 [01:41<04:33,  1.10it/s] 27%|██▋       | 109/408 [01:41<04:15,  1.17it/s] 27%|██▋       | 110/408 [01:42<03:51,  1.29it/s] 27%|██▋       | 111/408 [01:43<04:16,  1.16it/s] 27%|██▋       | 112/408 [01:44<03:53,  1.27it/s] 28%|██▊       | 113/408 [01:44<03:46,  1.30it/s] 28%|██▊       | 114/408 [01:46<04:31,  1.08it/s] 28%|██▊       | 115/408 [01:47<05:16,  1.08s/it] 28%|██▊       | 116/408 [01:48<05:23,  1.11s/it] 29%|██▊       | 117/408 [01:49<05:08,  1.06s/it] 29%|██▉       | 118/408 [01:50<05:05,  1.05s/it] 29%|██▉       | 119/408 [01:51<05:08,  1.07s/it] 29%|██▉       | 120/408 [01:52<04:48,  1.00s/it] 30%|██▉       | 121/408 [01:53<04:03,  1.18it/s] 30%|██▉       | 122/408 [01:53<03:40,  1.30it/s] 30%|███       | 123/408 [01:54<04:15,  1.11it/s] 30%|███       | 124/408 [01:55<04:03,  1.17it/s] 31%|███       | 125/408 [01:56<03:52,  1.22it/s] 31%|███       | 126/408 [01:57<03:44,  1.26it/s] 31%|███       | 127/408 [01:58<04:24,  1.06it/s] 31%|███▏      | 128/408 [01:58<03:24,  1.37it/s] 32%|███▏      | 129/408 [01:59<04:04,  1.14it/s] 32%|███▏      | 130/408 [02:01<04:50,  1.05s/it] 32%|███▏      | 131/408 [02:02<04:33,  1.01it/s] 32%|███▏      | 132/408 [02:03<04:18,  1.07it/s] 33%|███▎      | 133/408 [02:03<04:22,  1.05it/s] 33%|███▎      | 134/408 [02:05<05:34,  1.22s/it] 33%|███▎      | 135/408 [02:07<06:10,  1.36s/it] 33%|███▎      | 136/408 [02:08<05:47,  1.28s/it] 34%|███▎      | 137/408 [02:09<04:42,  1.04s/it] 34%|███▍      | 138/408 [02:10<04:35,  1.02s/it] 34%|███▍      | 139/408 [02:10<04:21,  1.03it/s] 34%|███▍      | 140/408 [02:12<05:07,  1.15s/it] 35%|███▍      | 141/408 [02:13<04:43,  1.06s/it] 35%|███▍      | 142/408 [02:14<05:01,  1.13s/it] 35%|███▌      | 143/408 [02:15<04:46,  1.08s/it] 35%|███▌      | 144/408 [02:16<04:26,  1.01s/it] 36%|███▌      | 145/408 [02:17<04:22,  1.00it/s] 36%|███▌      | 146/408 [02:18<04:09,  1.05it/s] 36%|███▌      | 147/408 [02:19<04:09,  1.05it/s] 36%|███▋      | 148/408 [02:19<03:50,  1.13it/s] 37%|███▋      | 149/408 [02:21<04:07,  1.05it/s] 37%|███▋      | 150/408 [02:22<04:05,  1.05it/s] 37%|███▋      | 151/408 [02:22<03:29,  1.23it/s] 37%|███▋      | 152/408 [02:23<03:47,  1.13it/s] 38%|███▊      | 153/408 [02:24<03:53,  1.09it/s] 38%|███▊      | 154/408 [02:25<03:44,  1.13it/s] 38%|███▊      | 155/408 [02:27<05:27,  1.29s/it] 38%|███▊      | 156/408 [02:28<05:02,  1.20s/it] 38%|███▊      | 157/408 [02:30<05:29,  1.31s/it] 39%|███▊      | 158/408 [02:31<05:14,  1.26s/it] 39%|███▉      | 159/408 [02:32<04:49,  1.16s/it] 39%|███▉      | 160/408 [02:32<04:05,  1.01it/s] 39%|███▉      | 161/408 [02:33<03:37,  1.14it/s] 40%|███▉      | 162/408 [02:34<03:36,  1.14it/s] 40%|███▉      | 163/408 [02:35<03:32,  1.15it/s] 40%|████      | 164/408 [02:35<03:20,  1.21it/s] 40%|████      | 165/408 [02:36<03:30,  1.15it/s] 41%|████      | 166/408 [02:37<03:29,  1.16it/s] 41%|████      | 167/408 [02:38<03:00,  1.33it/s] 41%|████      | 168/408 [02:38<02:49,  1.41it/s] 41%|████▏     | 169/408 [02:39<02:58,  1.34it/s] 42%|████▏     | 170/408 [02:40<03:13,  1.23it/s] 42%|████▏     | 171/408 [02:41<03:05,  1.28it/s] 42%|████▏     | 172/408 [02:41<02:53,  1.36it/s] 42%|████▏     | 173/408 [02:43<03:33,  1.10it/s] 43%|████▎     | 174/408 [02:44<04:04,  1.04s/it] 43%|████▎     | 175/408 [02:45<03:56,  1.02s/it] 43%|████▎     | 176/408 [02:46<03:36,  1.07it/s] 43%|████▎     | 177/408 [02:46<03:05,  1.24it/s] 44%|████▎     | 178/408 [02:48<03:39,  1.05it/s] 44%|████▍     | 179/408 [02:48<03:22,  1.13it/s] 44%|████▍     | 180/408 [02:49<03:10,  1.19it/s] 44%|████▍     | 181/408 [02:50<02:55,  1.29it/s] 45%|████▍     | 182/408 [02:51<03:01,  1.25it/s] 45%|████▍     | 183/408 [02:52<03:39,  1.03it/s] 45%|████▌     | 184/408 [02:53<03:11,  1.17it/s] 45%|████▌     | 185/408 [02:53<03:00,  1.23it/s] 46%|████▌     | 186/408 [02:54<03:09,  1.17it/s] 46%|████▌     | 187/408 [02:56<04:01,  1.09s/it] 46%|████▌     | 188/408 [02:57<03:36,  1.02it/s] 46%|████▋     | 189/408 [02:58<03:33,  1.02it/s] 47%|████▋     | 190/408 [02:58<03:30,  1.04it/s] 47%|████▋     | 191/408 [02:59<03:22,  1.07it/s] 47%|████▋     | 192/408 [03:00<03:34,  1.00it/s] 47%|████▋     | 193/408 [03:01<03:30,  1.02it/s] 48%|████▊     | 194/408 [03:02<03:14,  1.10it/s] 48%|████▊     | 195/408 [03:03<03:09,  1.12it/s] 48%|████▊     | 196/408 [03:03<02:43,  1.29it/s] 48%|████▊     | 197/408 [03:04<02:40,  1.32it/s] 49%|████▊     | 198/408 [03:05<02:28,  1.41it/s] 49%|████▉     | 199/408 [03:05<02:06,  1.66it/s] 49%|████▉     | 200/408 [03:06<02:35,  1.34it/s] 49%|████▉     | 201/408 [03:07<02:48,  1.23it/s] 50%|████▉     | 202/408 [03:08<02:40,  1.28it/s] 50%|████▉     | 203/408 [03:09<02:28,  1.38it/s] 50%|█████     | 204/408 [03:10<02:57,  1.15it/s] 50%|█████     | 205/408 [03:10<02:40,  1.26it/s] 50%|█████     | 206/408 [03:11<02:35,  1.30it/s] 51%|█████     | 207/408 [03:12<02:38,  1.27it/s] 51%|█████     | 208/408 [03:13<03:05,  1.08it/s] 51%|█████     | 209/408 [03:14<03:08,  1.05it/s] 51%|█████▏    | 210/408 [03:15<02:53,  1.14it/s] 52%|█████▏    | 211/408 [03:15<02:37,  1.25it/s] 52%|█████▏    | 212/408 [03:17<03:05,  1.06it/s] 52%|█████▏    | 213/408 [03:18<03:45,  1.16s/it] 52%|█████▏    | 214/408 [03:20<03:59,  1.23s/it] 53%|█████▎    | 215/408 [03:21<03:28,  1.08s/it] 53%|█████▎    | 216/408 [03:21<03:12,  1.00s/it] 53%|█████▎    | 217/408 [03:23<03:22,  1.06s/it] 53%|█████▎    | 218/408 [03:23<03:07,  1.01it/s] 54%|█████▎    | 219/408 [03:25<03:38,  1.16s/it] 54%|█████▍    | 220/408 [03:26<03:33,  1.14s/it] 54%|█████▍    | 221/408 [03:27<03:38,  1.17s/it] 54%|█████▍    | 222/408 [03:28<02:51,  1.08it/s] 55%|█████▍    | 223/408 [03:29<03:24,  1.10s/it] 55%|█████▍    | 224/408 [03:30<03:35,  1.17s/it] 55%|█████▌    | 225/408 [03:31<03:23,  1.11s/it] 55%|█████▌    | 226/408 [03:32<03:01,  1.00it/s] 56%|█████▌    | 227/408 [03:33<03:12,  1.06s/it] 56%|█████▌    | 228/408 [03:34<02:45,  1.08it/s] 56%|█████▌    | 229/408 [03:35<02:35,  1.15it/s] 56%|█████▋    | 230/408 [03:35<02:20,  1.27it/s] 57%|█████▋    | 231/408 [03:36<01:56,  1.52it/s] 57%|█████▋    | 232/408 [03:36<01:59,  1.47it/s] 57%|█████▋    | 233/408 [03:37<02:02,  1.43it/s] 57%|█████▋    | 234/408 [03:38<02:09,  1.34it/s] 58%|█████▊    | 235/408 [03:38<01:56,  1.48it/s] 58%|█████▊    | 236/408 [03:39<01:53,  1.52it/s] 58%|█████▊    | 237/408 [03:40<01:55,  1.48it/s] 58%|█████▊    | 238/408 [03:41<02:34,  1.10it/s] 59%|█████▊    | 239/408 [03:43<02:51,  1.01s/it] 59%|█████▉    | 240/408 [03:44<02:50,  1.01s/it] 59%|█████▉    | 241/408 [03:44<02:16,  1.22it/s] 59%|█████▉    | 242/408 [03:45<02:10,  1.27it/s] 60%|█████▉    | 243/408 [03:46<02:19,  1.18it/s] 60%|█████▉    | 244/408 [03:47<02:30,  1.09it/s] 60%|██████    | 245/408 [03:48<02:26,  1.11it/s] 60%|██████    | 246/408 [03:48<02:16,  1.19it/s] 61%|██████    | 247/408 [03:49<02:10,  1.23it/s] 61%|██████    | 248/408 [03:50<01:54,  1.40it/s] 61%|██████    | 249/408 [03:50<01:53,  1.40it/s] 61%|██████▏   | 250/408 [03:51<01:58,  1.34it/s] 62%|██████▏   | 251/408 [03:52<01:55,  1.35it/s] 62%|██████▏   | 252/408 [03:53<02:15,  1.15it/s] 62%|██████▏   | 253/408 [03:54<02:09,  1.20it/s] 62%|██████▏   | 254/408 [03:55<02:21,  1.09it/s] 62%|██████▎   | 255/408 [03:56<02:11,  1.17it/s] 63%|██████▎   | 256/408 [03:56<02:09,  1.17it/s] 63%|██████▎   | 257/408 [03:57<02:08,  1.17it/s] 63%|██████▎   | 258/408 [03:58<02:02,  1.23it/s] 63%|██████▎   | 259/408 [03:59<02:14,  1.11it/s] 64%|██████▎   | 260/408 [04:00<02:06,  1.17it/s] 64%|██████▍   | 261/408 [04:01<02:27,  1.00s/it] 64%|██████▍   | 262/408 [04:04<03:48,  1.57s/it] 64%|██████▍   | 263/408 [04:04<02:54,  1.20s/it] 65%|██████▍   | 264/408 [04:05<02:41,  1.12s/it] 65%|██████▍   | 265/408 [04:06<02:29,  1.05s/it] 65%|██████▌   | 266/408 [04:07<02:24,  1.02s/it] 65%|██████▌   | 267/408 [04:08<02:28,  1.05s/it] 66%|██████▌   | 268/408 [04:09<02:18,  1.01it/s] 66%|██████▌   | 269/408 [04:10<02:01,  1.15it/s] 66%|██████▌   | 270/408 [04:10<01:53,  1.21it/s] 66%|██████▋   | 271/408 [04:11<01:44,  1.31it/s] 67%|██████▋   | 272/408 [04:12<01:42,  1.33it/s] 67%|██████▋   | 273/408 [04:13<02:04,  1.08it/s] 67%|██████▋   | 274/408 [04:14<01:55,  1.16it/s] 67%|██████▋   | 275/408 [04:15<01:48,  1.22it/s] 68%|██████▊   | 276/408 [04:16<01:59,  1.10it/s] 68%|██████▊   | 277/408 [04:16<01:56,  1.13it/s] 68%|██████▊   | 278/408 [04:18<02:13,  1.03s/it] 68%|██████▊   | 279/408 [04:18<01:56,  1.11it/s] 69%|██████▊   | 280/408 [04:19<01:49,  1.17it/s] 69%|██████▉   | 281/408 [04:20<01:45,  1.21it/s] 69%|██████▉   | 282/408 [04:20<01:32,  1.37it/s] 69%|██████▉   | 283/408 [04:21<01:30,  1.38it/s] 70%|██████▉   | 284/408 [04:22<01:34,  1.32it/s] 70%|██████▉   | 285/408 [04:23<01:36,  1.27it/s] 70%|███████   | 286/408 [04:24<01:47,  1.13it/s] 70%|███████   | 287/408 [04:25<01:40,  1.20it/s] 71%|███████   | 288/408 [04:25<01:34,  1.27it/s] 71%|███████   | 289/408 [04:26<01:36,  1.24it/s] 71%|███████   | 290/408 [04:27<01:28,  1.34it/s] 71%|███████▏  | 291/408 [04:28<01:46,  1.10it/s] 72%|███████▏  | 292/408 [04:30<02:08,  1.10s/it] 72%|███████▏  | 293/408 [04:32<02:43,  1.42s/it] 72%|███████▏  | 294/408 [04:33<02:22,  1.25s/it] 72%|███████▏  | 295/408 [04:34<02:11,  1.16s/it] 73%|███████▎  | 296/408 [04:34<01:54,  1.03s/it] 73%|███████▎  | 297/408 [04:36<01:59,  1.08s/it] 73%|███████▎  | 298/408 [04:36<01:47,  1.03it/s] 73%|███████▎  | 299/408 [04:37<01:37,  1.12it/s] 74%|███████▎  | 300/408 [04:37<01:23,  1.30it/s] 74%|███████▍  | 301/408 [04:38<01:20,  1.33it/s] 74%|███████▍  | 302/408 [04:39<01:34,  1.12it/s] 74%|███████▍  | 303/408 [04:40<01:32,  1.13it/s] 75%|███████▍  | 304/408 [04:41<01:33,  1.11it/s] 75%|███████▍  | 305/408 [04:42<01:27,  1.17it/s] 75%|███████▌  | 306/408 [04:43<01:26,  1.18it/s] 75%|███████▌  | 307/408 [04:44<01:37,  1.04it/s] 75%|███████▌  | 308/408 [04:45<01:32,  1.08it/s] 76%|███████▌  | 309/408 [04:46<01:33,  1.06it/s] 76%|███████▌  | 310/408 [04:46<01:21,  1.20it/s] 76%|███████▌  | 311/408 [04:48<01:34,  1.02it/s] 76%|███████▋  | 312/408 [04:48<01:16,  1.26it/s] 77%|███████▋  | 313/408 [04:49<01:29,  1.07it/s] 77%|███████▋  | 314/408 [04:51<01:39,  1.06s/it] 77%|███████▋  | 315/408 [04:52<01:33,  1.01s/it] 77%|███████▋  | 316/408 [04:53<01:32,  1.01s/it] 78%|███████▊  | 317/408 [04:53<01:21,  1.12it/s] 78%|███████▊  | 318/408 [04:54<01:29,  1.01it/s] 78%|███████▊  | 319/408 [04:55<01:18,  1.14it/s] 78%|███████▊  | 320/408 [04:57<01:35,  1.08s/it] 79%|███████▊  | 321/408 [04:57<01:18,  1.11it/s] 79%|███████▉  | 322/408 [04:58<01:17,  1.12it/s] 79%|███████▉  | 323/408 [04:59<01:08,  1.24it/s] 79%|███████▉  | 324/408 [04:59<01:08,  1.22it/s] 80%|███████▉  | 325/408 [05:00<01:03,  1.32it/s] 80%|███████▉  | 326/408 [05:01<00:55,  1.48it/s] 80%|████████  | 327/408 [05:02<01:19,  1.02it/s] 80%|████████  | 328/408 [05:03<01:06,  1.20it/s] 81%|████████  | 329/408 [05:04<01:10,  1.13it/s] 81%|████████  | 330/408 [05:04<01:00,  1.30it/s] 81%|████████  | 331/408 [05:05<00:58,  1.33it/s] 81%|████████▏ | 332/408 [05:06<01:02,  1.22it/s] 82%|████████▏ | 333/408 [05:07<01:02,  1.21it/s] 82%|████████▏ | 334/408 [05:08<01:07,  1.10it/s] 82%|████████▏ | 335/408 [05:09<01:02,  1.18it/s] 82%|████████▏ | 336/408 [05:09<00:55,  1.29it/s] 83%|████████▎ | 337/408 [05:11<01:11,  1.00s/it] 83%|████████▎ | 338/408 [05:12<01:06,  1.05it/s] 83%|████████▎ | 339/408 [05:12<01:01,  1.13it/s] 83%|████████▎ | 340/408 [05:13<01:01,  1.10it/s] 84%|████████▎ | 341/408 [05:14<01:04,  1.04it/s] 84%|████████▍ | 342/408 [05:16<01:08,  1.04s/it] 84%|████████▍ | 343/408 [05:16<00:58,  1.10it/s] 84%|████████▍ | 344/408 [05:17<01:02,  1.03it/s] 85%|████████▍ | 345/408 [05:18<00:59,  1.06it/s] 85%|████████▍ | 346/408 [05:19<00:56,  1.10it/s] 85%|████████▌ | 347/408 [05:20<00:54,  1.11it/s] 85%|████████▌ | 348/408 [05:21<00:59,  1.01it/s] 86%|████████▌ | 349/408 [05:22<00:58,  1.01it/s] 86%|████████▌ | 350/408 [05:23<00:55,  1.05it/s] 86%|████████▌ | 351/408 [05:24<00:52,  1.09it/s] 86%|████████▋ | 352/408 [05:25<00:50,  1.11it/s] 87%|████████▋ | 353/408 [05:25<00:42,  1.29it/s] 87%|████████▋ | 354/408 [05:26<00:51,  1.04it/s] 87%|████████▋ | 355/408 [05:27<00:41,  1.27it/s] 87%|████████▋ | 356/408 [05:27<00:38,  1.37it/s] 88%|████████▊ | 357/408 [05:28<00:36,  1.39it/s] 88%|████████▊ | 358/408 [05:30<00:48,  1.04it/s] 88%|████████▊ | 359/408 [05:31<00:44,  1.09it/s] 88%|████████▊ | 360/408 [05:31<00:37,  1.27it/s] 88%|████████▊ | 361/408 [05:32<00:43,  1.07it/s] 89%|████████▊ | 362/408 [05:33<00:41,  1.10it/s] 89%|████████▉ | 363/408 [05:34<00:41,  1.09it/s] 89%|████████▉ | 364/408 [05:35<00:36,  1.22it/s] 89%|████████▉ | 365/408 [05:35<00:34,  1.25it/s] 90%|████████▉ | 366/408 [05:36<00:29,  1.42it/s] 90%|████████▉ | 367/408 [05:36<00:27,  1.48it/s] 90%|█████████ | 368/408 [05:37<00:27,  1.45it/s] 90%|█████████ | 369/408 [05:38<00:30,  1.28it/s] 91%|█████████ | 370/408 [05:39<00:32,  1.15it/s] 91%|█████████ | 371/408 [05:40<00:29,  1.27it/s] 91%|█████████ | 372/408 [05:41<00:32,  1.10it/s] 91%|█████████▏| 373/408 [05:42<00:31,  1.10it/s] 92%|█████████▏| 374/408 [05:44<00:39,  1.16s/it] 92%|█████████▏| 375/408 [05:44<00:34,  1.03s/it] 92%|█████████▏| 376/408 [05:46<00:33,  1.06s/it] 92%|█████████▏| 377/408 [05:47<00:31,  1.03s/it] 93%|█████████▎| 378/408 [05:47<00:30,  1.01s/it] 93%|█████████▎| 379/408 [05:48<00:28,  1.01it/s] 93%|█████████▎| 380/408 [05:49<00:28,  1.01s/it] 93%|█████████▎| 381/408 [05:50<00:27,  1.00s/it] 94%|█████████▎| 382/408 [05:52<00:27,  1.05s/it] 94%|█████████▍| 383/408 [05:53<00:25,  1.03s/it] 94%|█████████▍| 384/408 [05:54<00:25,  1.07s/it] 94%|█████████▍| 385/408 [05:55<00:25,  1.11s/it] 95%|█████████▍| 386/408 [05:56<00:25,  1.14s/it] 95%|█████████▍| 387/408 [05:57<00:21,  1.01s/it] 95%|█████████▌| 388/408 [05:58<00:18,  1.07it/s] 95%|█████████▌| 389/408 [05:59<00:17,  1.10it/s] 96%|█████████▌| 390/408 [05:59<00:15,  1.18it/s] 96%|█████████▌| 391/408 [06:00<00:15,  1.08it/s] 96%|█████████▌| 392/408 [06:02<00:17,  1.12s/it] 96%|█████████▋| 393/408 [06:02<00:14,  1.05it/s] 97%|█████████▋| 394/408 [06:03<00:13,  1.05it/s] 97%|█████████▋| 395/408 [06:04<00:10,  1.20it/s] 97%|█████████▋| 396/408 [06:05<00:09,  1.23it/s] 97%|█████████▋| 397/408 [06:06<00:09,  1.22it/s] 98%|█████████▊| 398/408 [06:07<00:08,  1.15it/s] 98%|█████████▊| 399/408 [06:08<00:08,  1.10it/s] 98%|█████████▊| 400/408 [06:09<00:07,  1.08it/s] 98%|█████████▊| 401/408 [06:09<00:06,  1.10it/s] 99%|█████████▊| 402/408 [06:10<00:05,  1.05it/s] 99%|█████████▉| 403/408 [06:11<00:03,  1.29it/s] 99%|█████████▉| 404/408 [06:12<00:03,  1.22it/s] 99%|█████████▉| 405/408 [06:13<00:02,  1.03it/s]100%|█████████▉| 406/408 [06:14<00:01,  1.04it/s]100%|█████████▉| 407/408 [06:15<00:00,  1.13it/s]100%|██████████| 408/408 [06:15<00:00,  1.21it/s]100%|██████████| 408/408 [06:15<00:00,  1.09it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
Running BLEU / ROUGE!
'llama_7B'
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 268.85it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:422: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Token indices sequence length is longer than the specified maximum sequence length for this model (4152 > 2048). Running this sequence through the model will result in indexing errors
Map:  19%|█▉        | 19/100 [00:00<00:00, 165.52 examples/s]Map:  38%|███▊      | 38/100 [00:00<00:00, 170.24 examples/s]Map:  58%|█████▊    | 58/100 [00:00<00:00, 181.21 examples/s]Map:  77%|███████▋  | 77/100 [00:00<00:00, 175.29 examples/s]Map: 100%|██████████| 100/100 [00:00<00:00, 171.01 examples/s]                                                                0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:05, 16.60it/s]  4%|▍         | 4/100 [00:00<00:05, 17.00it/s]  6%|▌         | 6/100 [00:00<00:05, 17.13it/s]  8%|▊         | 8/100 [00:00<00:05, 17.20it/s] 10%|█         | 10/100 [00:00<00:05, 17.25it/s] 12%|█▏        | 12/100 [00:00<00:05, 17.29it/s] 14%|█▍        | 14/100 [00:00<00:04, 17.29it/s] 16%|█▌        | 16/100 [00:00<00:04, 17.29it/s] 18%|█▊        | 18/100 [00:01<00:04, 17.30it/s] 20%|██        | 20/100 [00:01<00:04, 17.31it/s] 22%|██▏       | 22/100 [00:01<00:04, 17.32it/s] 24%|██▍       | 24/100 [00:01<00:04, 17.31it/s] 26%|██▌       | 26/100 [00:01<00:04, 17.30it/s] 28%|██▊       | 28/100 [00:01<00:04, 17.32it/s] 30%|███       | 30/100 [00:01<00:04, 17.33it/s] 32%|███▏      | 32/100 [00:01<00:03, 17.33it/s] 34%|███▍      | 34/100 [00:01<00:03, 17.33it/s] 36%|███▌      | 36/100 [00:02<00:03, 17.33it/s] 38%|███▊      | 38/100 [00:02<00:03, 17.35it/s] 40%|████      | 40/100 [00:02<00:03, 17.36it/s] 42%|████▏     | 42/100 [00:02<00:03, 17.35it/s] 44%|████▍     | 44/100 [00:02<00:03, 17.35it/s] 46%|████▌     | 46/100 [00:02<00:03, 17.34it/s] 48%|████▊     | 48/100 [00:02<00:02, 17.36it/s] 50%|█████     | 50/100 [00:02<00:02, 17.33it/s] 52%|█████▏    | 52/100 [00:03<00:02, 17.33it/s] 54%|█████▍    | 54/100 [00:03<00:02, 17.34it/s] 56%|█████▌    | 56/100 [00:03<00:02, 17.34it/s] 58%|█████▊    | 58/100 [00:03<00:02, 17.34it/s] 60%|██████    | 60/100 [00:03<00:02, 17.35it/s] 62%|██████▏   | 62/100 [00:03<00:02, 17.36it/s] 64%|██████▍   | 64/100 [00:03<00:02, 17.35it/s] 66%|██████▌   | 66/100 [00:03<00:01, 17.28it/s] 68%|██████▊   | 68/100 [00:03<00:01, 17.30it/s] 70%|███████   | 70/100 [00:04<00:01, 17.33it/s] 72%|███████▏  | 72/100 [00:04<00:01, 17.33it/s] 74%|███████▍  | 74/100 [00:04<00:01, 17.35it/s] 76%|███████▌  | 76/100 [00:04<00:01, 17.34it/s] 78%|███████▊  | 78/100 [00:04<00:01, 17.32it/s] 80%|████████  | 80/100 [00:04<00:01, 17.31it/s] 82%|████████▏ | 82/100 [00:04<00:01, 17.31it/s] 84%|████████▍ | 84/100 [00:04<00:00, 17.32it/s] 86%|████████▌ | 86/100 [00:04<00:00, 17.34it/s] 88%|████████▊ | 88/100 [00:05<00:00, 17.35it/s] 90%|█████████ | 90/100 [00:05<00:00, 17.36it/s] 92%|█████████▏| 92/100 [00:05<00:00, 17.35it/s] 94%|█████████▍| 94/100 [00:05<00:00, 17.34it/s] 96%|█████████▌| 96/100 [00:05<00:00, 17.32it/s] 98%|█████████▊| 98/100 [00:05<00:00, 17.31it/s]100%|██████████| 100/100 [00:05<00:00, 17.33it/s]100%|██████████| 100/100 [00:05<00:00, 17.31it/s]
Found cached dataset openwebtext-10k (/home/elicer/.cache/huggingface/datasets/stas___openwebtext-10k/plain_text/1.0.0/3a8df094c671b4cb63ed0b41f40fb3bd855e9ce2e3765e5df50abcdfb5ec144b)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 355.33it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s]/home/elicer/honest_llama/validation/../utils.py:461: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  owt = dataset.map(lambda x: {'input_ids': torch.tensor(tokenizer(x['text'], return_tensors='pt')['input_ids'][:,:128])})
Map:  16%|█▌        | 16/100 [00:00<00:00, 138.98 examples/s]Map:  41%|████      | 41/100 [00:00<00:00, 190.88 examples/s]Map:  63%|██████▎   | 63/100 [00:00<00:00, 198.00 examples/s]Map:  92%|█████████▏| 92/100 [00:00<00:00, 183.32 examples/s]                                                               0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.62it/s]  2%|▏         | 2/100 [00:00<00:12,  7.74it/s]  3%|▎         | 3/100 [00:00<00:12,  7.99it/s]  4%|▍         | 4/100 [00:00<00:12,  7.85it/s]  5%|▌         | 5/100 [00:00<00:12,  7.89it/s]  6%|▌         | 6/100 [00:00<00:11,  8.00it/s]  7%|▋         | 7/100 [00:00<00:11,  8.02it/s]  8%|▊         | 8/100 [00:01<00:11,  7.85it/s]  9%|▉         | 9/100 [00:01<00:11,  7.95it/s] 10%|█         | 10/100 [00:01<00:11,  7.84it/s] 11%|█         | 11/100 [00:01<00:11,  7.89it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.96it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.95it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.76it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.77it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.87it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.80it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.77it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.73it/s] 20%|██        | 20/100 [00:02<00:10,  7.70it/s] 21%|██        | 21/100 [00:02<00:10,  7.75it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.87it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.66it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.58it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.77it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.85it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.83it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.85it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.94it/s] 30%|███       | 30/100 [00:03<00:08,  7.98it/s] 31%|███       | 31/100 [00:03<00:08,  8.01it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.78it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.67it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.82it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.87it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.90it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.77it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.85it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.74it/s] 40%|████      | 40/100 [00:05<00:07,  7.79it/s] 41%|████      | 41/100 [00:05<00:07,  7.79it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.86it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.73it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.72it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.70it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.80it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.89it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.86it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.83it/s] 50%|█████     | 50/100 [00:06<00:06,  7.78it/s] 51%|█████     | 51/100 [00:06<00:06,  7.73it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.86it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.68it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.84it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.74it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.85it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.88it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.96it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.99it/s] 60%|██████    | 60/100 [00:07<00:05,  7.93it/s] 61%|██████    | 61/100 [00:07<00:04,  7.87it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.96it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.00it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.89it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.81it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.91it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.78it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.64it/s] 70%|███████   | 70/100 [00:08<00:03,  7.61it/s] 71%|███████   | 71/100 [00:09<00:03,  7.67it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.77it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.72it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.85it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.71it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.65it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.80it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.73it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.74it/s] 80%|████████  | 80/100 [00:10<00:02,  7.72it/s] 81%|████████  | 81/100 [00:10<00:02,  7.84it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.70it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.84it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.74it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.87it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.91it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.85it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.89it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.92it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.98it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.98it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.85it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.80it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.75it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.72it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.75it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.76it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.82it/s]100%|██████████| 100/100 [00:12<00:00,  7.90it/s]100%|██████████| 100/100 [00:12<00:00,  7.82it/s]
FOLD 1
Metric        MC1       MC2   CE Loss  KL wrt Orig
Model                                             
llama_7B  0.27451  0.501513  5.405234     3.226479
[0.26072678 0.50084242 5.6625     3.52019538]
MC1 Score: 0.2607267846013711, MC2 Score: 0.500842417510069, CE Loss: 5.6625, KL wrt Original: 3.5201953774690624
2023-11-01 14:16:25.449088: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:16:25.500135: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:16:26.250237: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 362.86it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.60it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.11it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.02it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 450.52it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:15,  2.02it/s]  6%|▋         | 2/32 [00:00<00:14,  2.09it/s]  9%|▉         | 3/32 [00:01<00:14,  2.04it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.02it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.95it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.90it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.85it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.85it/s] 28%|██▊       | 9/32 [00:04<00:12,  1.78it/s] 31%|███▏      | 10/32 [00:05<00:12,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.64it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.60it/s] 41%|████      | 13/32 [00:07<00:11,  1.59it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.57it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.54it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.52it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.50it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.44it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.43it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.46it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.43it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.46it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.43it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.44it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.46it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.46it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.49it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.51it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.53it/s]100%|██████████| 32/32 [00:20<00:00,  1.40it/s]100%|██████████| 32/32 [00:20<00:00,  1.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.55609756 0.56910569 0.55447154 ... 0.55447154 0.55447154 0.55447154]
 [0.55447154 0.55447154 0.55447154 ... 0.57886179 0.55447154 0.55447154]
 [0.55447154 0.57073171 0.68617886 ... 0.57886179 0.55447154 0.62113821]
 ...
 [0.68292683 0.56585366 0.56097561 ... 0.61463415 0.55772358 0.55284553]
 [0.71869919 0.57560976 0.59349593 ... 0.57235772 0.67479675 0.55447154]
 [0.62113821 0.62926829 0.69593496 ... 0.63902439 0.66504065 0.6699187 ]]
Heads intervened:  [(9, 11), (9, 20), (9, 29), (10, 1), (10, 11), (10, 15), (10, 17), (10, 22), (10, 28), (10, 29), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 21), (11, 29), (11, 31), (12, 3), (12, 14), (12, 21), (13, 11), (13, 16), (13, 22), (14, 5), (14, 12), (14, 14), (14, 18), (14, 22), (14, 30), (15, 20), (15, 24), (15, 28), (16, 1), (16, 10), (16, 13), (16, 26), (17, 31), (18, 0), (18, 9), (18, 10), (18, 17), (20, 19), (21, 22), (22, 4), (22, 13), (30, 22), (31, 26)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
Traceback (most recent call last):
  File "validate_2fold.py", line 190, in <module>
    main()
  File "validate_2fold.py", line 159, in main
    curr_fold_results = alt_tqa_evaluate(
  File "/home/elicer/honest_llama/validation/../utils.py", line 564, in alt_tqa_evaluate
    questions = tqa_run_probs(questions, ENGINE_MAP[mdl], mdl, model=llama_model, tokenizer=llama_tokenizer, preset=preset, device=device, cache_dir=cache_dir, verbose=False, interventions=interventions, intervention_fn=intervention_fn, instruction_prompt=instruction_prompt, many_shot_prefix=many_shot_prefix,num_fewshot=num_fewshot, fewshot_question=fewshot_question)
UnboundLocalError: local variable 'fewshot_question' referenced before assignment
2023-11-01 14:17:05.838479: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:17:05.886977: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:17:06.626538: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 366.92it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.86it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.23it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.16it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 470.11it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.08it/s]  6%|▋         | 2/32 [00:00<00:14,  2.11it/s]  9%|▉         | 3/32 [00:01<00:14,  2.02it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.02it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.96it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.89it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.86it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.85it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.77it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.62it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.59it/s] 41%|████      | 13/32 [00:07<00:12,  1.58it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.56it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.52it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.51it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.48it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.42it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.43it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.41it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.45it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.46it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.47it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.50it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.52it/s]100%|██████████| 32/32 [00:20<00:00,  1.42it/s]100%|██████████| 32/32 [00:20<00:00,  1.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.57457627 0.58305085 0.57457627 ... 0.57457627 0.57457627 0.57457627]
 [0.57457627 0.57457627 0.57457627 ... 0.61016949 0.57288136 0.57457627]
 [0.57457627 0.60169492 0.72033898 ... 0.63220339 0.57457627 0.64915254]
 ...
 [0.71864407 0.58305085 0.58474576 ... 0.62372881 0.57966102 0.57627119]
 [0.71525424 0.58644068 0.58813559 ... 0.58644068 0.68305085 0.57457627]
 [0.62881356 0.6559322  0.72711864 ... 0.64745763 0.68813559 0.68135593]]
Heads intervened:  [(7, 5), (7, 14), (9, 1), (9, 20), (10, 1), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 19), (11, 21), (11, 29), (12, 25), (13, 11), (13, 16), (13, 18), (13, 22), (13, 23), (14, 0), (14, 5), (14, 12), (14, 18), (14, 22), (15, 20), (15, 24), (15, 28), (16, 2), (16, 10), (16, 11), (16, 13), (16, 25), (17, 1), (17, 21), (17, 31), (18, 0), (18, 9), (18, 17), (20, 19), (20, 21), (21, 22), (21, 29), (22, 4), (22, 13), (23, 18), (30, 22), (31, 19)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
Traceback (most recent call last):
  File "validate_2fold.py", line 190, in <module>
    main()
  File "validate_2fold.py", line 159, in main
    curr_fold_results = alt_tqa_evaluate(
  File "/home/elicer/honest_llama/validation/../utils.py", line 564, in alt_tqa_evaluate
    questions = tqa_run_probs(questions, ENGINE_MAP[mdl], mdl, model=llama_model, tokenizer=llama_tokenizer, preset=preset, device=device, cache_dir=cache_dir, verbose=False, interventions=interventions, intervention_fn=intervention_fn, instruction_prompt=instruction_prompt, many_shot_prefix=many_shot_prefix,num_fewshot=num_fewshot, fewshot_question=fewshot_question)
UnboundLocalError: local variable 'fewshot_question' referenced before assignment
2023-11-01 14:17:46.377289: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:17:46.426251: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:17:47.173850: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 366.31it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.90it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.12it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.08it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 453.83it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.08it/s]  6%|▋         | 2/32 [00:00<00:14,  2.08it/s]  9%|▉         | 3/32 [00:01<00:14,  1.99it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.00it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.93it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.87it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.83it/s] 25%|██▌       | 8/32 [00:04<00:13,  1.81it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.74it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.65it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.62it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.59it/s] 41%|████      | 13/32 [00:07<00:12,  1.57it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.55it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.53it/s] 50%|█████     | 16/32 [00:09<00:10,  1.51it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.50it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.48it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.41it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.41it/s] 66%|██████▌   | 21/32 [00:13<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.41it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.44it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.41it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.44it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.44it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.46it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.47it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.48it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.51it/s]100%|██████████| 32/32 [00:20<00:00,  1.39it/s]100%|██████████| 32/32 [00:20<00:00,  1.54it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.57191201 0.58375635 0.57191201 ... 0.57191201 0.57191201 0.57191201]
 [0.57360406 0.57191201 0.57191201 ... 0.59221658 0.57360406 0.57191201]
 [0.57191201 0.58883249 0.70389171 ... 0.60913706 0.57191201 0.59052453]
 ...
 [0.71235195 0.5820643  0.59898477 ... 0.62436548 0.58037225 0.57529611]
 [0.71573604 0.59729272 0.59052453 ... 0.58714044 0.67005076 0.57191201]
 [0.6142132  0.67174281 0.70389171 ... 0.60913706 0.66497462 0.68527919]]
Heads intervened:  [(6, 1), (9, 11), (9, 20), (9, 29), (10, 1), (10, 17), (10, 22), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (12, 3), (12, 14), (12, 21), (13, 11), (13, 16), (13, 22), (13, 30), (14, 4), (14, 5), (14, 12), (14, 14), (14, 18), (14, 22), (15, 3), (15, 20), (15, 21), (15, 24), (15, 28), (16, 1), (16, 17), (16, 26), (17, 1), (17, 21), (17, 31), (18, 9), (18, 10), (18, 17), (19, 6), (20, 19), (20, 30), (22, 4), (22, 11), (22, 13), (23, 18), (24, 20)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
Traceback (most recent call last):
  File "validate_2fold.py", line 190, in <module>
    main()
  File "validate_2fold.py", line 159, in main
    curr_fold_results = alt_tqa_evaluate(
  File "/home/elicer/honest_llama/validation/../utils.py", line 564, in alt_tqa_evaluate
    questions = tqa_run_probs(questions, ENGINE_MAP[mdl], mdl, model=llama_model, tokenizer=llama_tokenizer, preset=preset, device=device, cache_dir=cache_dir, verbose=False, interventions=interventions, intervention_fn=intervention_fn, instruction_prompt=instruction_prompt, many_shot_prefix=many_shot_prefix,num_fewshot=num_fewshot, fewshot_question=fewshot_question)
UnboundLocalError: local variable 'fewshot_question' referenced before assignment
2023-11-01 14:18:27.032155: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:18:27.083129: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:18:27.856451: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 361.14it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.68it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.22it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.13it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 456.80it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:14,  2.10it/s]  6%|▋         | 2/32 [00:00<00:13,  2.15it/s]  9%|▉         | 3/32 [00:01<00:13,  2.07it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.05it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.98it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.93it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.89it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.87it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.76it/s] 31%|███▏      | 10/32 [00:05<00:12,  1.69it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.65it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.62it/s] 41%|████      | 13/32 [00:07<00:11,  1.62it/s] 44%|████▍     | 14/32 [00:07<00:11,  1.59it/s] 47%|████▋     | 15/32 [00:08<00:10,  1.55it/s] 50%|█████     | 16/32 [00:09<00:10,  1.55it/s] 53%|█████▎    | 17/32 [00:09<00:09,  1.54it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.51it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.44it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.43it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.47it/s] 69%|██████▉   | 22/32 [00:13<00:06,  1.44it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.46it/s] 75%|███████▌  | 24/32 [00:14<00:05,  1.44it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.46it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.47it/s] 84%|████████▍ | 27/32 [00:16<00:03,  1.47it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.49it/s] 94%|█████████▍| 30/32 [00:18<00:01,  1.52it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.56it/s]100%|██████████| 32/32 [00:20<00:00,  1.42it/s]100%|██████████| 32/32 [00:20<00:00,  1.58it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.58359621 0.59148265 0.58044164 ... 0.58044164 0.58044164 0.58044164]
 [0.58044164 0.58044164 0.58044164 ... 0.60567823 0.58044164 0.58044164]
 [0.58044164 0.58832808 0.71766562 ... 0.59621451 0.58044164 0.63249211]
 ...
 [0.70347003 0.58990536 0.59148265 ... 0.61671924 0.58044164 0.58201893]
 [0.73343849 0.60252366 0.61356467 ... 0.60567823 0.69400631 0.58044164]
 [0.62776025 0.64826498 0.70662461 ... 0.63564669 0.670347   0.67192429]]
Heads intervened:  [(7, 14), (7, 23), (8, 5), (8, 12), (9, 20), (9, 29), (10, 1), (10, 17), (10, 22), (10, 27), (10, 28), (11, 0), (11, 3), (11, 6), (11, 8), (11, 15), (11, 21), (11, 28), (11, 29), (11, 31), (12, 3), (12, 12), (12, 14), (12, 21), (12, 25), (13, 11), (13, 22), (14, 12), (14, 14), (14, 18), (14, 22), (15, 20), (15, 21), (15, 24), (16, 2), (16, 10), (16, 11), (16, 17), (16, 26), (17, 1), (17, 31), (18, 0), (18, 9), (18, 10), (18, 17), (20, 9), (22, 4), (24, 20)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
Traceback (most recent call last):
  File "validate_2fold.py", line 190, in <module>
    main()
  File "validate_2fold.py", line 159, in main
    curr_fold_results = alt_tqa_evaluate(
  File "/home/elicer/honest_llama/validation/../utils.py", line 564, in alt_tqa_evaluate
    questions = tqa_run_probs(questions, ENGINE_MAP[mdl], mdl, model=llama_model, tokenizer=llama_tokenizer, preset=preset, device=device, cache_dir=cache_dir, verbose=False, interventions=interventions, intervention_fn=intervention_fn, instruction_prompt=instruction_prompt, many_shot_prefix=many_shot_prefix,num_fewshot=num_fewshot, fewshot_question=fewshot_question)
UnboundLocalError: local variable 'fewshot_question' referenced before assignment
2023-11-01 14:19:07.207166: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-01 14:19:07.256249: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-01 14:19:07.999861: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 370.23it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.84it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.11it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  6.06it/s]
Found cached dataset truthful_qa (/home/elicer/.cache/huggingface/datasets/truthful_qa/multiple_choice/1.1.0/63502f6bc6ee493830ce0843991b028d0ab568d221896b2ee3b8a5dfdaa9d7f4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 467.75it/s]
Running fold 0
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:15,  2.05it/s]  6%|▋         | 2/32 [00:00<00:14,  2.11it/s]  9%|▉         | 3/32 [00:01<00:14,  2.01it/s] 12%|█▎        | 4/32 [00:01<00:13,  2.02it/s] 16%|█▌        | 5/32 [00:02<00:13,  1.97it/s] 19%|█▉        | 6/32 [00:03<00:13,  1.90it/s] 22%|██▏       | 7/32 [00:03<00:13,  1.86it/s] 25%|██▌       | 8/32 [00:04<00:12,  1.85it/s] 28%|██▊       | 9/32 [00:04<00:13,  1.77it/s] 31%|███▏      | 10/32 [00:05<00:13,  1.68it/s] 34%|███▍      | 11/32 [00:06<00:12,  1.63it/s] 38%|███▊      | 12/32 [00:06<00:12,  1.61it/s] 41%|████      | 13/32 [00:07<00:11,  1.61it/s] 44%|████▍     | 14/32 [00:08<00:11,  1.58it/s] 47%|████▋     | 15/32 [00:08<00:11,  1.54it/s] 50%|█████     | 16/32 [00:09<00:10,  1.54it/s] 53%|█████▎    | 17/32 [00:10<00:09,  1.53it/s] 56%|█████▋    | 18/32 [00:10<00:09,  1.49it/s] 59%|█████▉    | 19/32 [00:11<00:09,  1.42it/s] 62%|██████▎   | 20/32 [00:12<00:08,  1.40it/s] 66%|██████▌   | 21/32 [00:12<00:07,  1.44it/s] 69%|██████▉   | 22/32 [00:13<00:07,  1.42it/s] 72%|███████▏  | 23/32 [00:14<00:06,  1.44it/s] 75%|███████▌  | 24/32 [00:15<00:05,  1.42it/s] 78%|███████▊  | 25/32 [00:15<00:04,  1.43it/s] 81%|████████▏ | 26/32 [00:16<00:04,  1.45it/s] 84%|████████▍ | 27/32 [00:17<00:03,  1.45it/s] 88%|████████▊ | 28/32 [00:17<00:02,  1.48it/s] 91%|█████████ | 29/32 [00:18<00:02,  1.47it/s] 94%|█████████▍| 30/32 [00:19<00:01,  1.49it/s] 97%|█████████▋| 31/32 [00:19<00:00,  1.52it/s]100%|██████████| 32/32 [00:20<00:00,  1.40it/s]100%|██████████| 32/32 [00:20<00:00,  1.56it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[[0.59003215 0.60610932 0.58681672 ... 0.58681672 0.58681672 0.58681672]
 [0.58681672 0.58681672 0.58681672 ... 0.63344051 0.58681672 0.58681672]
 [0.58681672 0.60128617 0.75723473 ... 0.62540193 0.58681672 0.62540193]
 ...
 [0.74758842 0.60128617 0.61093248 ... 0.64630225 0.59324759 0.58681672]
 [0.73794212 0.61736334 0.61093248 ... 0.63504823 0.71221865 0.58681672]
 [0.62540193 0.70900322 0.77170418 ... 0.68167203 0.67524116 0.72990354]]
Heads intervened:  [(7, 14), (7, 23), (7, 27), (8, 5), (8, 12), (9, 20), (9, 29), (10, 1), (10, 2), (10, 12), (10, 17), (10, 22), (10, 28), (11, 0), (11, 6), (11, 8), (11, 21), (11, 29), (11, 31), (12, 12), (12, 25), (13, 16), (13, 22), (14, 0), (14, 12), (14, 14), (14, 18), (14, 22), (15, 1), (15, 20), (15, 28), (16, 11), (16, 13), (16, 26), (17, 1), (17, 12), (17, 31), (18, 0), (18, 9), (18, 17), (19, 6), (19, 19), (20, 30), (21, 22), (22, 4), (25, 13), (30, 22), (31, 19)]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
Traceback (most recent call last):
  File "validate_2fold.py", line 190, in <module>
    main()
  File "validate_2fold.py", line 159, in main
    curr_fold_results = alt_tqa_evaluate(
  File "/home/elicer/honest_llama/validation/../utils.py", line 564, in alt_tqa_evaluate
    questions = tqa_run_probs(questions, ENGINE_MAP[mdl], mdl, model=llama_model, tokenizer=llama_tokenizer, preset=preset, device=device, cache_dir=cache_dir, verbose=False, interventions=interventions, intervention_fn=intervention_fn, instruction_prompt=instruction_prompt, many_shot_prefix=many_shot_prefix,num_fewshot=num_fewshot, fewshot_question=fewshot_question)
UnboundLocalError: local variable 'fewshot_question' referenced before assignment
